

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Ansible &mdash; Root Pages  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Puppet" href="puppet.html" />
    <link rel="prev" title="&lt;no title&gt;" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Root Pages
          

          
          </a>

          
            
            
              <div class="version">
                2021.04.01
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Administration</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../administration/authentication.html">Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="../administration/chromebook.html">Chromebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../administration/graphics.html">Graphics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../administration/linux.html">Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../administration/macs.html">Macs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../administration/mail_servers.html">Mail Servers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../administration/operating_systems.html">Operating Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../administration/package_managers.html">Package Managers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../administration/security.html">Security</a></li>
</ul>
<p class="caption"><span class="caption-text">Automation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Ansible</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#editions">Editions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#deprecations">Deprecations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configuration">Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#main">Main</a></li>
<li class="toctree-l3"><a class="reference internal" href="#python-3">Python 3</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#commands-usage">Commands Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="#playbooks">Playbooks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tasks">Tasks</a></li>
<li class="toctree-l3"><a class="reference internal" href="#directory-structure">Directory Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="#performance-tuning">Performance Tuning</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#inventory">Inventory</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#production-and-staging">Production and Staging</a></li>
<li class="toctree-l3"><a class="reference internal" href="#vault-encryption">Vault Encryption</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dynamic">Dynamic</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#variables">Variables</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#magic-variables">Magic Variables</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#modules">Modules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#main-modules">Main Modules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#assert">Assert</a></li>
<li class="toctree-l4"><a class="reference internal" href="#async">Async</a></li>
<li class="toctree-l4"><a class="reference internal" href="#block">Block</a></li>
<li class="toctree-l4"><a class="reference internal" href="#check-mode">Check Mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="#debug">Debug</a></li>
<li class="toctree-l4"><a class="reference internal" href="#gather-facts">Gather Facts</a></li>
<li class="toctree-l4"><a class="reference internal" href="#handlers-and-notify">Handlers and Notify</a></li>
<li class="toctree-l4"><a class="reference internal" href="#meta">Meta</a></li>
<li class="toctree-l4"><a class="reference internal" href="#no-log">No Log</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pause">Pause</a></li>
<li class="toctree-l4"><a class="reference internal" href="#roles">Roles</a></li>
<li class="toctree-l4"><a class="reference internal" href="#run-once">Run Once</a></li>
<li class="toctree-l4"><a class="reference internal" href="#serial">Serial</a></li>
<li class="toctree-l4"><a class="reference internal" href="#strategy">Strategy</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tags">Tags</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id1">Tasks</a></li>
<li class="toctree-l4"><a class="reference internal" href="#wait-for">Wait For</a></li>
<li class="toctree-l4"><a class="reference internal" href="#when">When</a></li>
<li class="toctree-l4"><a class="reference internal" href="#errors">Errors</a></li>
<li class="toctree-l4"><a class="reference internal" href="#includes">Includes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#loops">Loops</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2">Variables</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#unix-modules">UNIX Modules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#authorized-key">Authorized Key</a></li>
<li class="toctree-l4"><a class="reference internal" href="#command-and-shell">Command and Shell</a></li>
<li class="toctree-l4"><a class="reference internal" href="#copy-file-synchronize-and-template">Copy, File, Synchronize, and Template</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cron">Cron</a></li>
<li class="toctree-l4"><a class="reference internal" href="#expect">Expect</a></li>
<li class="toctree-l4"><a class="reference internal" href="#get-url">Get URL</a></li>
<li class="toctree-l4"><a class="reference internal" href="#git">Git</a></li>
<li class="toctree-l4"><a class="reference internal" href="#service">Service</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mysql-database-and-user">MySQL Database and User</a></li>
<li class="toctree-l4"><a class="reference internal" href="#raw">Raw</a></li>
<li class="toctree-l4"><a class="reference internal" href="#stat">Stat</a></li>
<li class="toctree-l4"><a class="reference internal" href="#uri">URI</a></li>
<li class="toctree-l4"><a class="reference internal" href="#package-managers">Package Managers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#windows-modules">Windows Modules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id3">Command and Shell</a></li>
<li class="toctree-l4"><a class="reference internal" href="#file-management">File Management</a></li>
<li class="toctree-l4"><a class="reference internal" href="#installations">Installations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#registry">Registry</a></li>
<li class="toctree-l4"><a class="reference internal" href="#scheduled-task">Scheduled Task</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4">Service</a></li>
<li class="toctree-l4"><a class="reference internal" href="#user">User</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-development">Module Development</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id5">Roles</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#galaxy">Galaxy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#dependencies">Dependencies</a></li>
<li class="toctree-l4"><a class="reference internal" href="#community-roles">Community Roles</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#jinja2">Jinja2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id6">Variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="#filters">Filters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#comments">Comments</a></li>
<li class="toctree-l3"><a class="reference internal" href="#blocks">Blocks</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id7">Loops</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#plugins">Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="#containers">Containers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#best-practices">Best Practices</a></li>
<li class="toctree-l2"><a class="reference internal" href="#python-api">Python API</a></li>
<li class="toctree-l2"><a class="reference internal" href="#testing">Testing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ansible-lint">Ansible Lint</a></li>
<li class="toctree-l3"><a class="reference internal" href="#molecule">Molecule</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#dashboards">Dashboards</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ansible-tower-3">Ansible Tower 3</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#gui">GUI</a></li>
<li class="toctree-l4"><a class="reference internal" href="#security">Security</a></li>
<li class="toctree-l4"><a class="reference internal" href="#api">API</a></li>
<li class="toctree-l4"><a class="reference internal" href="#recovery">Recovery</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id8">Updates</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#awx">AWX</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#install">Install</a></li>
<li class="toctree-l4"><a class="reference internal" href="#upgrades">Upgrades</a></li>
<li class="toctree-l4"><a class="reference internal" href="#uninstall">Uninstall</a></li>
<li class="toctree-l4"><a class="reference internal" href="#postgresql-streaming-replication">PostgreSQL Streaming Replication</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#rundeck">Rundeck</a></li>
<li class="toctree-l3"><a class="reference internal" href="#semaphore">Semaphore</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tensor">Tensor</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#history">History</a></li>
<li class="toctree-l2"><a class="reference internal" href="#bibliography">Bibliography</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="puppet.html">Puppet</a></li>
</ul>
<p class="caption"><span class="caption-text">Computer Hardware</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../computer_hardware/graphics_cards.html">Graphics Cards</a></li>
<li class="toctree-l1"><a class="reference internal" href="../computer_hardware/laptops.html">Laptops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../computer_hardware/monitors.html">Monitors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../computer_hardware/processors.html">Processors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../computer_hardware/storage_devices.html">Storage Devices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../computer_hardware/webcams.html">Webcams</a></li>
</ul>
<p class="caption"><span class="caption-text">HTTP</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../http/clustering.html">Clustering and High Availability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../http/cms.html">Content Management Systems (CMSs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../http/databases.html">Databases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../http/http_servers.html">HTTP Servers</a></li>
</ul>
<p class="caption"><span class="caption-text">Networking</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../networking/dns_servers.html">DNS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../networking/networking_hardware.html">Networking (Hardware)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../networking/linux.html">Linux Networking</a></li>
</ul>
<p class="caption"><span class="caption-text">Observation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../observation/logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../observation/monitoring.html">Monitoring</a></li>
</ul>
<p class="caption"><span class="caption-text">OpenStack</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../openstack/openstack.html">OpenStack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../openstack/developer.html">OpenStack Developer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../openstack/kolla.html">Kolla</a></li>
<li class="toctree-l1"><a class="reference internal" href="../openstack/openstack-ansible.html">OpenStack-Ansible</a></li>
<li class="toctree-l1"><a class="reference internal" href="../openstack/tripleo.html">TripleO</a></li>
</ul>
<p class="caption"><span class="caption-text">Programming</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../programming/c_and_c%2B%2B.html">C and C++</a></li>
<li class="toctree-l1"><a class="reference internal" href="../programming/devops.html">DevOps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../programming/go.html">Go</a></li>
<li class="toctree-l1"><a class="reference internal" href="../programming/packaging.html">Packaging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../programming/python.html">Python 3</a></li>
</ul>
<p class="caption"><span class="caption-text">Storage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../storage/backup_and_recovery.html">Backup and Recovery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../storage/bootloaders.html">Bootloaders</a></li>
<li class="toctree-l1"><a class="reference internal" href="../storage/ceph.html">Ceph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../storage/file_systems.html">File Systems</a></li>
</ul>
<p class="caption"><span class="caption-text">Virtualization</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../virtualization/containers.html">Containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../virtualization/kubernetes_administration.html">Kubernetes Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../virtualization/kubernetes_development.html">Kubernetes Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../virtualization/virtual_machines.html">Virtual Machines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../virtualization/wine.html">Wine</a></li>
</ul>
<p class="caption"><span class="caption-text">Commands</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../commands/clustering.html">Clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commands/compression.html">Compression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commands/configuration_management.html">Configuration Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commands/firewalls.html">Firewalls</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commands/hardware.html">Hardware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commands/openstack.html">OpenStack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commands/package_managers.html">Package Managers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commands/permissions.html">Permissions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commands/phones.html">Phones</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commands/security.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commands/software_code_management.html">Source Code Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commands/storage.html">Storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commands/text_editors.html">Text Editors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commands/virtualization.html">Virtualization</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Root Pages</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">&lt;no title&gt;</a> &raquo;</li>
        
      <li>Ansible</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/automation/ansible.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="ansible">
<h1><a class="toc-backref" href="#id9">Ansible</a><a class="headerlink" href="#ansible" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#ansible" id="id9">Ansible</a></p>
<ul>
<li><p><a class="reference internal" href="#introduction" id="id10">Introduction</a></p>
<ul>
<li><p><a class="reference internal" href="#editions" id="id11">Editions</a></p></li>
<li><p><a class="reference internal" href="#deprecations" id="id12">Deprecations</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#installation" id="id13">Installation</a></p></li>
<li><p><a class="reference internal" href="#configuration" id="id14">Configuration</a></p>
<ul>
<li><p><a class="reference internal" href="#main" id="id15">Main</a></p></li>
<li><p><a class="reference internal" href="#python-3" id="id16">Python 3</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#commands-usage" id="id17">Commands Usage</a></p></li>
<li><p><a class="reference internal" href="#playbooks" id="id18">Playbooks</a></p>
<ul>
<li><p><a class="reference internal" href="#tasks" id="id19">Tasks</a></p></li>
<li><p><a class="reference internal" href="#directory-structure" id="id20">Directory Structure</a></p></li>
<li><p><a class="reference internal" href="#performance-tuning" id="id21">Performance Tuning</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#inventory" id="id22">Inventory</a></p>
<ul>
<li><p><a class="reference internal" href="#production-and-staging" id="id23">Production and Staging</a></p></li>
<li><p><a class="reference internal" href="#vault-encryption" id="id24">Vault Encryption</a></p></li>
<li><p><a class="reference internal" href="#dynamic" id="id25">Dynamic</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#variables" id="id26">Variables</a></p>
<ul>
<li><p><a class="reference internal" href="#magic-variables" id="id27">Magic Variables</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#modules" id="id28">Modules</a></p>
<ul>
<li><p><a class="reference internal" href="#main-modules" id="id29">Main Modules</a></p>
<ul>
<li><p><a class="reference internal" href="#assert" id="id30">Assert</a></p></li>
<li><p><a class="reference internal" href="#async" id="id31">Async</a></p></li>
<li><p><a class="reference internal" href="#block" id="id32">Block</a></p></li>
<li><p><a class="reference internal" href="#check-mode" id="id33">Check Mode</a></p></li>
<li><p><a class="reference internal" href="#debug" id="id34">Debug</a></p></li>
<li><p><a class="reference internal" href="#gather-facts" id="id35">Gather Facts</a></p></li>
<li><p><a class="reference internal" href="#handlers-and-notify" id="id36">Handlers and Notify</a></p></li>
<li><p><a class="reference internal" href="#meta" id="id37">Meta</a></p></li>
<li><p><a class="reference internal" href="#no-log" id="id38">No Log</a></p></li>
<li><p><a class="reference internal" href="#pause" id="id39">Pause</a></p></li>
<li><p><a class="reference internal" href="#roles" id="id40">Roles</a></p></li>
<li><p><a class="reference internal" href="#run-once" id="id41">Run Once</a></p></li>
<li><p><a class="reference internal" href="#serial" id="id42">Serial</a></p></li>
<li><p><a class="reference internal" href="#strategy" id="id43">Strategy</a></p></li>
<li><p><a class="reference internal" href="#tags" id="id44">Tags</a></p></li>
<li><p><a class="reference internal" href="#id1" id="id45">Tasks</a></p></li>
<li><p><a class="reference internal" href="#wait-for" id="id46">Wait For</a></p></li>
<li><p><a class="reference internal" href="#when" id="id47">When</a></p></li>
<li><p><a class="reference internal" href="#errors" id="id48">Errors</a></p>
<ul>
<li><p><a class="reference internal" href="#any-errors-fatal" id="id49">Any Errors Fatal</a></p></li>
<li><p><a class="reference internal" href="#fail" id="id50">Fail</a></p></li>
<li><p><a class="reference internal" href="#failed-when" id="id51">Failed When</a></p></li>
<li><p><a class="reference internal" href="#ignore-errors" id="id52">Ignore Errors</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#includes" id="id53">Includes</a></p>
<ul>
<li><p><a class="reference internal" href="#import-playbook" id="id54">Import Playbook</a></p></li>
<li><p><a class="reference internal" href="#import-and-include-role" id="id55">Import and Include Role</a></p></li>
<li><p><a class="reference internal" href="#import-and-include-tasks" id="id56">Import and Include Tasks</a></p></li>
<li><p><a class="reference internal" href="#include" id="id57">Include</a></p></li>
<li><p><a class="reference internal" href="#include-variables" id="id58">Include Variables</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#loops" id="id59">Loops</a></p>
<ul>
<li><p><a class="reference internal" href="#loop" id="id60">Loop</a></p></li>
<li><p><a class="reference internal" href="#loop-control" id="id61">Loop Control</a></p></li>
<li><p><a class="reference internal" href="#until-loops" id="id62">Until Loops</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id2" id="id63">Variables</a></p>
<ul>
<li><p><a class="reference internal" href="#vars-prompt" id="id64">Vars Prompt</a></p></li>
<li><p><a class="reference internal" href="#register" id="id65">Register</a></p></li>
<li><p><a class="reference internal" href="#set-fact" id="id66">Set Fact</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#unix-modules" id="id67">UNIX Modules</a></p>
<ul>
<li><p><a class="reference internal" href="#authorized-key" id="id68">Authorized Key</a></p></li>
<li><p><a class="reference internal" href="#command-and-shell" id="id69">Command and Shell</a></p></li>
<li><p><a class="reference internal" href="#copy-file-synchronize-and-template" id="id70">Copy, File, Synchronize, and Template</a></p></li>
<li><p><a class="reference internal" href="#cron" id="id71">Cron</a></p></li>
<li><p><a class="reference internal" href="#expect" id="id72">Expect</a></p></li>
<li><p><a class="reference internal" href="#get-url" id="id73">Get URL</a></p></li>
<li><p><a class="reference internal" href="#git" id="id74">Git</a></p></li>
<li><p><a class="reference internal" href="#service" id="id75">Service</a></p></li>
<li><p><a class="reference internal" href="#mysql-database-and-user" id="id76">MySQL Database and User</a></p></li>
<li><p><a class="reference internal" href="#raw" id="id77">Raw</a></p></li>
<li><p><a class="reference internal" href="#stat" id="id78">Stat</a></p></li>
<li><p><a class="reference internal" href="#uri" id="id79">URI</a></p></li>
<li><p><a class="reference internal" href="#package-managers" id="id80">Package Managers</a></p>
<ul>
<li><p><a class="reference internal" href="#apt" id="id81">Apt</a></p></li>
<li><p><a class="reference internal" href="#yum" id="id82">Yum</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#windows-modules" id="id83">Windows Modules</a></p>
<ul>
<li><p><a class="reference internal" href="#id3" id="id84">Command and Shell</a></p></li>
<li><p><a class="reference internal" href="#file-management" id="id85">File Management</a></p>
<ul>
<li><p><a class="reference internal" href="#copy" id="id86">Copy</a></p></li>
<li><p><a class="reference internal" href="#file" id="id87">File</a></p></li>
<li><p><a class="reference internal" href="#robocopy" id="id88">Robocopy</a></p></li>
<li><p><a class="reference internal" href="#shortcut" id="id89">Shortcut</a></p></li>
<li><p><a class="reference internal" href="#template" id="id90">Template</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#installations" id="id91">Installations</a></p>
<ul>
<li><p><a class="reference internal" href="#chocolatey" id="id92">Chocolatey</a></p></li>
<li><p><a class="reference internal" href="#feature" id="id93">Feature</a></p></li>
<li><p><a class="reference internal" href="#msi" id="id94">MSI</a></p></li>
<li><p><a class="reference internal" href="#package" id="id95">Package</a></p></li>
<li><p><a class="reference internal" href="#updates" id="id96">Updates</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#registry" id="id97">Registry</a></p></li>
<li><p><a class="reference internal" href="#scheduled-task" id="id98">Scheduled Task</a></p></li>
<li><p><a class="reference internal" href="#id4" id="id99">Service</a></p></li>
<li><p><a class="reference internal" href="#user" id="id100">User</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#module-development" id="id101">Module Development</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id5" id="id102">Roles</a></p>
<ul>
<li><p><a class="reference internal" href="#galaxy" id="id103">Galaxy</a></p>
<ul>
<li><p><a class="reference internal" href="#dependencies" id="id104">Dependencies</a></p></li>
<li><p><a class="reference internal" href="#community-roles" id="id105">Community Roles</a></p>
<ul>
<li><p><a class="reference internal" href="#network-interface" id="id106">Network Interface</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#jinja2" id="id107">Jinja2</a></p>
<ul>
<li><p><a class="reference internal" href="#id6" id="id108">Variables</a></p></li>
<li><p><a class="reference internal" href="#filters" id="id109">Filters</a></p></li>
<li><p><a class="reference internal" href="#comments" id="id110">Comments</a></p></li>
<li><p><a class="reference internal" href="#blocks" id="id111">Blocks</a></p></li>
<li><p><a class="reference internal" href="#id7" id="id112">Loops</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#plugins" id="id113">Plugins</a></p></li>
<li><p><a class="reference internal" href="#containers" id="id114">Containers</a></p></li>
<li><p><a class="reference internal" href="#best-practices" id="id115">Best Practices</a></p></li>
<li><p><a class="reference internal" href="#python-api" id="id116">Python API</a></p></li>
<li><p><a class="reference internal" href="#testing" id="id117">Testing</a></p>
<ul>
<li><p><a class="reference internal" href="#ansible-lint" id="id118">Ansible Lint</a></p></li>
<li><p><a class="reference internal" href="#molecule" id="id119">Molecule</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#dashboards" id="id120">Dashboards</a></p>
<ul>
<li><p><a class="reference internal" href="#ansible-tower-3" id="id121">Ansible Tower 3</a></p>
<ul>
<li><p><a class="reference internal" href="#gui" id="id122">GUI</a></p></li>
<li><p><a class="reference internal" href="#security" id="id123">Security</a></p>
<ul>
<li><p><a class="reference internal" href="#authentication" id="id124">Authentication</a></p></li>
<li><p><a class="reference internal" href="#rbac" id="id125">RBAC</a></p></li>
<li><p><a class="reference internal" href="#ssl" id="id126">SSL</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#api" id="id127">API</a></p></li>
<li><p><a class="reference internal" href="#recovery" id="id128">Recovery</a></p></li>
<li><p><a class="reference internal" href="#id8" id="id129">Updates</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#awx" id="id130">AWX</a></p>
<ul>
<li><p><a class="reference internal" href="#install" id="id131">Install</a></p></li>
<li><p><a class="reference internal" href="#upgrades" id="id132">Upgrades</a></p>
<ul>
<li><p><a class="reference internal" href="#automatic" id="id133">Automatic</a></p></li>
<li><p><a class="reference internal" href="#manual" id="id134">Manual</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#uninstall" id="id135">Uninstall</a></p></li>
<li><p><a class="reference internal" href="#postgresql-streaming-replication" id="id136">PostgreSQL Streaming Replication</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#rundeck" id="id137">Rundeck</a></p></li>
<li><p><a class="reference internal" href="#semaphore" id="id138">Semaphore</a></p></li>
<li><p><a class="reference internal" href="#tensor" id="id139">Tensor</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#history" id="id140">History</a></p></li>
<li><p><a class="reference internal" href="#bibliography" id="id141">Bibliography</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="introduction">
<h2><a class="toc-backref" href="#id10">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Ansible is a simple utility for automating configuration management and system administration tasks via SSH for UNIX-like operating systems. The only requirements are a SSH connection from a control node to a managed node and Python on both nodes. Ansible uses YAML syntax and does not require any knowledge of programming. [1]</p>
<p>There is also support for Windows modules. Ansible is executed on a control node that runs on Linux, using Python. A remote connection to WinRM (via HTTPS, by default) is made and then modules are executed remotely using PowerShell commands. [31]</p>
<p>Starting with Ansible 2.4, it has a 1 year life cycle. The first 4 months of the release get general bug and security updates. The next 4 months get major bug and security updates. Finally, the last 4 months only get security updates. [63]</p>
<p>Official documentation:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.ansible.com/ansible/latest/">Stable</a></p></li>
<li><p><a class="reference external" href="https://docs.ansible.com/ansible/devel/">Development</a></p></li>
<li><p><a class="reference external" href="https://docs.ansible.com/ansible/2.9/">2.9</a></p></li>
<li><p><a class="reference external" href="https://docs.ansible.com/ansible/2.8/">2.8</a></p></li>
<li><p><a class="reference external" href="https://docs.ansible.com/ansible/2.7/">2.7</a></p></li>
</ul>
<div class="section" id="editions">
<h3><a class="toc-backref" href="#id11">Editions</a><a class="headerlink" href="#editions" title="Permalink to this headline">¶</a></h3>
<p>There are two editions of Ansible available. There is the upstream Ansible community project which receives no support. For enterprise users, there is Red Hat Ansible Engine which provides support that covers Core modules, priority bug and feature updates, documentation, and more. Both use the same binary code with the only difference being support. [40]</p>
</div>
<div class="section" id="deprecations">
<h3><a class="toc-backref" href="#id12">Deprecations</a><a class="headerlink" href="#deprecations" title="Permalink to this headline">¶</a></h3>
<p>If a component in Ansible release <code class="docutils literal notranslate"><span class="pre">N</span></code> becomes deprecated then it is normally left unmaintained up until <code class="docutils literal notranslate"><span class="pre">N</span> <span class="pre">+</span> <span class="pre">4</span></code> when it is fully removed. For example, a module deprecated in 2.8 will be removed in 2.12. Ansible aims to be as highly backwards compatible as possible with each minor release.</p>
</div>
</div>
<div class="section" id="installation">
<h2><a class="toc-backref" href="#id13">Installation</a><a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>Ansible requires Python 2.7 or &gt;= 3.5 on both the control and managed nodes. [18] Python 3 support is stable and has been fully supported since the Ansible 2.5 release. [43]</p>
<p>Ansible RPMs for Fedora based operating systems are available from:</p>
<ul class="simple">
<li><p>The “extras” repository (Fedora)</p></li>
<li><p>The upstream Ansible repository <a class="reference external" href="http://releases.ansible.com/ansible/rpm/release/">http://releases.ansible.com/ansible/rpm/release/</a> (Enterprise Linux and Fedora)</p></li>
<li><p>The Ansible Engine repository (RHEL): <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">subscription-manager</span> <span class="pre">repos</span> <span class="pre">--enable=&lt;REPO&gt;</span></code></p>
<ul>
<li><p>RHEL 7: rhel-7-server-ansible-2-rpms OR rhel-7-server-ansible-2.9-rpms + rhel-7-server-extras-rpms</p></li>
<li><p>RHEL 8: ansible-2-for-rhel-8-x86_64-rpms OR ansible-2.9-for-rhel-8-x86_64-rpms</p></li>
</ul>
</li>
</ul>
<p>Fedora:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ sudo dnf install ansible-python3
</pre></div>
</div>
<p>Debian:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ sudo apt-get install software-properties-common
$ sudo apt-add-repository ppa:ansible/ansible
$ sudo apt-get update
$ sudo apt-get install ansible
</pre></div>
</div>
<p>Source code:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ git clone https://github.com/ansible/ansible.git
$ <span class="nb">cd</span> ./ansible/
$ git branch -a <span class="p">|</span> grep stable
$ git checkout remotes/origin/stable-2.7
$ git submodule update --init --recursive
$ <span class="nb">source</span> ./hacking/env-setup
</pre></div>
</div>
<p>Updating source code installations:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ git pull --rebase
$ git submodule update --init --recursive
</pre></div>
</div>
<p>Pre-release branch or tag directly from GitHub using pip:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ pip install --user git+https://github.com/ansible/ansible.git@&lt;BRANCH_OR_TAG&gt;
</pre></div>
</div>
<p>[18]</p>
<p>For managing Windows servers, the “winrm” Python library is required on the Ansible control node. The remote Windows servers need PowerShell &gt;= 3.0 installed and WinRM enabled. [31]</p>
</div>
<div class="section" id="configuration">
<h2><a class="toc-backref" href="#id14">Configuration</a><a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<div class="section" id="main">
<h3><a class="toc-backref" href="#id15">Main</a><a class="headerlink" href="#main" title="Permalink to this headline">¶</a></h3>
<p>All of the possible configuration files are listed below in the order
that they are read. The last file overrides any previous settings.</p>
<p>Configuration files:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">$ANSIBLE_CONFIG</span></code> = A command line variable containing the Ansible
configuration settings.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ansible.cfg</span></code> = If it is in the current directory, it will be used.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">~/.ansible.cfg</span></code> = The configuration file in a user’s home
directory.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">/etc/ansible/ansible.cfg</span></code> = The global configuration file.</p></li>
</ul>
<p>Common settings:</p>
<ul class="simple">
<li><p>[defaults]</p>
<ul>
<li><p>ansible_managed = String. The phrase that will be assigned to the
<code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">ansible_managed</span> <span class="pre">}}</span></code> variable. This should generally reside
at the top of a template file to indicate that the file is managed
by Ansible.</p></li>
<li><p>ask_pass = Boolean. Default: False. Prompt the user for the SSH
password.</p></li>
<li><p>ask_sudo_pass = Boolean. Default: False. Prompt the user for the
sudo password.</p></li>
<li><p>ask_vault_pass = Boolean. Default: False. Prompt the user for
the Ansible vault password.</p></li>
<li><p>command_warnings = Boolean. Default: True. Inform the user an
Ansible module can be used instead of running certain commands.</p></li>
<li><p>deprecation_warnings = Boolean. Default: True. Show deprecated
messages about features that will be removed in a future release
of Ansible.</p></li>
<li><p>display_skipped_hosts = Boolean. Default: True. Show tasks that
a skipped host would have run.</p></li>
<li><p>executable = String. Default: /bin/bash. The shell executable to
use.</p></li>
<li><p>forks = Integer. Default: 5. The number of parallel processes used
to run tasks on remote hosts. This is not how many hosts a
Playbook or module can run on, that is handled by the “serial”
module. This helps to increase the performance of many operations
across a large number of remote hosts.</p></li>
<li><p>host_key_checking = Boolean. Default: True. Do not automatically
accept warnings about leaving SSH fingerprints on a connection to
a new host.</p></li>
<li><p>internal_poll_interval = Float. Default: 0.001. The number of
seconds to wait before checking on the status of a module that is
being executed.</p></li>
<li><p>inventory = String. Default: /etc/ansible/hosts. The default
inventory file to find hosts from.</p></li>
<li><p>log_path = String. Default: none. The file to log Ansible’s
operations.</p></li>
<li><p>nocolor. Boolean. Default: 0. Do not format Ansible output with
color.</p></li>
<li><p>nocows = Boolean. Default: 0. If the <code class="docutils literal notranslate"><span class="pre">cowsay</span></code> binary is present,
a Playbook will output information using a cow.</p></li>
<li><p>hosts = String. Default: *. The hosts to run a Playbook on if no
host is specified. The default is to run on all hosts.</p></li>
<li><p>private_key_file = String. The private SSH key file to use.</p></li>
<li><p>remote_port = Integer. Default: 22. The SSH port used for remote
connections.</p></li>
<li><p>remote_tmp = String. Default: ~/.ansible/tmp. The temporary
directory on the remote server to save information to.</p></li>
<li><p>remote_user = String. Default: root. The default <code class="docutils literal notranslate"><span class="pre">ansible_user</span></code>
to use for SSH access.</p></li>
<li><p>roles_path = String. The path to the location of installed roles.</p></li>
<li><p>sudo_exe = String. Default: sudo. The binary to run to execute
commands as a non-privileged user.</p></li>
<li><p>sudo_user = String. Default: root. The user that sudo should run
as.</p></li>
<li><p>timeout = Integer. Default: 10. The amount of time, in seconds, to
wait for a SSH connection to a remote host.</p></li>
<li><p>vault_password_file = String. The default file to use for the
Vault password.</p></li>
</ul>
</li>
<li><p>[privilege_escalation]</p>
<ul>
<li><p>become = Boolean. Default: False. This specifies if root level
commands should be run by a privileged user.</p></li>
<li><p>become_method = String. Default: sudo. The method to run root
tasks.</p></li>
<li><p>become_user = String. Default: root. The user to change to to run
root tasks.</p></li>
<li><p>become_ask_pass = Boolean. Default: False. Ask the end-user for
a password for the become method.</p></li>
</ul>
</li>
<li><p>[ssh_connection]</p>
<ul>
<li><p>ssh_args = String. Additional SSH arguments.</p></li>
<li><p>retries = Integer. Default: 0 (keep retrying). How many times
should an SSH connection attempt to reconnect after a failure.</p></li>
<li><p>pipelining = Boolean. Default: False. Ansible modules can be
combined and sent to the remote host via SSH to help save time and
improve performance. This is disabled by default because <code class="docutils literal notranslate"><span class="pre">sudo</span></code>
accounts usually have the “requiretty” option enabled that is not
compatible with pipelining.</p></li>
<li><p>ansible_ssh_executable = String. Default: ssh (found in the
$PATH environment variable). The path to the <code class="docutils literal notranslate"><span class="pre">ssh</span></code> binary.</p></li>
</ul>
</li>
</ul>
<p>[27]</p>
</div>
<div class="section" id="python-3">
<h3><a class="toc-backref" href="#id16">Python 3</a><a class="headerlink" href="#python-3" title="Permalink to this headline">¶</a></h3>
<p>Python 3 is supported on the control node and managed nodes. For using
Python 3 on the managed nodes, the <code class="docutils literal notranslate"><span class="pre">ansible_python_interpreter</span></code>
variable needs to be set to reference the path to the managed nodes’
Python 3.</p>
<p>Example:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ /usr/bin/python3 /usr/bin/ansible -e <span class="s2">&quot;ansible_python_interpreter=/usr/bin/python3&quot;</span> -m setup localhost
</pre></div>
</div>
<p>Documentation on how to create Ansible modules for Python 3 with
backwards compatibility with Python 2 can be found <a class="reference external" href="https://docs.ansible.com/ansible/devel/dev_guide/developing_python_3.html">here</a>.</p>
<p>[43]</p>
</div>
</div>
<div class="section" id="commands-usage">
<h2><a class="toc-backref" href="#id17">Commands Usage</a><a class="headerlink" href="#commands-usage" title="Permalink to this headline">¶</a></h2>
<p>See: <a class="reference external" href="../commands/configuration_management.html#ansible">Linux Commands - Configuration Management - Ansible</a>.</p>
</div>
<div class="section" id="playbooks">
<h2><a class="toc-backref" href="#id18">Playbooks</a><a class="headerlink" href="#playbooks" title="Permalink to this headline">¶</a></h2>
<p>Playbooks organize tasks into one or more YAML files. It can be a
self-contained file or a large project organized in a directory.
Official examples can he found here at
<a class="reference external" href="https://github.com/ansible/ansible-examples">https://github.com/ansible/ansible-examples</a>.</p>
<div class="section" id="tasks">
<h3><a class="toc-backref" href="#id19">Tasks</a><a class="headerlink" href="#tasks" title="Permalink to this headline">¶</a></h3>
<p>Tasks and roles defined in a playbook are executed in this specific order:</p>
<ul class="simple">
<li><p>pre_tasks</p></li>
<li><p>roles</p></li>
<li><p>tasks</p></li>
<li><p>post_tasks</p></li>
</ul>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Example of running tasks.</span>
  <span class="nt">hosts</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">all</span>

  <span class="nt">pre_tasks</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">debug</span><span class="p">:</span>
        <span class="nt">msg</span><span class="p">:</span> <span class="s">&quot;Hello</span><span class="nv"> </span><span class="s">world</span><span class="nv"> </span><span class="s">from</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">pre</span><span class="nv"> </span><span class="s">task</span><span class="nv"> </span><span class="s">(before</span><span class="nv"> </span><span class="s">installing</span><span class="nv"> </span><span class="s">NGINX).&quot;</span>

  <span class="nt">roles</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">nginx</span>

  <span class="nt">tasks</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">debug</span><span class="p">:</span>
        <span class="nt">msg</span><span class="p">:</span> <span class="s">&quot;Hello</span><span class="nv"> </span><span class="s">world</span><span class="nv"> </span><span class="s">from</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">second</span><span class="nv"> </span><span class="s">task</span><span class="nv"> </span><span class="s">(after</span><span class="nv"> </span><span class="s">installing</span><span class="nv"> </span><span class="s">NGINX).&quot;</span>

  <span class="nt">post_tasks</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">debug</span><span class="p">:</span>
        <span class="nt">msg</span><span class="p">:</span> <span class="s">&quot;Hello</span><span class="nv"> </span><span class="s">world</span><span class="nv"> </span><span class="s">from</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">third</span><span class="nv"> </span><span class="s">task</span><span class="nv"> </span><span class="s">(after</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">normal</span><span class="nv"> </span><span class="s">tasks).&quot;</span>
</pre></div>
</div>
<p>[78]</p>
</div>
<div class="section" id="directory-structure">
<h3><a class="toc-backref" href="#id20">Directory Structure</a><a class="headerlink" href="#directory-structure" title="Permalink to this headline">¶</a></h3>
<p>A Playbook can be self-contained entirely into one file. However,
especially for large projects, each segment of the Playbook should be
split into separate files and directories.</p>
<p>Layout:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>├── production/
│   ├── group_vars/
│   ├── host_vars/
│   └── inventory
├── staging/
│   ├── group_vars/
│   ├── host_vars/
│   └── inventory
├── roles/
│   └── general/
│       ├── defaults/
│       │   └── main.yml
│       ├── files/
│       ├── handlers/
│       │   └── main.yml
│       ├── meta/
│       │   └── main.yml
│       ├── tasks/
│       │   └── main.yml
│       ├── templates/
│       └── vars/
│           └── main.yml
└── site.yml
</pre></div>
</div>
<p>Layout Explained:</p>
<ul class="simple">
<li><p>production/ = A directory that contains information about the
Ansible-controlled hosts and inventory variables. This should be used
for deploying to live production environments. Alternatively, simple
Playbooks can use a “production” file to list all of the inventory
servers there.</p>
<ul>
<li><p>group_vars/ = Group specific variables. A file named “all” can be
used to define global variables for all hosts.</p></li>
<li><p>host_vars/ = Host specific variables.</p></li>
<li><p>inventory = The main “production” inventory file.</p></li>
</ul>
</li>
<li><p>staging/ = The same as the “production/” directory except this is
designed for running Playbooks in testing environments.</p></li>
<li><p>roles/ = This directory should contain all of the different roles.</p>
<ul>
<li><p>general/ = A role name. This can be anything.</p>
<ul>
<li><p>defaults/ = Define default variables. If any variables are
defined elsewhere, these will be overridden.</p>
<ul>
<li><p>main.yml = Each main.yml file is executed as the first file.
Additional separation of operations can be split into
different files that can be accessed via “include:”
statements.</p></li>
</ul>
</li>
<li><p>files/ = Store static files that are not modified.</p></li>
<li><p>handlers/ = Specify alias commands that can be called using the
“notify:” method.</p>
<ul>
<li><p>main.yml</p></li>
</ul>
</li>
<li><p>meta/ = Specify role dependencies and Playbook information such
as author, version, etc. These can be other roles and/or
Playbooks.</p>
<ul>
<li><p>main.yml</p></li>
</ul>
</li>
<li><p>tasks/</p>
<ul>
<li><p>main.yml = The tasks’ main file is executed first for the
entire role.</p></li>
</ul>
</li>
<li><p>templates/ = Store dynamic files that will be generated based
on variables.</p></li>
<li><p>vars/ = Define role-specific variables.</p>
<ul>
<li><p>main.yml</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>site.yml = This is typically the default Playbook file to execute.
Any name and any number of Playbook files can be used here to include
different roles.</p></li>
</ul>
<p>Examples:</p>
<ul>
<li><p>site.yml = This is generally the main Playbook file. It should
include all other Playbook files required if more than one is used.
[5]</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="c1"># File: site.yaml</span>
<span class="nt">include</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">nginx.yml</span>
<span class="nt">include</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">php-fpm.yml</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="c1"># File: nginx.yml</span>
<span class="p p-Indicator">-</span>  <span class="nt">hosts</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">webnodes</span>
   <span class="nt">roles</span><span class="p">:</span>
     <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">common</span>
     <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">nginx</span>
</pre></div>
</div>
</li>
<li><p>roles/<code class="docutils literal notranslate"><span class="pre">&lt;ROLENAME&gt;</span></code>/vars/main.yml = Global variables for a role.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="c1"># File: vars/main.yaml</span>
<span class="nt">memcache_hosts</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">192.168.1.11</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">192.168.1.12</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">192.168.1.13</span>
<span class="nt">ldap_ip</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">192.168.10.1</span>
</pre></div>
</div>
</li>
<li><p>group_vars/ and host_vars/ = These files define variables for hosts
and/or groups. Details about this can be found in the
<a class="reference external" href="#configuration---inventory---variables">Variables</a> section.</p></li>
<li><p>templates/ = Template configuration files for services. The files in
here end with a “.j2” suffix to signify that it uses the Jinja2
template engine. [1]</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>My domain name is {{ domain }}<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="performance-tuning">
<h3><a class="toc-backref" href="#id21">Performance Tuning</a><a class="headerlink" href="#performance-tuning" title="Permalink to this headline">¶</a></h3>
<p>A few configuration changes can help to speed up the runtime of Ansible
modules and Playbooks.</p>
<ul class="simple">
<li><p>ansible.cfg</p>
<ul>
<li><p>[defaults]</p>
<ul>
<li><p>forks = The number of parallel processes that are spun up for remote connections. Each fork connects to one host. The default is 5. This should be increased to a larger number to handle . The recommended number is between <code class="docutils literal notranslate"><span class="pre">processor_cores</span> <span class="pre">x</span> <span class="pre">10</span></code> and <code class="docutils literal notranslate"><span class="pre">100</span> <span class="pre">per</span> <span class="pre">4GB</span> <span class="pre">RAM</span></code> depending on whether the Ansible tasks are CPU- or RAM-bound. Ansible is normally CPU-bound.</p></li>
<li><p>pipelining = Enable pipelining to bundle commands together that
do not require a file transfer. This is disabled by default
because most sudo users are enforced to use the <code class="docutils literal notranslate"><span class="pre">requiretty</span></code>
sudo option that pipelining is incompatible with. [26]</p></li>
<li><p>gathering = Set this to “explicit” to only gather the necessary
facts when/if they are required by the Playbook. [27]</p></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Fact caching will temporarily save information gathered about hosts. By only gathering the setup/host fact once, this helps to speed up execution time if playbooks will need to be ran multiple times. The supported types of fact caching are currently memory (none), jsonfile, memcached, mongodb, pickle, redis, and yaml. [19]</p>
<p>All:</p>
<ul class="simple">
<li><p>ansible.cfg</p>
<ul>
<li><p>[defaults]</p>
<ul>
<li><p>gathering = smart</p></li>
<li><p>fact_caching = 86400 # This will set the cache time to 1 day.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>JSON File:</p>
<ul class="simple">
<li><p>ansible.cfg</p>
<ul>
<li><p>[defaults]</p>
<ul>
<li><p>fact_caching = jsonfile</p></li>
<li><p>fact_caching_connection =
<code class="docutils literal notranslate"><span class="pre">&lt;TEMPORARY_DIRECTORY_TO_AUTOMATICALLY_CREATE&gt;</span></code></p></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Redis:</p>
<ul class="simple">
<li><p>ansible.cfg</p>
<ul>
<li><p>[defaults]</p>
<ul>
<li><p>fact_caching = redis</p></li>
<li><p>fact_caching_connection = <code class="docutils literal notranslate"><span class="pre">&lt;HOST&gt;:&lt;PORT&gt;</span></code></p></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>[4]</p>
<p>If tasks between hosts can run independently of each other, then tasks can be allowed to move onto the next one immediately when a host is done (even if other hosts are not).</p>
<ul class="simple">
<li><p>ansible.cfg</p>
<ul>
<li><p>[defaults]</p>
<ul>
<li><p>strategy = free</p></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>[36]</p>
</div>
</div>
<div class="section" id="inventory">
<h2><a class="toc-backref" href="#id22">Inventory</a><a class="headerlink" href="#inventory" title="Permalink to this headline">¶</a></h2>
<p>Default file: /etc/ansible/hosts</p>
<p>The hosts file is referred to as the “inventory” for Ansible. Here
servers and groups of servers are defined. Ansible can then be used to
execute commands and/or Playbooks on these hosts. There are two groups
that are automatically created by Ansible. The “all” group is every
defined host and “ungrouped” is a group of hosts that do not belong to
any groups. User defined groups are created by using brackets “[” and
“]” to specify the name.</p>
<p>Syntax:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">&lt;SERVER1NAME&gt; ansible_host</span><span class="o">=</span><span class="s">&lt;SERVER1_HOSTNAME&gt;</span>

<span class="k">[&lt;GROUPNAME&gt;]</span>
<span class="na">&lt;SERVER1NAME&gt;</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[dns-us]</span>
<span class="na">dns-us01</span>
<span class="na">dns-us02</span>
<span class="na">dns-us03</span>
</pre></div>
</div>
<p>A sequence of letters “[a:z]” or numbers “[0:9]” can be used to
dynamically define a large number of hosts.</p>
<p>Example:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[dns-us]</span>
<span class="na">dns-us[01:03]</span>
</pre></div>
</div>
<p>A group can also be created from other groups by using the “:children”
tag.</p>
<p>Example:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[dns-global:children]</span>
<span class="na">dns-us</span>
<span class="na">dns-ca</span>
<span class="na">dns-mx</span>
</pre></div>
</div>
<p>Variables are created for a host and/or group using the tag “:vars”.
Then any custom variable can be defined and associated with a string. A
host specifically can also have it’s variables defined on the same line
as it’s Ansible inventory variables. [3] A few examples are listed
below. These can also be defined in separate files as explained in the “Variables” chapter.</p>
<p>Example:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">examplehost ansible_user</span><span class="o">=</span><span class="s">toor ansible_host=192.168.0.1 custom_var_here=True</span>
</pre></div>
</div>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[examplegroup:vars]</span>
<span class="na">domain_name</span><span class="o">=</span><span class="s">examplehost.tld</span>
<span class="na">domain_ip</span><span class="o">=</span><span class="s">192.168.7.7</span>
</pre></div>
</div>
<p>There are a large number of customizations that can be used to suit most
server’s access requirements.</p>
<p>Common inventory options:</p>
<ul class="simple">
<li><p>ansible_host = The IP address or hostname of the server.</p></li>
<li><p>ansible_port = A custom SSH port (i.e., if not using the standard
port 22).</p></li>
<li><p>ansible_connection = These options specify how to log in to execute
tasks.</p>
<ul>
<li><p>chroot = Run commands in a directory using chroot.</p></li>
<li><p>local = Run on the local system.</p></li>
<li><p>ssh = Run commands over a remote SSH connection (default).</p></li>
<li><p>winrm = Use the Windows Remote Management (WinRM) protocols to
connect to Windows servers.</p></li>
</ul>
</li>
<li><p>ansible_winrm_server_cert_validation</p>
<ul>
<li><p>ignore = Ignore self-signed certificates for SSL/HTTPS connections
via WinRM.</p></li>
</ul>
</li>
<li><p>ansible_user = The SSH user.</p></li>
<li><p>ansible_pass = The SSH user’s password. This is very insecure to
keep passwords in plain text files so it is recommended to use SSH
keys or pass the “–ask-pass” option to ansible when running tasks.</p></li>
<li><p>ansible_ssh_private_key_file = Specify the private SSH key to use
for accessing the server(s).</p></li>
<li><p>ansible_ssh_common_args = Append additional SSH command-line
arguments for sftp, scp, and ssh.</p></li>
<li><p>ansible_{sftp|scp|ssh}_extra_args = Append arguments for the
specified utility.</p></li>
<li><p>ansible_python_interpreter = This will force Ansible to run on
remote systems using a different Python binary. Ansible only supports
Python 2 so on server’s where only Python 3 is available a custom
install of Python 2 can be used instead. [3]</p></li>
<li><p>ansible_vault_password_file = Specify the file to read the Vault
password from. [21]</p></li>
<li><p>ansible_become = Set to “True” or “yes” to become a different user
than the ansible_user once logged in.</p>
<ul>
<li><p>ansible_become_method = Pick a method for switching users. Valid
options are: sudo, su, pbrun, pfexec, doas, or dzdo.</p></li>
<li><p>ansible_become_user = Specify the user to become.</p></li>
<li><p>ansible_become_pass = Optionally use a password to change users.
[13]</p></li>
</ul>
</li>
</ul>
<p>Examples:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">localhost ansible_connection</span><span class="o">=</span><span class="s">local</span>
<span class="na">dns1 ansible_host</span><span class="o">=</span><span class="s">192.168.1.53 ansible_port=2222 ansible_become=True ansible_become_user=root ansible_become_method=sudo</span>
<span class="na">dns2 ansible_host</span><span class="o">=</span><span class="s">192.168.1.54</span>
<span class="na">/home/user/ubuntu1604 ansible_connection</span><span class="o">=</span><span class="s">chroot</span>
</pre></div>
</div>
<p>[4]</p>
<div class="section" id="production-and-staging">
<h3><a class="toc-backref" href="#id23">Production and Staging</a><a class="headerlink" href="#production-and-staging" title="Permalink to this headline">¶</a></h3>
<p>Ansible best practices suggest having a separation between a production
and staging inventory. Changes should be tested in the staging
environment and then eventually ran on the production server(s).</p>
<p>Scenario #1 - Use the Same Variables</p>
<p>A different inventory file can be created if all of the variables are
the exact same in the production and staging environments. This will run
the same Playbook roles on a different server.</p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>├── production
├── staging
├── group_vars
│   └── &lt;GROUP&gt;
├── host_vars
│   └── &lt;HOST&gt;
</pre></div>
</div>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ ansible-playbook -i production &lt;PLAYBOOK&gt;.yml
</pre></div>
</div>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ ansible-playbook -i staging &lt;PLAYBOOK&gt;.yml
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>├── production
├── staging
├── group_vars
│   ├── web
│   ├── db
│   └── all
├── host_vars
│   ├── web1
│   ├── web2
│   ├── db1
│   ├── db2
│   └── db3
</pre></div>
</div>
<p>Scenario #2 - Use Different Variables</p>
<p>In more complex scenarios, the inventory and variables will be different
in production and staging. This requires further separation. Instead of
using a “production” or “staging” inventory file, they can be split into
directories. These directories contain their own group and host
variables. The production example also shows how to separate plain-text and Vault encrypted variables.</p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>├── production
│   ├── group_vars
│   │   └── &lt;GROUP&gt;
│   │       ├── vars
│   │       └── vault
│   ├── host_vars
│   │   └── &lt;HOST&gt;
│   │       ├── vars
│   │       └── vault
│   └── inventory
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>├── staging
│   ├── group_vars
│   │   └── &lt;GROUP&gt;
│   ├── host_vars
│   │   └── &lt;HOST&gt;
│   └── inventory
</pre></div>
</div>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ ansible-playbook -i production &lt;PLAYBOOK&gt;.yml
</pre></div>
</div>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ ansible-playbook -i staging &lt;PLAYBOOK&gt;.yml
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>├── production
│   ├── group_vars
│   │   ├── web
│   │   ├── db
│   │   └── all
│   ├── host_vars
│   │   ├── web1
│   │   ├── web2
│   │   ├── db1
│   │   ├── db2
│   │   └── db3
│   └── inventory
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>├── staging
│   ├── group_vars
│   │   ├── web
│   │   ├── db
│   │   └── all
│   ├── host_vars
│   │   ├── web1
│   │   ├── web2
│   │   ├── db1
│   │   ├── db2
│   │   └── db3
│   └── inventory
</pre></div>
</div>
<p>[5][22]</p>
</div>
<div class="section" id="vault-encryption">
<h3><a class="toc-backref" href="#id24">Vault Encryption</a><a class="headerlink" href="#vault-encryption" title="Permalink to this headline">¶</a></h3>
<p>Any file in a Playbook can be encrypted. This is useful for storing
sensitive username and passwords securely. A password is used to open
these files after encryption. All encrypted files in a Playbook should
use the same password.</p>
<p>Vault Usage:</p>
<ul>
<li><p>Create a new encrypted file.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ ansible-vault create &lt;FILE&gt;.yml
</pre></div>
</div>
</li>
<li><p>Encrypt an existing plaintext file.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ ansible-vault encrypt &lt;FILE&gt;.yml
</pre></div>
</div>
</li>
<li><p>Viewing the contents of the file.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ ansible-vault view &lt;FILE&gt;.yml
</pre></div>
</div>
</li>
<li><p>Edit the encrypted file.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ ansible-vault edit &lt;FILE&gt;.yml
</pre></div>
</div>
</li>
<li><p>Change the password.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ ansible-vault rekey &lt;FILE&gt;.yml
</pre></div>
</div>
</li>
<li><p>Decrypt to plaintext.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ ansible-vault decrypt &lt;FILE&gt;.yml
</pre></div>
</div>
</li>
</ul>
<p>Playbook Usage:</p>
<ul>
<li><p>Run a Playbook, prompting the user for the Vault password.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ ansible-playbook --ask-vault-pass &lt;PLAYBOOK&gt;.yml
</pre></div>
</div>
</li>
<li><p>Run the Playbook, reading the file for the vault password.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ ansible-playbook --vault-password-file &lt;PATH_TO_VAULT_PASSWORD_FILE&gt; &lt;PLAYBOOK&gt;.yml
</pre></div>
</div>
</li>
</ul>
<p>[21]</p>
</div>
<div class="section" id="dynamic">
<h3><a class="toc-backref" href="#id25">Dynamic</a><a class="headerlink" href="#dynamic" title="Permalink to this headline">¶</a></h3>
<p>Dynamic inventory can be used to automatically obtain information about
hosts from various infrastructure platforms and tools. Community
provided scripts be be found here:
<a class="reference external" href="https://github.com/ansible/ansible/tree/devel/contrib/inventory">https://github.com/ansible/ansible/tree/devel/contrib/inventory</a>.</p>
</div>
</div>
<div class="section" id="variables">
<h2><a class="toc-backref" href="#id26">Variables</a><a class="headerlink" href="#variables" title="Permalink to this headline">¶</a></h2>
<p>Variables that Playbooks will use can be defined for specific hosts
and/or groups. The file that stores the variables should reflect the
name of the host and/or group. Global variables can be found in the
<code class="docutils literal notranslate"><span class="pre">/etc/ansible/</span></code> directory. [3]</p>
<p>Inventory variable directories and files:</p>
<ul class="simple">
<li><p>host_vars/</p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;HOST&gt;</span></code> = Variables for a host defined in the inventory file.</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p>group_vars/</p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;GROUP&gt;</span></code>/</p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p>vars = Variables for this group.</p></li>
<li><p>vault = Encrypted Ansible Vault variables. [5]</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p>all = This file contains variables for all hosts.</p></li>
<li><p>ungrouped = This file contains variables for all hosts that are not defined in any groups.</p></li>
</ul>
</div></blockquote>
<p>It is assumed that the inventory variable files are in YAML format. Here
is an example for a host variable file.</p>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="nt">domain_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">examplehost.tld</span>
<span class="nt">domain_ip</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">192.168.10.1</span>
<span class="nt">hello_string</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Hello World!</span>
</pre></div>
</div>
<p>In the Playbook and/or template files, these variables can then be
referenced when enclosed by double braces “{{” and “}}”. [4]</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Hello world from {{ domain_name }}!
</pre></div>
</div>
<p>Variables from other hosts or groups can also be referenced.</p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{{</span> <span class="n">groupvars</span><span class="p">[</span><span class="s1">&#39;&lt;GROUPNAME&gt;&#39;</span><span class="p">][</span><span class="s1">&#39;&lt;VARIABLE&gt;&#39;</span><span class="p">]</span> <span class="p">}}</span>
<span class="p">{{</span> <span class="n">hostvars</span><span class="p">[</span><span class="s1">&#39;&lt;HOSTNAME&gt;&#39;</span><span class="p">][</span><span class="s1">&#39;&lt;VARIABLE&gt;&#39;</span><span class="p">]</span> <span class="p">}}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{{</span> <span class="n">groupvars</span><span class="o">.&lt;</span><span class="n">HOSTNAME</span><span class="o">&gt;.&lt;</span><span class="n">VARIABLE</span><span class="o">&gt;</span><span class="p">}}</span>
<span class="p">{{</span> <span class="n">hostvars</span><span class="o">.&lt;</span><span class="n">HOSTNAME</span><span class="o">&gt;.&lt;</span><span class="n">VARIABLE</span><span class="o">&gt;</span> <span class="p">}}</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="n">command</span><span class="p">:</span> <span class="n">echo</span> <span class="p">{{</span> <span class="n">hostvars</span><span class="o">.</span><span class="n">db3</span><span class="o">.</span><span class="n">hostname</span> <span class="p">}}</span>
</pre></div>
</div>
<p>The order that variables take precedence in is listed below. The bottom
locations get overridden by anything above them.</p>
<ul class="simple">
<li><p>extra vars</p></li>
<li><p>task vars</p></li>
<li><p>block vars</p></li>
<li><p>role and include vars</p></li>
<li><p>set_facts</p></li>
<li><p>registered vars</p></li>
<li><p>play vars_files</p></li>
<li><p>play vars_prompt</p></li>
<li><p>play vars</p></li>
<li><p>host facts</p></li>
<li><p>playbook host_vars</p></li>
<li><p>playbook group_vars</p></li>
<li><p>inventory host_vars</p></li>
<li><p>inventory group_vars</p></li>
<li><p>inventory vars</p></li>
<li><p>role defaults</p></li>
</ul>
<p>[5]</p>
<div class="section" id="magic-variables">
<h3><a class="toc-backref" href="#id27">Magic Variables</a><a class="headerlink" href="#magic-variables" title="Permalink to this headline">¶</a></h3>
<p>Magic variables are variables that Ansible creates and manages outside of user-defined variables. Most of these exist with every playbook run.</p>
<ul class="simple">
<li><p>ansible_check_mode = If the playbook is ran with <code class="docutils literal notranslate"><span class="pre">--check</span></code> mode to see if tasks will make any modifications.</p></li>
<li><p>ansible_dependent_role_names = A list of all of the roles imported as dependencies by playbooks that are referenced in the main playbook.</p></li>
<li><p>ansible_diff_mode = If the playbook is ran with <code class="docutils literal notranslate"><span class="pre">--diff</span></code> mode to see what modifications were made.</p></li>
<li><p>ansible_forks = The number of forks that are set.</p></li>
<li><p>ansible_inventory_sources = A list of all of the inventory files that are loaded.</p></li>
<li><p>ansible_limit = The string of hosts defined by <code class="docutils literal notranslate"><span class="pre">--limit</span></code> that the playbook is currently limited to.</p></li>
<li><p>ansible_play_batch = The current hosts that are running, limited to only the hosts running from the <code class="docutils literal notranslate"><span class="pre">serial</span></code> size.</p></li>
<li><p>ansible_play_hosts = The list of all of the (non-failed) hosts that the playbook <code class="docutils literal notranslate"><span class="pre">hosts</span></code> is set to use.</p></li>
<li><p>ansible_play_name = The name of the playbook that is running.</p></li>
<li><p>ansible_play_role_names = A list of the roles that are defined in the playbook file.</p></li>
<li><p>ansible_playbook_python = The Python executable used to run Ansible on the control node.</p></li>
<li><p>ansible_run_tags = A list of tags that are defined by <code class="docutils literal notranslate"><span class="pre">--tags</span></code> that the playbook is running.</p></li>
<li><p>ansible_skip_tags = A list of tags that are defined by <code class="docutils literal notranslate"><span class="pre">--skip-tags</span></code> that the playbook is skipping.</p></li>
<li><p>ansible_user_dir = The $HOME directory for the user that is being accessed on the managed node.</p></li>
<li><p>ansible_verbosity = The level of verbosity set for the playbook execution.</p></li>
<li><p>ansible_version = The Ansible version running.</p></li>
<li><p>hostvars = Access variables from another host. Example: <code class="docutils literal notranslate"><span class="pre">hostvars['web01']['ansible_hostname']</span></code>.</p></li>
<li><p>inventory_dir = The directory that contains the inventory file(s).</p></li>
<li><p>inventory_file = The full path to the primary “inventory” file that is loaded.</p></li>
<li><p>inventory_hostname = The hostname of the current host that is being used.</p></li>
<li><p>inventory_hostname_short = The subdomain of the current host’s domain that is being used.</p></li>
<li><p>groups = A list of all hosts and groups from the inventories that are loaded.</p></li>
<li><p>group_names = A list of all of the groups that the current host is a part of.</p></li>
<li><p>playbook_dir = The full path to the directory where the current playbook is located.</p></li>
<li><p>omit = Used to skip the passing of an argument to a task. This is commonly used via the use of the Jinja filter <code class="docutils literal notranslate"><span class="pre">default(omit)</span></code>.</p></li>
<li><p>role_name = The name of the current role in use.</p></li>
<li><p>role_path = The full path to the current role in use.</p></li>
</ul>
<p>[82]</p>
</div>
</div>
<div class="section" id="modules">
<h2><a class="toc-backref" href="#id28">Modules</a><a class="headerlink" href="#modules" title="Permalink to this headline">¶</a></h2>
<p>A list of all of the latest Ansible modules is provided <a class="reference external" href="http://docs.ansible.com/ansible/latest/modules/list_of_all_modules.html">here</a>.</p>
<div class="section" id="main-modules">
<h3><a class="toc-backref" href="#id29">Main Modules</a><a class="headerlink" href="#main-modules" title="Permalink to this headline">¶</a></h3>
<p>Root Pages refers to generic Playbook-related modules as the “main
modules.” This is not to be confused with official naming of “core
modules” which is a mixture of both the main and regular modules
mentioned in this guide.</p>
<div class="section" id="assert">
<h4><a class="toc-backref" href="#id30">Assert</a><a class="headerlink" href="#assert" title="Permalink to this headline">¶</a></h4>
<p>Assert is used to check if one or more statements is True. The module
will fail if any statement returns False. Optionally, a message can be
displayed if any operator comparisons return False.</p>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">assert</span><span class="p">:</span>
    <span class="nt">that</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="s">&quot;&lt;VALUE1&gt;</span><span class="nv"> </span><span class="s">&lt;COMPARISON_OPERATOR&gt;</span><span class="nv"> </span><span class="s">&lt;VALUE2&gt;&quot;</span>
    <span class="nt">msg</span><span class="p">:</span> <span class="s">&quot;&lt;MESSAGE&gt;&quot;</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">cmd</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/usr/bin/date</span>
  <span class="nt">register</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">date_command</span>
  <span class="nt">ignore_errors</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>

<span class="p p-Indicator">-</span> <span class="nt">assert</span><span class="p">:</span>
    <span class="nt">that</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="s">&quot;date_command.rc</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">0&quot;</span>
      <span class="p p-Indicator">-</span> <span class="s">&quot;&#39;2017&#39;</span><span class="nv"> </span><span class="s">in</span><span class="nv"> </span><span class="s">date_command.stdout&quot;</span>
    <span class="nt">msg</span><span class="p">:</span> <span class="s">&quot;Date</span><span class="nv"> </span><span class="s">either</span><span class="nv"> </span><span class="s">failed</span><span class="nv"> </span><span class="s">or</span><span class="nv"> </span><span class="s">did</span><span class="nv"> </span><span class="s">not</span><span class="nv"> </span><span class="s">return</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">correct</span><span class="nv"> </span><span class="s">year.&quot;</span>
</pre></div>
</div>
<p>[45]</p>
</div>
<div class="section" id="async">
<h4><a class="toc-backref" href="#id31">Async</a><a class="headerlink" href="#async" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">async</span></code> function is used to start a detached task on a managed
system. Ansible will then poll that system periodically to see if the
task is complete. By default, it checks every 10 seconds and will only
move onto the next task if all of the processes are complete.
Tasks with loops will execute the module in parallel for each item.
By using <code class="docutils literal notranslate"><span class="pre">poll:</span> <span class="pre">0</span></code>, the task will be ran in the background and Ansible
will continue onto the next task. Do not set <code class="docutils literal notranslate"><span class="pre">async:</span> <span class="pre">0</span></code> as that will disable async.</p>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">async</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;MAXIMUM_SECONDS_TO_RUN&gt;</span>
<span class="nt">poll</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;INTERNAL_IN_SECONDS&gt;</span>
</pre></div>
</div>
<p>This example will run a command, check every 5 seconds to see if it is complete, until 15 seconds has elapsed. If it is still not complete, Ansible will end that async process and mark the task as being failed.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">command</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">bash /usr/local/bin/example.sh</span>
  <span class="nt">async</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">15</span>
  <span class="nt">poll</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">5</span>
</pre></div>
</div>
<p>[15]</p>
</div>
<div class="section" id="block">
<h4><a class="toc-backref" href="#id32">Block</a><a class="headerlink" href="#block" title="Permalink to this headline">¶</a></h4>
<p>A <code class="docutils literal notranslate"><span class="pre">block</span></code> is used to handle logic for executing tasks. A set of tasks
can be run, for example, if a condition is met. This also handles errors
in a <code class="docutils literal notranslate"><span class="pre">try/except</span></code> fashion. If the code from the <code class="docutils literal notranslate"><span class="pre">block</span></code> fails then
it proceeds to run the tasks in the <code class="docutils literal notranslate"><span class="pre">rescue</span></code> section. There is also a
final <code class="docutils literal notranslate"><span class="pre">always</span></code> section that will execute whether the block failed or
not.</p>
<p>Syntax (minimal):</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">block</span><span class="p">:</span>
</pre></div>
</div>
<p>Syntax (full):</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">block</span><span class="p">:</span>
  <span class="l l-Scalar l-Scalar-Plain">&lt;ACTIONS&gt;</span>
<span class="nt">rescue</span><span class="p">:</span>
  <span class="l l-Scalar l-Scalar-Plain">&lt;ACTIONS&gt;</span>
<span class="nt">always</span><span class="p">:</span>
  <span class="l l-Scalar l-Scalar-Plain">&lt;ACTIONS&gt;</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Installing docker</span>
  <span class="nt">block</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">package</span><span class="p">:</span>
        <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">docker</span>
        <span class="nt">state</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">latest</span>
  <span class="nt">rescue</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">debug</span><span class="p">:</span>
        <span class="nt">msg</span><span class="p">:</span> <span class="s">&quot;Unable</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">properly</span><span class="nv"> </span><span class="s">install</span><span class="nv"> </span><span class="s">docker.</span><span class="nv"> </span><span class="s">Cleaning</span><span class="nv"> </span><span class="s">up</span><span class="nv"> </span><span class="s">now.&quot;</span>
    <span class="p p-Indicator">-</span> <span class="nt">file</span><span class="p">:</span>
        <span class="nt">dest</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/path/to/custom/docker/files</span>
        <span class="nt">state</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">absent</span>
  <span class="nt">always</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">debug</span><span class="p">:</span>
        <span class="nt">msg</span><span class="p">:</span> <span class="s">&quot;Continuing</span><span class="nv"> </span><span class="s">onto</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">next</span><span class="nv"> </span><span class="s">set</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">tasks...&quot;</span>
</pre></div>
</div>
<p>[53]</p>
</div>
<div class="section" id="check-mode">
<h4><a class="toc-backref" href="#id33">Check Mode</a><a class="headerlink" href="#check-mode" title="Permalink to this headline">¶</a></h4>
<p>A Playbook can run in a test mode with <code class="docutils literal notranslate"><span class="pre">--check</span></code>. No changes will be
made. Optionally, the <code class="docutils literal notranslate"><span class="pre">--diff</span></code> argument can also be added to show
exactly what would be changed.</p>
<p>Syntax:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ ansible-playbook --check site.yml
</pre></div>
</div>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ ansible-playbook --check --diff site.yml
</pre></div>
</div>
<p>In Ansible 2.1, the <code class="docutils literal notranslate"><span class="pre">ansible_check_mode</span></code> variable was added to verify
if check mode is on or off. This can be used to forcefully run tasks
even if check mode is on.</p>
<p>Examples:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">command</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">echo &quot;Hello world&quot;</span>
  <span class="nt">when</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">not ansible_check_mode</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Continue if this fails when check_mode is enabled</span>
   <span class="l l-Scalar l-Scalar-Plain">stat</span><span class="p p-Indicator">:</span>
     <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/etc/neutron/neutron.conf</span>
  <span class=" -Error"> </span><span class="nt">register</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">neutron_conf</span>
   <span class="nt">ignore_errors</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">ansible_check_mode</span><span class="nv"> </span><span class="s">}}&quot;</span>
</pre></div>
</div>
<p>In Ansible 2.2, the <code class="docutils literal notranslate"><span class="pre">check_mode</span></code> module can be forced to run during a
check mode. [29]</p>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">check_mode</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">no</span>
</pre></div>
</div>
<p>Examples:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Updating the operating system</span>
  <span class="nt">yum</span><span class="p">:</span>
    <span class="nt">name</span><span class="p">:</span> <span class="s">&quot;*&quot;</span>
    <span class="nt">state</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">latest</span>
  <span class="nt">check_mode</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">no</span>

<span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Installing the EPEL repository</span>
  <span class="nt">yum</span><span class="p">:</span>
    <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">epel-release</span>
    <span class="nt">state</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">latest</span>
  <span class="nt">check_mode</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">no</span>
</pre></div>
</div>
</div>
<div class="section" id="debug">
<h4><a class="toc-backref" href="#id34">Debug</a><a class="headerlink" href="#debug" title="Permalink to this headline">¶</a></h4>
<p>The debug module is used for helping facilitate troubleshooting. It prints out specified information to standard output.</p>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">debug</span><span class="p">:</span>
</pre></div>
</div>
<p>Common options:</p>
<ul class="simple">
<li><p>msg = Display a message. Default: <code class="docutils literal notranslate"><span class="pre">Hello</span> <span class="pre">world!</span></code>.</p></li>
<li><p>var = Display a variable.</p></li>
<li><p>verbosity = Only display the debug output when a certain verbosity level is set for Ansible. Default: <code class="docutils literal notranslate"><span class="pre">0</span></code>. [45]</p></li>
</ul>
<p>Example:</p>
<ul class="simple">
<li><p>Print Ansible’s hostname of the current server that the script is being run on.</p></li>
</ul>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">debug</span><span class="p">:</span>
  <span class="nt">msg</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">The inventory host name is {{ inventory_hostname }}</span>
  <span class="nt">verbosity</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
</pre></div>
</div>
</div>
<div class="section" id="gather-facts">
<h4><a class="toc-backref" href="#id35">Gather Facts</a><a class="headerlink" href="#gather-facts" title="Permalink to this headline">¶</a></h4>
<p>By default, Ansible will connect to all hosts related to a Playbook and
cache information about them. This includes hostnames, IP addresses, the
operating system version, etc.</p>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">gather_facts</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;BOOLEAN&gt;</span>
</pre></div>
</div>
<p>If these variables are not required then gather_facts and be set to
“False” to speed up a Playbook’s run time. [23]</p>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">gather_facts</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">False</span>
</pre></div>
</div>
<p>In other situations, information about other hosts may be required that
are not being used in the Playbook. Facts can be gather about them
before the roles in a Playbook are executed.</p>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="p p-Indicator">-</span> <span class="nt">hosts</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">squidproxy1,squidproxy2,squidproxy3</span>
  <span class="nt">gather_facts</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>

<span class="p p-Indicator">-</span> <span class="nt">hosts</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">monitor1,monitor2</span>
  <span class="nt">roles</span><span class="p">:</span>
   <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">common</span>
   <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">haproxy</span>
</pre></div>
</div>
<p>Common facts:</p>
<ul class="simple">
<li><p>ansible_os_family = The main distribution that the operating system is forked from. A full list of the mappings can be found in the <code class="docutils literal notranslate"><span class="pre">OS_FAMILY_MAP</span></code> variable <a class="reference external" href="https://github.com/ansible/ansible/blob/stable-2.6/lib/ansible/module_utils/facts/system/distribution.py#L413">here</a>.</p>
<ul>
<li><p>Archlinux = Archlinux, Antergos, Manjaro</p></li>
<li><p>Darwin = macOS</p></li>
<li><p>Debian = Debian, Ubuntu, Linux Mint, etc.</p></li>
<li><p>RedHat = RHEL, CentOS, Fedora, etc.</p></li>
<li><p>Windows = Windows, Windows Server, etc.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="handlers-and-notify">
<h4><a class="toc-backref" href="#id36">Handlers and Notify</a><a class="headerlink" href="#handlers-and-notify" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">notify</span></code> function will run a handler which is typically defined in the <code class="docutils literal notranslate"><span class="pre">handlers/main.yml</span></code> file within a role. It will only run if the the state of the module it’s tied to changes. By default the handler will listen on a “name” if it is specified. Otherwise, a explicit “listen” directive can be given to multiple handlers. This will allow them all to be executed at once (in the order that they were defined). Handlers cannot have the same name, only the same listen name. This is useful for checking if a configuration file changed and, if it did, then restart the service.</p>
<p>Handlers only execute when a Playbook successfully completes. For executing handlers sooner, refer to the “meta” main module’s documentation.</p>
<p>Syntax #1 (Playbook handler):</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">handlers</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;TASK_DESCRIPTION&gt;</span>
    <span class="nt">&lt;MODULE&gt;</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;ARGS&gt;</span>
    <span class="nt">listen</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;LISTEN_HANDLER_NAME&gt;</span>
</pre></div>
</div>
<p>Syntax #2 (Role handler file = handlers/main.yml):</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;TASK_DESCRIPTION&gt;</span>
  <span class="nt">&lt;MODULE&gt;</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;ARGS&gt;</span>
  <span class="nt">listen</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;LISTEN_HANDLER_NAME&gt;</span>
</pre></div>
</div>
<p>Syntax (Tasks):</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">&lt;MODULE&gt;</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;ARGS&gt;</span>
  <span class="nt">notify</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">&lt;HANDLER_NAME&gt;</span>
</pre></div>
</div>
<p>Example #1 (Playbook handler):</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">handlers</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">restart nginx</span>
    <span class="nt">service</span><span class="p">:</span>
      <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">nginx</span>
      <span class="nt">state</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">restarted</span>
    <span class="nt">listen</span><span class="p">:</span> <span class="s">&quot;restart</span><span class="nv"> </span><span class="s">stack&quot;</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">restart php-fpm</span>
    <span class="nt">service</span><span class="p">:</span>
      <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">php-fpm</span>
      <span class="nt">state</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">restarted</span>
    <span class="nt">listen</span><span class="p">:</span> <span class="s">&quot;restart</span><span class="nv"> </span><span class="s">stack&quot;</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">restart mariadb</span>
    <span class="nt">service</span><span class="p">:</span>
      <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mariadb</span>
      <span class="nt">state</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">restarted</span>
    <span class="nt">listen</span><span class="p">:</span> <span class="s">&quot;restart</span><span class="nv"> </span><span class="s">stack&quot;</span>
</pre></div>
</div>
<p>Example #2 (Role handler file):</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">restart nginx</span>
  <span class="nt">service</span><span class="p">:</span>
    <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">nginx</span>
    <span class="nt">state</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">restarted</span>
  <span class="nt">listen</span><span class="p">:</span> <span class="s">&quot;restart</span><span class="nv"> </span><span class="s">stack&quot;</span>
<span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">restart php-fpm</span>
  <span class="nt">service</span><span class="p">:</span>
    <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">php-fpm</span>
    <span class="nt">state</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">restarted</span>
  <span class="nt">listen</span><span class="p">:</span> <span class="s">&quot;restart</span><span class="nv"> </span><span class="s">stack&quot;</span>
<span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">restart mariadb</span>
  <span class="nt">service</span><span class="p">:</span>
    <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mariadb</span>
    <span class="nt">state</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">restarted</span>
  <span class="nt">listen</span><span class="p">:</span> <span class="s">&quot;restart</span><span class="nv"> </span><span class="s">stack&quot;</span>
</pre></div>
</div>
<p>Example (Tasks):</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">template</span><span class="p">:</span>
    <span class="nt">src</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">nginx.conf.j2</span>
    <span class="nt">dest</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/etc/nginx/nginx.conf</span>
  <span class="nt">notify</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">restart stack</span>
</pre></div>
</div>
<p>[2]</p>
</div>
<div class="section" id="meta">
<h4><a class="toc-backref" href="#id37">Meta</a><a class="headerlink" href="#meta" title="Permalink to this headline">¶</a></h4>
<p>The meta module handles some aspects of the Ansible Playbooks execution.</p>
<p>All options (free form):</p>
<ul class="simple">
<li><p>clear_facts = Removes all of the gathered facts about the Playbook
hosts.</p></li>
<li><p>clear_host_errors = Removes hosts from being in a failed state to
continue running the Playbook.</p></li>
<li><p>end_play = End the Playbook instantly and mark it as successfully
unless there were any failures.</p></li>
<li><p>flush_handlers = Any handlers that have been notified will be run.</p></li>
<li><p>noop = Do no operations. This is mainly for Ansible developers and
debugging purposes.</p></li>
<li><p>refresh_inventory = Reload the inventory files. This is useful when
using dynamic inventory scripts.</p></li>
<li><p>reset_connection = Closes the current connections to the hosts and
start a new connection.</p></li>
</ul>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">meta</span><span class="p">:</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">meta</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">flush_handlers</span>
</pre></div>
</div>
<p>[45]</p>
</div>
<div class="section" id="no-log">
<h4><a class="toc-backref" href="#id38">No Log</a><a class="headerlink" href="#no-log" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">no_log</span></code> module can be used to disable logging for a single task or an entire Playbook. This is helpful for not logging sensitive information that may be exposed by one or more tasks. [64]</p>
<p>Task syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">&lt;OTHER_MODULE&gt;</span><span class="p">:</span>
  <span class="nt">no_log</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
</pre></div>
</div>
<p>Playbook syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">hosts</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;HOSTS&gt;</span>
  <span class="nt">nog_log</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Authenticating against the API</span>
  <span class="nt">uri</span><span class="p">:</span>
    <span class="nt">method</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">POST</span>
    <span class="nt">url</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">http://example.org/v1/auth</span>
    <span class="nt">body</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">auth_body</span><span class="nv"> </span><span class="s">}}&quot;</span>
  <span class="nt">register</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">auth_response</span>
  <span class="nt">no_log</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>

<span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Running a task with the API</span>
  <span class="nt">uri</span><span class="p">:</span>
    <span class="nt">method</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">POST</span>
    <span class="nt">url</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">http://example.org/v1/ip/create</span>
    <span class="nt">headers</span><span class="p">:</span>
      <span class="nt">Token</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">auth_response.ansible_facts.token</span><span class="nv"> </span><span class="s">}}&quot;</span>
    <span class="nt">body</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">ip_create_body</span><span class="nv"> </span><span class="s">}}&quot;</span>
  <span class="nt">no_log</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
</pre></div>
</div>
</div>
<div class="section" id="pause">
<h4><a class="toc-backref" href="#id39">Pause</a><a class="headerlink" href="#pause" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">pause</span></code> module is used to temporarily pause an entire Playbook. If
no time argument is specified, the end-user will need to hit <code class="docutils literal notranslate"><span class="pre">CTRL+c</span></code>
then <code class="docutils literal notranslate"><span class="pre">c</span></code> to continue or hit <code class="docutils literal notranslate"><span class="pre">CTRL+c</span></code> and then <code class="docutils literal notranslate"><span class="pre">a</span></code> to abort the
Playbook.</p>
<p>All options:</p>
<ul class="simple">
<li><p>minutes</p></li>
<li><p>prompt = An optional text to display to the end-user.</p></li>
<li><p>seconds</p></li>
</ul>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">pause</span><span class="p">:</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">pause</span><span class="p">:</span>
    <span class="nt">minutes</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">3</span>
    <span class="nt">prompt</span><span class="p">:</span> <span class="s">&quot;The</span><span class="nv"> </span><span class="s">new</span><span class="nv"> </span><span class="s">program</span><span class="nv"> </span><span class="s">needs</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">finish</span><span class="nv"> </span><span class="s">initializing.&quot;</span>
</pre></div>
</div>
<p>[45]</p>
</div>
<div class="section" id="roles">
<h4><a class="toc-backref" href="#id40">Roles</a><a class="headerlink" href="#roles" title="Permalink to this headline">¶</a></h4>
<p>A Playbook consists of roles. Each role that needs to be run needs to be
specified in a list. Additional roles can be added within a role
dynamically or statically using “include_role” or “import_role.” [49]</p>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">roles</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">&lt;ROLE1&gt;</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">&lt;ROLE2&gt;</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">roles</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">common</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">httpd</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">sql</span>
</pre></div>
</div>
</div>
<div class="section" id="run-once">
<h4><a class="toc-backref" href="#id41">Run Once</a><a class="headerlink" href="#run-once" title="Permalink to this headline">¶</a></h4>
<p>In some situations a command should only need to be run on one node. An
example is when using a MariaDB Galera cluster where database changes
will get synced to all nodes.</p>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">run_once</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
</pre></div>
</div>
<p>This can also be assigned to a specific host.</p>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">run_once</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
<span class="nt">delegate_to</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;HOST&gt;</span>
</pre></div>
</div>
<p>[14]</p>
</div>
<div class="section" id="serial">
<h4><a class="toc-backref" href="#id42">Serial</a><a class="headerlink" href="#serial" title="Permalink to this headline">¶</a></h4>
<p>By default, Ansible will run all tasks in parallels on all hosts. By setting a number or percentage of hosts, a user can restrict how many hosts must fully complete in a playbook before moving onto the next set of hosts. [14] The <code class="docutils literal notranslate"><span class="pre">serial</span></code> keyword can only be used at the playbook level. [83]</p>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">serial</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;NUMBER_OR_PERCENTAGE&gt;</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">hosts</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">web</span>
  <span class="nt">serial</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">50%</span>
  <span class="nt">tasks</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Installing Nginx</span>
      <span class="nt">package</span><span class="p">:</span>
        <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">nginx</span>
        <span class="nt">state</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">present</span>
</pre></div>
</div>
</div>
<div class="section" id="strategy">
<h4><a class="toc-backref" href="#id43">Strategy</a><a class="headerlink" href="#strategy" title="Permalink to this headline">¶</a></h4>
<p>By default, a Playbook strategy is set to “linear” meaning that it will
only move onto the next task once it completes on all hosts. This can be
changed to “free” so that once a task completes on a host, that host
will instantly move onto the next available task.</p>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">strategy</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">free</span>
</pre></div>
</div>
<p>Example (site.yml):</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">hosts</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">all</span>
  <span class="nt">strategy</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">free</span>
  <span class="nt">roles</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">gitlab</span>
</pre></div>
</div>
<p>[36]</p>
</div>
<div class="section" id="tags">
<h4><a class="toc-backref" href="#id44">Tags</a><a class="headerlink" href="#tags" title="Permalink to this headline">¶</a></h4>
<p>Each task in a tasks file can have a tag associated to it. This should
be appended to the end of the task. This is useful for debugging and
separating tasks into specific groups. Here is the syntax:</p>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">tags</span><span class="p">:</span>
 <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">&lt;TAG1&gt;</span>
 <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">&lt;TAG2&gt;</span>
 <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">&lt;TAG3&gt;</span>
</pre></div>
</div>
<p>Run only tasks that include specific tags.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ ansible-playbook --tags <span class="s2">&quot;&lt;TAG1&gt;,&lt;TAG2&gt;,&lt;TAG3&gt;&quot;</span>
</pre></div>
</div>
<p>Alternatively, skip specific tags.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ ansible-playbook --skip-tags <span class="s2">&quot;&lt;TAG1&gt;,&lt;TAG2&gt;,&lt;TAG3&gt;&quot;</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="c1"># File: webserver.yaml</span>
 <span class="p p-Indicator">-</span> <span class="nt">package</span><span class="p">:</span>
     <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">nginx</span>
     <span class="nt">state</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">latest</span>
   <span class="nt">tags</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">yum</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">rpm</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">nginx</span>
</pre></div>
</div>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ ansible-playbook --tags <span class="s2">&quot;yum&quot;</span> site.yml webnode1
</pre></div>
</div>
<p>[8]</p>
</div>
<div class="section" id="id1">
<h4><a class="toc-backref" href="#id45">Tasks</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<p>Playbooks can include specific task files or define and run tasks in the
Playbook file itself. In Ansible 2.0, loops, variables, and other
dynamic elements now work correctly.</p>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">hosts</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;HOSTS&gt;</span>
  <span class="nt">tasks</span><span class="p">:</span>
   <span class="p p-Indicator">-</span> <span class="nt">&lt;MODULE&gt;</span><span class="p">:</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">hosts</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">jenkins</span>
  <span class="nt">tasks</span><span class="p">:</span>
   <span class="p p-Indicator">-</span> <span class="nt">debug</span><span class="p">:</span>
       <span class="nt">msg</span><span class="p">:</span> <span class="s">&quot;Warning:</span><span class="nv"> </span><span class="s">This</span><span class="nv"> </span><span class="s">will</span><span class="nv"> </span><span class="s">modify</span><span class="nv"> </span><span class="s">ALL</span><span class="nv"> </span><span class="s">Jenkins</span><span class="nv"> </span><span class="s">servers.&quot;</span>
  <span class="nt">roles</span><span class="p">:</span>
   <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">common</span>
   <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">docker</span>
</pre></div>
</div>
<p>[45]</p>
</div>
<div class="section" id="wait-for">
<h4><a class="toc-backref" href="#id46">Wait For</a><a class="headerlink" href="#wait-for" title="Permalink to this headline">¶</a></h4>
<p>A condition can be searched for before continuing on to the next task.</p>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">wait_for</span><span class="p">:</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">wait_for</span><span class="p">:</span>
  <span class="nt">timeout</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">60</span>
<span class="nt">delegate_to</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">localhost</span>
</pre></div>
</div>
<p>Common options:</p>
<ul class="simple">
<li><p>delay = How long to wait (in seconds) before running the wait_for
check.</p></li>
<li><p>path = A file to check.</p></li>
<li><p>host = A host to check a connection to.</p></li>
<li><p>port = A port to check on the specified host.</p></li>
<li><p>connect_timeout = How long to wait (in seconds) before retrying the
connection.</p></li>
<li><p>search_regex = A regular expression string to match from either a
port or file.</p></li>
<li><p>state</p>
<ul>
<li><p>started = Check for a open port.</p></li>
<li><p>stopped = Check for a closed port.</p></li>
<li><p>drained = Check for active connections to the port.</p></li>
<li><p>present = Check for a file.</p></li>
<li><p>absent = Verify a file does not exist.</p></li>
</ul>
</li>
<li><p>timeout = How long to wait (in seconds) before continuing on.</p></li>
</ul>
<p>[45]</p>
</div>
<div class="section" id="when">
<h4><a class="toc-backref" href="#id47">When</a><a class="headerlink" href="#when" title="Permalink to this headline">¶</a></h4>
<p>The “when” function can be used to specify that a sub-task should only
run if the condition returns turn. This is similar to an “if” statement
in programming languages. It is usually the last line to a sub-task. [11]</p>
<p>“When” Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">package</span><span class="p">:</span>
    <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">httpd</span>
    <span class="nt">state</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">latest</span>
  <span class="nt">when</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ansible_os_family == &quot;CentOS&quot;</span>
</pre></div>
</div>
<p>“Or” example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">when</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">(ansible_os_family == &quot;CentOS&quot;) or (ansible_os_family == &quot;Debian&quot;)</span>
</pre></div>
</div>
<p>“And” example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">when</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">(ansible_os_family == &quot;Fedora&quot;) and</span>
      <span class="l l-Scalar l-Scalar-Plain">(ansible_distribution_major_version == &quot;26&quot;)</span>
</pre></div>
</div>
</div>
<div class="section" id="errors">
<h4><a class="toc-backref" href="#id48">Errors</a><a class="headerlink" href="#errors" title="Permalink to this headline">¶</a></h4>
<p>These modules handle Playbook errors.</p>
<div class="section" id="any-errors-fatal">
<h5><a class="toc-backref" href="#id49">Any Errors Fatal</a><a class="headerlink" href="#any-errors-fatal" title="Permalink to this headline">¶</a></h5>
<p>By default, a Playbook will continue to run on all of the hosts that do
not have any failures reported by modules. It is possible to stop the
Playbook from running on all hosts once an error has occurred. [12]</p>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">any_errors_fatal</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">hosts</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">nfs_servers</span>
  <span class="nt">any_errors_fatal</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
  <span class="nt">roles</span><span class="p">:</span>
   <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">nfs</span>
</pre></div>
</div>
</div>
<div class="section" id="fail">
<h5><a class="toc-backref" href="#id50">Fail</a><a class="headerlink" href="#fail" title="Permalink to this headline">¶</a></h5>
<p>The simple <code class="docutils literal notranslate"><span class="pre">fail</span></code> module will make a Playbook fail. This is useful
when checking if a certain condition has to exist to continue on.</p>
<p>All options:</p>
<ul class="simple">
<li><p>msg = An optional message to provide the end-user.</p></li>
</ul>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">fail</span><span class="p">:</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">fail</span><span class="p">:</span>
    <span class="nt">msg</span><span class="p">:</span> <span class="s">&quot;Unexpected</span><span class="nv"> </span><span class="s">return</span><span class="nv"> </span><span class="s">code.&quot;</span>
  <span class="nt">when</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">(command_variable.rc != 0) or (command_variable.rc != 900)</span>
</pre></div>
</div>
<p>[45]</p>
</div>
<div class="section" id="failed-when">
<h5><a class="toc-backref" href="#id51">Failed When</a><a class="headerlink" href="#failed-when" title="Permalink to this headline">¶</a></h5>
<p>In some situations, a error from a command or module may not be reported
properly. This module can be used to force a failure based on a certain
condition. [12]</p>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">failed_when</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;CONDITION&gt;</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">command</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">echo &quot;Testing a failure. 123.&quot;</span>
  <span class="nt">register</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cmd</span>
  <span class="nt">failed_when</span><span class="p">:</span> <span class="s">&quot;&#39;123&#39;</span><span class="nv"> </span><span class="s">in</span><span class="nv"> </span><span class="s">cmd.stdout&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="ignore-errors">
<h5><a class="toc-backref" href="#id52">Ignore Errors</a><a class="headerlink" href="#ignore-errors" title="Permalink to this headline">¶</a></h5>
<p>Playbooks, by default, will stop running on a host if it fails to run a
module. Sometimes a module will report a false-positive or an error will
be expected. This will allow the Playbook to continue onto the next
step. [12]</p>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">ignore_errors</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">yes</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>- name: Even though this will fail, the Playbook will keep running.
  package:
    name: does-not-exist
    state: present
  ignore_errors: yes
</pre></div>
</div>
</div>
</div>
<div class="section" id="includes">
<h4><a class="toc-backref" href="#id53">Includes</a><a class="headerlink" href="#includes" title="Permalink to this headline">¶</a></h4>
<p>Include and import modules allow other elements of a Playbook to be
called and executed.</p>
<div class="section" id="import-playbook">
<h5><a class="toc-backref" href="#id54">Import Playbook</a><a class="headerlink" href="#import-playbook" title="Permalink to this headline">¶</a></h5>
<p>The proper way to use other Playbooks in a Playbook is to use the
<code class="docutils literal notranslate"><span class="pre">import_playbook</span></code>. Before Ansible 2.4 this was handled via the
<code class="docutils literal notranslate"><span class="pre">include</span></code> module. There is also no <code class="docutils literal notranslate"><span class="pre">include_playbook</span></code> module, only
<code class="docutils literal notranslate"><span class="pre">import_playbook</span></code>.</p>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="p p-Indicator">-</span> <span class="nt">import_playbook</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;PLAYBOOK&gt;</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="p p-Indicator">-</span> <span class="nt">import_playbook</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">nginx.yml</span>
<span class="p p-Indicator">-</span> <span class="nt">import_playbook</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">phpfpm.yml</span>
<span class="p p-Indicator">-</span> <span class="nt">import_playbook</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mariadb.yml</span>
</pre></div>
</div>
<p>[49][58]</p>
</div>
<div class="section" id="import-and-include-role">
<h5><a class="toc-backref" href="#id55">Import and Include Role</a><a class="headerlink" href="#import-and-include-role" title="Permalink to this headline">¶</a></h5>
<p>The <code class="docutils literal notranslate"><span class="pre">import_role</span></code> is a static inclusion of a role that cannot be used
in loops. This is loaded on runtime of the Playbook</p>
<p>The <code class="docutils literal notranslate"><span class="pre">include_role</span></code> is a dynamic inclusion of a role that can be used
in loops. Tags will not automatically be shown with the <code class="docutils literal notranslate"><span class="pre">--list-tags</span></code>
Ansible Playbook argument. This can be loaded dynamically based on
conditions. [49][58]</p>
<p>All options:</p>
<ul class="simple">
<li><p>allow_duplicates = Allow a role to be used more than once. Default:
True.</p></li>
<li><p>defaults_from = A default variable file to load from the role’s
“default” directory.</p></li>
<li><p><strong>name</strong> = The name of the role to import.</p></li>
<li><p>private = All of the “default” an “vars” variables in the role are
private and not accessible via the rest of the Playbook.</p></li>
<li><p>tasks_from = A task file to load from the role’s “tasks” directory.</p></li>
<li><p>vars_from = A variables file to load from the role’s “vars”
directory.</p></li>
</ul>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">import_role</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;ROLE_NAME&gt;</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">include_role</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;ROLE_NAME&gt;</span>
</pre></div>
</div>
<p>Examples:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Run only the install.yml task from the openshift role</span>
  <span class="nt">import_role</span><span class="p">:</span>
    <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">openshift</span>
    <span class="nt">tasks_from</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">install</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Run the Nagios role</span>
  <span class="nt">include_role</span><span class="p">:</span>
    <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">nagios</span>
  <span class="nt">vars</span><span class="p">:</span>
    <span class="nt">listen_port</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">8080</span>
</pre></div>
</div>
<p>[45]</p>
<p>In Ansible 2.7, the <code class="docutils literal notranslate"><span class="pre">apply</span></code> argument was added to both the <code class="docutils literal notranslate"><span class="pre">include_role</span></code> and <code class="docutils literal notranslate"><span class="pre">include_tasks</span></code> modules. This allows the end-user to apply the same type of keyword attributes that a  normal <code class="docutils literal notranslate"><span class="pre">role</span></code> can accept. These include become arguments, delegation, ignore_errors, tags, and more. The full list of allowed keywords for roles can be found <a class="reference external" href="https://docs.ansible.com/ansible/latest/reference_appendices/playbooks_keywords.html#role">here</a>.</p>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Install Nova</span>
  <span class="nt">include_role</span><span class="p">:</span>
    <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">nova</span>
    <span class="nt">apply</span><span class="p">:</span>
      <span class="nt">delegate_to</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">compute_nodes</span><span class="nv"> </span><span class="s">}}&quot;</span>
      <span class="nt">tags</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">compute</span>
</pre></div>
</div>
<p>[79]</p>
</div>
<div class="section" id="import-and-include-tasks">
<h5><a class="toc-backref" href="#id56">Import and Include Tasks</a><a class="headerlink" href="#import-and-include-tasks" title="Permalink to this headline">¶</a></h5>
<p>Use the <code class="docutils literal notranslate"><span class="pre">import_tasks</span></code> to statically include tasks at a Playbook’s
runtime or <code class="docutils literal notranslate"><span class="pre">include_tasks</span></code> to dynamically run tasks once the Playbook
gets to it.</p>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">import_tasks</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;TASK_FILE&gt;.yml</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">include_tasks</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;TASK_FILE&gt;.yml</span>
  <span class="nt">vars</span><span class="p">:</span>
    <span class="nt">&lt;KEY1&gt;</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;VALUE1&gt;</span>
    <span class="nt">&lt;KEY2&gt;</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;VALUE2&gt;</span>
    <span class="nt">&lt;KEY3&gt;</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;VALUE3&gt;</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">include_tasks</span><span class="p">:</span>
    <span class="nt">file</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;TASK_FILE&gt;.yml</span>
    <span class="nt">vars</span><span class="p">:</span>
      <span class="nt">&lt;KEY1&gt;</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;VALUE1&gt;</span>
      <span class="nt">&lt;KEY2&gt;</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;VALUE2&gt;</span>
      <span class="nt">&lt;KEY3&gt;</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;VALUE3&gt;</span>
    <span class="nt">apply</span><span class="p">:</span>
      <span class="l l-Scalar l-Scalar-Plain">&lt;APPLY_OTHER_ATTRIBUTES&gt;</span>
</pre></div>
</div>
<p>[49]</p>
</div>
<div class="section" id="include">
<h5><a class="toc-backref" href="#id57">Include</a><a class="headerlink" href="#include" title="Permalink to this headline">¶</a></h5>
<p><strong>Deprecated in: 2.4 Replaced by: include_tasks, import_plays,
import_tasks</strong></p>
<p>Other task files and Playbooks can be included. The functions in them
will immediately run. Variables can be defined for the inclusion as
well. [49]</p>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">include</span><span class="p">:</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">include</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;TASK&gt;.yml &lt;VAR1&gt;=&lt;VALUE1&gt; &lt;VAR2&gt;=&lt;VALUE2&gt;</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">include</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">wine.yml wine_version=1.8.0 compression_format=xz download_util=wget</span>
</pre></div>
</div>
<p>[45]</p>
</div>
<div class="section" id="include-variables">
<h5><a class="toc-backref" href="#id58">Include Variables</a><a class="headerlink" href="#include-variables" title="Permalink to this headline">¶</a></h5>
<p>Additional variables can be defined within a Playbook file. These can be
openly added to the <code class="docutils literal notranslate"><span class="pre">include_vars</span></code> module via YAML syntax.</p>
<p>Common options:</p>
<ul class="simple">
<li><p>file = Specify a filename to source variables from.</p></li>
<li><p>name = Store variables from a file into a specified variable.</p></li>
</ul>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">include_vars</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;VARIABLE&gt;</span>
</pre></div>
</div>
<p>Examples:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">hosts</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">all</span>
  <span class="nt">include_vars</span><span class="p">:</span>
   <span class="p p-Indicator">-</span> <span class="nt">gateway</span><span class="p">:</span> <span class="s">&quot;192.168.0.1&quot;</span>
   <span class="p p-Indicator">-</span> <span class="nt">netmask</span><span class="p">:</span> <span class="s">&quot;255.255.255.0&quot;</span>
  <span class="nt">roles</span><span class="p">:</span>
   <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">addressing</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">hosts</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">all</span>
  <span class="nt">include_vars</span><span class="p">:</span>
    <span class="nt">file</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">monitor_vars.yml</span>
  <span class="nt">roles</span><span class="p">:</span>
   <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">nagios</span>
</pre></div>
</div>
<p>[45]</p>
</div>
</div>
<div class="section" id="loops">
<h4><a class="toc-backref" href="#id59">Loops</a><a class="headerlink" href="#loops" title="Permalink to this headline">¶</a></h4>
<p>Loops can be used to iterate through lists and/or dictionaries. All <code class="docutils literal notranslate"><span class="pre">with_</span></code> loops from Ansible &lt;= 2.4 have been replaced by the <code class="docutils literal notranslate"><span class="pre">loop</span></code> keyword in Ansible 2.5. The older loops are currently planned to be removed in the Ansible 2.9 release. Jinja filters are now required to explicitly be defined for creating a customized list of data to loop through. Use <a class="reference external" href="https://docs.ansible.com/ansible/2.7/user_guide/playbooks_loops.html#migrating-from-with-x-to-loop">this migration guide</a> for examples on how to use the logic of old <code class="docutils literal notranslate"><span class="pre">with_</span></code> loops using the new syntax. Package modules in Ansible &gt;= 2.7 support passing a list variable as an argument value.</p>
<p>Ansible &gt;= 2.5 loops:</p>
<ul class="simple">
<li><p><a class="reference external" href="http://docs.ansible.com/ansible/latest/user_guide/playbooks_loops.html#standard-loops">Loop</a></p></li>
<li><p><a class="reference external" href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_loops.html#do-until-loops">Until</a></p></li>
</ul>
<div class="section" id="loop">
<h5><a class="toc-backref" href="#id60">Loop</a><a class="headerlink" href="#loop" title="Permalink to this headline">¶</a></h5>
<p>Ansible 2.5 introduced a simpler keyword for loops called <code class="docutils literal notranslate"><span class="pre">loop</span></code> instead of the more complex name <code class="docutils literal notranslate"><span class="pre">with_items</span></code>. This new loop directly replaces <code class="docutils literal notranslate"><span class="pre">with_list</span></code> and is used in substitution of all of the older <code class="docutils literal notranslate"><span class="pre">with_</span></code> prefixed loops. This change was to put emphasis on the end-user to do the parsing of variables with Jinja filters and lookups such as how Ansible &lt;= 2.4 handles it in the back-end. This helps to make the code more understandable.</p>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">loop</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">LIST_VARIABLE</span><span class="nv"> </span><span class="s">}}&quot;</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">loop</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">&lt;VARIABLE1&gt;</span><span class="nv"> </span><span class="s">}}&quot;</span>
  <span class="p p-Indicator">-</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">&lt;VARIABLE2&gt;</span><span class="nv"> </span><span class="s">}}&quot;</span>
</pre></div>
</div>
<p>View the available Ansible Jinja lookups [62]:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ ansible-doc -t lookup -l
$ ansible-doc -t lookup &lt;JINJA_LOOKUP&gt;
</pre></div>
</div>
<p>Ansible provides a special Jinja <code class="docutils literal notranslate"><span class="pre">lookup</span></code> wrapper called <code class="docutils literal notranslate"><span class="pre">query</span></code> that will return lists instead of a comma separated string.</p>
<p>Query syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{{</span> <span class="n">query</span><span class="p">(</span><span class="s1">&#39;&lt;LOOKUP&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;VARIABLE1&gt;&#39;</span><span class="p">)</span> <span class="p">}}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{{</span> <span class="n">query</span><span class="p">(</span><span class="s1">&#39;&lt;LOOKUP&gt;&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;&lt;VARIABLE1&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;VARIABLE2&gt;&#39;</span><span class="p">])</span> <span class="p">}}</span>
</pre></div>
</div>
</div>
<div class="section" id="loop-control">
<h5><a class="toc-backref" href="#id61">Loop Control</a><a class="headerlink" href="#loop-control" title="Permalink to this headline">¶</a></h5>
<p>Loops can be configured to behave differently for more control over how it is used.</p>
<p>Options:</p>
<ul class="simple">
<li><p>index_var = The variable name for the current index that the loop is iterating on.</p></li>
<li><p>label = Only use a specific key from a dictionary when the entire dictionary is not required to be processed.</p></li>
<li><p>loop_var = The variable name for the current item in the loop. This is useful for nested loops. Default: <code class="docutils literal notranslate"><span class="pre">item</span></code>.</p></li>
<li><p>pause = The number of seconds to pause before moving onto the next item.</p></li>
</ul>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Debug the API messages and loop index</span>
  <span class="nt">debug</span><span class="p">:</span>
    <span class="nt">msg</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">current.message</span><span class="nv"> </span><span class="s">}}.</span><span class="nv"> </span><span class="s">Current</span><span class="nv"> </span><span class="s">index:</span><span class="nv"> </span><span class="s">{{</span><span class="nv"> </span><span class="s">index</span><span class="nv"> </span><span class="s">}}&quot;</span>
    <span class="nt">verbosity</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
  <span class="nt">loop</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">message</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Hello world</span>
      <span class="nt">settings</span><span class="p">:</span>
        <span class="nt">api</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">v3</span>
        <span class="nt">url</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://example.tld/</span>
    <span class="p p-Indicator">-</span> <span class="nt">message</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Goodbye world</span>
      <span class="nt">settings</span><span class="p">:</span>
        <span class="nt">api</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">v2.1</span>
        <span class="nt">url</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://example.tld/</span>
  <span class="nt">loop_control</span><span class="p">:</span>
    <span class="nt">index_var</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">index</span>
    <span class="nt">label</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">current.message</span><span class="nv"> </span><span class="s">}}&quot;</span>
    <span class="nt">loop_var</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">current</span>
    <span class="nt">pause</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">5</span>
</pre></div>
</div>
<p>[10]</p>
</div>
<div class="section" id="until-loops">
<h5><a class="toc-backref" href="#id62">Until Loops</a><a class="headerlink" href="#until-loops" title="Permalink to this headline">¶</a></h5>
<p>Do-Until loops can be used to continually run a check and verify it’s completion.</p>
<ul class="simple">
<li><p><strong>until</strong> = The logic of the <code class="docutils literal notranslate"><span class="pre">until</span></code> loop. The typical use case is to check the output of a registered variable or do a Jinja lookup. When the condition is not met, the module runs again. When the condition is met, the module finishes and moves onto the next task.</p></li>
<li><p>retries = The number of times to retry the loop until marking the task as failed. Default: 3.</p></li>
<li><p>delay = The delay, in seconds, before starting the next retry. Default: 5.</p></li>
</ul>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Generate random numbers until 5 is found</span>
  <span class="nt">shell</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">echo $(($RANDOM % 10 + 1))</span>
  <span class="nt">register</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">random_number</span>
  <span class="nt">until</span><span class="p">:</span> <span class="s">&#39;&quot;5&quot;</span><span class="nv"> </span><span class="s">in</span><span class="nv"> </span><span class="s">random_number.stdout&#39;</span>
  <span class="nt">retries</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">30</span>
  <span class="nt">delay</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
</pre></div>
</div>
<p>The registered variable will have a special “attempts” key that will contain the number of retries that the <code class="docutils literal notranslate"><span class="pre">until</span></code> loop went through.</p>
<p>[10]</p>
</div>
</div>
<div class="section" id="id2">
<h4><a class="toc-backref" href="#id63">Variables</a><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<p>These are modules relating to defining new variables.</p>
<div class="section" id="vars-prompt">
<h5><a class="toc-backref" href="#id64">Vars Prompt</a><a class="headerlink" href="#vars-prompt" title="Permalink to this headline">¶</a></h5>
<p>A prompt can be used to assign a user’s standard input as a variable. [9] Note
that this module is not compatible with Ansible Tower and that a Survey
should be created within Tower instead. [38]</p>
<p>Common options:</p>
<ul class="simple">
<li><p>confirm = Prompt the user twice and then verify that the input is the
same.</p></li>
<li><p>encrypt = Encrypt the text.</p>
<ul>
<li><p>md5_crypt</p></li>
<li><p>sha256_crypt</p></li>
<li><p>sha512_crypt</p></li>
</ul>
</li>
<li><p>salt = Specify a string to use as a salt for encrypting.</p></li>
<li><p>salt_size = Specify the length to use for a randomly generated salt.
The default is 8.</p></li>
</ul>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">vars_prompt</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="s">&quot;&lt;VARIABLE&gt;&quot;</span>
    <span class="nt">prompt</span><span class="p">:</span> <span class="s">&quot;&lt;PROMPT</span><span class="nv"> </span><span class="s">TEXT&gt;&quot;</span>
</pre></div>
</div>
<p>Examples:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">vars_prompt</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="s">&quot;zipcode&quot;</span>
    <span class="nt">prompt</span><span class="p">:</span> <span class="s">&quot;Enter</span><span class="nv"> </span><span class="s">your</span><span class="nv"> </span><span class="s">zipcode.&quot;</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">vars_prompt</span><span class="p">:</span>
   <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="s">&quot;pw&quot;</span>
     <span class="nt">prompt</span><span class="p">:</span> <span class="s">&quot;Password:&quot;</span>
     <span class="nt">encrypt</span><span class="p">:</span> <span class="s">&quot;sha512_crypt&quot;</span>
     <span class="nt">salt_size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">12</span>
</pre></div>
</div>
<p>[9]</p>
</div>
<div class="section" id="register">
<h5><a class="toc-backref" href="#id65">Register</a><a class="headerlink" href="#register" title="Permalink to this headline">¶</a></h5>
<p>The output of modules and commands can be saved to a variable.</p>
<p>Variable return values [30]:</p>
<ul class="simple">
<li><p>backup_file = String. If a module creates a backup file, this is
that file’s name.</p></li>
<li><p>changed = Boolean. If something was changed after the module runs,
this would be set to “True.”</p></li>
<li><p>failed = Boolean. Shows if the module failed.</p></li>
<li><p>invocation = Dictionary. This describes the module used to run the
operation as well as all of the arguments.</p></li>
<li><p>msg = String. A message that is optionally given to the end-user.</p></li>
<li><p>rc = Integer. The return code of a command, shell, or similar module.</p></li>
<li><p>stderr = String. The standard error of the command.</p></li>
<li><p>stderr_lines = List. The standard output of the command is separated
by the newline characters into a list.</p></li>
<li><p>stdout = String. The standard output of the command.</p></li>
<li><p>stdout_lines = List.</p></li>
<li><p>results = List of dictionaries. If a loop was used, the results for
each loop are stored as a new list item.</p></li>
<li><p>skipped = Boolean. If this module was skipped or not.</p></li>
</ul>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">register</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;NEW_VARIABLE&gt;</span>
</pre></div>
</div>
<p>Examples:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">command</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">echo Hello World</span>
  <span class="nt">register</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">hello</span>

<span class="p p-Indicator">-</span> <span class="nt">debug</span><span class="p">:</span>
    <span class="nt">msg</span><span class="p">:</span> <span class="s">&quot;We</span><span class="nv"> </span><span class="s">heard</span><span class="nv"> </span><span class="s">you&quot;</span>
  <span class="nt">when</span><span class="p">:</span> <span class="s">&quot;&#39;Hello</span><span class="nv"> </span><span class="s">World&#39;</span><span class="nv"> </span><span class="s">in</span><span class="nv"> </span><span class="s">hello.stdout&quot;</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">copy</span><span class="p">:</span>
    <span class="nt">src</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">example.conf</span>
    <span class="nt">dest</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/etc/example.conf</span>
  <span class="nt">register</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">copy_example</span>

<span class="p p-Indicator">-</span> <span class="nt">debug</span><span class="p">:</span>
    <span class="nt">msg</span><span class="p">:</span> <span class="s">&quot;Copying</span><span class="nv"> </span><span class="s">example.conf</span><span class="nv"> </span><span class="s">failed.&quot;</span>
  <span class="nt">when</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">copy_example|failed</span>
</pre></div>
</div>
<p>[12]</p>
</div>
<div class="section" id="set-fact">
<h5><a class="toc-backref" href="#id66">Set Fact</a><a class="headerlink" href="#set-fact" title="Permalink to this headline">¶</a></h5>
<p>New variables can be defined set the “set_fact” module. These are added
to the available variables/facts tied to a inventory host. [45]</p>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">set_fact</span><span class="p">:</span>
  <span class="nt">&lt;VARIABLE_NAME1&gt;</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;VARIABLE_VALUE1&gt;</span>
  <span class="nt">&lt;VARIABLE_NAME2&gt;</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;VARIABLE_VALUE2&gt;</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">set_fact</span><span class="p">:</span>
    <span class="nt">is_installed</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
    <span class="nt">sql_server</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mariadb</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="unix-modules">
<h3><a class="toc-backref" href="#id67">UNIX Modules</a><a class="headerlink" href="#unix-modules" title="Permalink to this headline">¶</a></h3>
<div class="section" id="authorized-key">
<h4><a class="toc-backref" href="#id68">Authorized Key</a><a class="headerlink" href="#authorized-key" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">authorized_key</span></code> module will add a public SSH key to the specified user’s <code class="docutils literal notranslate"><span class="pre">~/.ssh/authorized_keys</span></code> file. [55]</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Configure SSH key access</span>
  <span class="nt">authorized_key</span><span class="p">:</span>
    <span class="nt">user</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">foo</span>
    <span class="nt">key</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">ssh_public_key</span><span class="nv"> </span><span class="s">}}&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="command-and-shell">
<h4><a class="toc-backref" href="#id69">Command and Shell</a><a class="headerlink" href="#command-and-shell" title="Permalink to this headline">¶</a></h4>
<p>Both the command and shell modules provide the ability to run command
line programs. The big difference is that shell provides a full shell
environment where operand redirection and pipping works, along with
loading up all of the shell variables. Conversely, command will not load
a full shell environment so it will lack in features and functionality
but it makes up for that by being faster and more efficient. [6]</p>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">command</span><span class="p">:</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">shell</span><span class="p">:</span>
</pre></div>
</div>
<p>Common options:</p>
<ul class="simple">
<li><p>executable = Set the executable shell binary.</p></li>
<li><p>chdir = Change directories before running the command.</p></li>
</ul>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">shell</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">echo &quot;Hello world&quot; &gt;&gt; /tmp/hello_world.txt</span>
  <span class="nt">args</span><span class="p">:</span>
    <span class="nt">executable</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/bin/bash</span>
</pre></div>
</div>
</div>
<div class="section" id="copy-file-synchronize-and-template">
<h4><a class="toc-backref" href="#id70">Copy, File, Synchronize, and Template</a><a class="headerlink" href="#copy-file-synchronize-and-template" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">copy</span></code>, <code class="docutils literal notranslate"><span class="pre">file</span></code>, <code class="docutils literal notranslate"><span class="pre">synchronize</span></code>, and <code class="docutils literal notranslate"><span class="pre">template</span></code> modules provide ways for creating and modifying various files. The <code class="docutils literal notranslate"><span class="pre">file</span></code> module is used to handle file creation/modification on the remote host. <code class="docutils literal notranslate"><span class="pre">template</span></code>s are to be used when a file contains variables that will be rendered out by Jinja2. <code class="docutils literal notranslate"><span class="pre">copy</span></code> is used for copying files from the Ansible control node or on the managed host. <code class="docutils literal notranslate"><span class="pre">synchronize</span></code> is used as a wrapper around rsync to provide a more robust copy functionality. This module is the only module that can recursive copy a directory and all of it’s contents on a remote host to another folder on that same host. Most of the options and usage are the same between these four modules.</p>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">copy</span><span class="p">:</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">file</span><span class="p">:</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">synchronize</span><span class="p">:</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">template</span><span class="p">:</span>
</pre></div>
</div>
<p>Common options:</p>
<ul class="simple">
<li><p>src = Define the source file or template. If a full path is not
given, Ansible will check in the roles/<code class="docutils literal notranslate"><span class="pre">&lt;ROLENAME&gt;</span></code>/files/
directory for a file or roles/<code class="docutils literal notranslate"><span class="pre">&lt;ROLENAME&gt;</span></code>/templates/ for a
template. If the src path ends with a “/” then only the files within
that directory will be copied (not the directory itself).</p></li>
<li><p>dest (or path) = This is the full path to where the file should be
copied to on the destination server.</p></li>
<li><p>owner = Set the user owner.</p></li>
<li><p>group = Set the group owner.</p></li>
<li><p>setype = Set SELinux file permissions.</p></li>
</ul>
<p>Copy, file, and template options:</p>
<ul class="simple">
<li><p>mode = Set the octal or symbolic permissions. If using octal, it has
to be four digits. The first digit is generally the flag “0” to
indicate no special permissions.</p></li>
</ul>
<p>Copy options:</p>
<ul class="simple">
<li><p>content = Instead of providing a <code class="docutils literal notranslate"><span class="pre">src</span></code> file to copy, write the <code class="docutils literal notranslate"><span class="pre">contents</span></code> string to the file.</p></li>
<li><p>remote_src = If set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, the source file will be found on the server Ansible is running tasks on (not the local machine). The default is <code class="docutils literal notranslate"><span class="pre">false</span></code>.</p></li>
</ul>
<p>File options:</p>
<ul class="simple">
<li><p>state = Specify the state the file should be created in.</p>
<ul>
<li><p>file = Copy the file.</p></li>
<li><p>link = Create a soft link shortcut.</p></li>
<li><p>hard = Create a hard link reference.</p></li>
<li><p>touch = Create an empty file.</p></li>
<li><p>directory = Create all subdirectories in the destination folder.</p></li>
<li><p>absent = Delete destination folders.</p></li>
</ul>
</li>
</ul>
<p>Synchronize options:</p>
<ul class="simple">
<li><p>archive = Preserve all of the original file permissions. The default
is <code class="docutils literal notranslate"><span class="pre">yes</span></code>.</p></li>
<li><p>delete = Remove files in the destination directory that do not exist
in the source directory.</p></li>
<li><p>mode</p>
<ul>
<li><p>push = Default. Copy files from the source to the destination
directory.</p></li>
<li><p>pull = Copy files from the destination to the source directory.</p></li>
</ul>
</li>
<li><p>recursive = Recursively copy contents of all sub-directories. The
default is <code class="docutils literal notranslate"><span class="pre">no</span></code>.</p></li>
<li><p>rsync_opts = Provide additional <code class="docutils literal notranslate"><span class="pre">rsync</span></code> command line arguments.</p></li>
</ul>
<p>Synchronize example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Copying the contents from one directory to another on the managed host only</span>
  <span class="nt">synchronize</span><span class="p">:</span>
    <span class="nt">src</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/path/to/src/</span>
    <span class="nt">dest</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/path/to/dest/</span>
  <span class="nt">delegate_to</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">inventory_hostname</span><span class="nv"> </span><span class="s">}}&quot;</span>
</pre></div>
</div>
<p>Template example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Copying a template from the role&#39;s &quot;templates&quot; directory to the managed hosts</span>
  <span class="nt">template</span><span class="p">:</span>
    <span class="nt">src</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">example.conf.j2</span>
    <span class="nt">dest</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/etc/example/example.conf</span>
    <span class="nt">mode</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0644</span>
    <span class="nt">owner</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">root</span>
    <span class="nt">group</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">nobody</span>
</pre></div>
</div>
<p>[46]</p>
</div>
<div class="section" id="cron">
<h4><a class="toc-backref" href="#id71">Cron</a><a class="headerlink" href="#cron" title="Permalink to this headline">¶</a></h4>
<p>The cron module is used to manage crontab entries. Crons are
scheduled/automated tasks that run on Unix-like systems.</p>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">cron</span><span class="p">:</span>
</pre></div>
</div>
<p>Common options:</p>
<ul class="simple">
<li><p>user = Modify the specified user’s crontab.</p></li>
<li><p>job = Provide a command to run when the cron reaches the correct</p></li>
<li><p>minute</p></li>
<li><p>hour</p></li>
<li><p>weekday = Specify the weekday as a number 0 through 6 where 0 is
Sunday and 6 is Saturday.</p></li>
<li><p>month</p></li>
<li><p>day = Specify the day number in the 30 day month.</p></li>
<li><p>backup = Backup the existing crontab. The “backup_file” variable
provides the backed up file name.</p>
<ul>
<li><p>yes</p></li>
<li><p>no</p></li>
</ul>
</li>
<li><p>state</p>
<ul>
<li><p>present = add the crontab</p></li>
<li><p>absent = remove an existing entry</p></li>
</ul>
</li>
<li><p>special_time</p>
<ul>
<li><p>reboot</p></li>
<li><p>yearly or annually</p></li>
<li><p>monthly</p></li>
<li><p>weekly</p></li>
<li><p>daily</p></li>
<li><p>hourly</p></li>
</ul>
</li>
</ul>
<p>Example #1:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">cron</span><span class="p">:</span>
  <span class="nt">job</span><span class="p">:</span> <span class="s">&quot;/usr/bin/wall</span><span class="nv"> </span><span class="s">This</span><span class="nv"> </span><span class="s">actually</span><span class="nv"> </span><span class="s">works&quot;</span>
  <span class="nt">minute</span><span class="p">:</span> <span class="s">&quot;*/1&quot;</span>
  <span class="nt">user</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">redhat</span>
</pre></div>
</div>
<p>Example #2:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">cron</span><span class="p">:</span>
  <span class="nt">job</span><span class="p">:</span> <span class="s">&quot;/usr/bin/yum</span><span class="nv"> </span><span class="s">-y</span><span class="nv"> </span><span class="s">update&quot;</span>
  <span class="nt">weekday</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
  <span class="nt">hour</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">6</span>
  <span class="nt">backup</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">yes</span>
</pre></div>
</div>
<p>[55]</p>
</div>
<div class="section" id="expect">
<h4><a class="toc-backref" href="#id72">Expect</a><a class="headerlink" href="#expect" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">expect</span></code> module executes a command, searches for a regular
expression pattern and, if found, it will provide standard input back to
the command.</p>
<p>All options:</p>
<ul class="simple">
<li><p>chdir = Change into a different directory before running the command.</p></li>
<li><p><strong>command</strong> = The command to execute.</p></li>
<li><p>creates = A path to a file which should be created after the command
executes properly.</p></li>
<li><p>echo = Show the response strings that were used.</p></li>
<li><p>removes = A path to a file which should not exist after the command
executes properly.</p></li>
<li><p><strong>responses</strong> = A dictionary of patterns to search for and responses
that they should provide back.</p></li>
<li><p>timeout = The time, in seconds, to wait for finding the pattern.</p></li>
</ul>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">expect</span><span class="p">:</span>
  <span class="nt">command</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;COMMAND&gt;</span>
  <span class="nt">responses</span><span class="p">:</span>
    <span class="nt">&lt;PATTERN&gt;</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;RESPONSE_TO_USE&gt;</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Find all of the available fruit</span>
  <span class="nt">expect</span><span class="p">:</span>
    <span class="nt">command</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mysql -u dave -p -e &#39;SELECT fruit_name FROM food.fruits;&#39;</span>
    <span class="nt">responses</span><span class="p">:</span>
      <span class="nt">password</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">mysql_pass_dave</span><span class="nv"> </span><span class="s">}}&quot;</span>
</pre></div>
</div>
<p>[6]</p>
</div>
<div class="section" id="get-url">
<h4><a class="toc-backref" href="#id73">Get URL</a><a class="headerlink" href="#get-url" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">get_url</span></code> module is used to download files from online.</p>
<p>Common options:</p>
<ul class="simple">
<li><p>backup = Backup the destination file if it already exists. Default:
no.</p></li>
<li><p>checksum = Specify a checksum method to use and the hash that is
expected.</p></li>
<li><p><strong>dest</strong> = Where the downloaded file should be saved to</p></li>
<li><p>timeout = The time, in seconds, to wait for a connection to the URL
before failing. Default: 10.</p></li>
<li><p>{group|mode|owner} = Specify the permissions for the downloaded
file.</p></li>
<li><p><strong>url</strong> = The URL to download.</p></li>
<li><ul>
<li><p>use_proxy = Use the proxy settings from the environment
variables. Default: yes.</p></li>
</ul>
</li>
<li><p>validate_certs = Validate SSL certificates. Default: yes.</p></li>
</ul>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">get_url</span><span class="p">:</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Downloading a configuration file</span>
  <span class="nt">get_url</span><span class="p">:</span>
    <span class="nt">url</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://internal.domain.tld/configs/nginx/nginx.conf</span>
    <span class="nt">dest</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/etc/nginx/nginx.conf</span>
    <span class="nt">owner</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">nginx</span>
    <span class="nt">group</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">nginx</span>
    <span class="nt">mode</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0644</span>
    <span class="nt">validate_certs</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">no</span>
</pre></div>
</div>
<p>[54]</p>
</div>
<div class="section" id="git">
<h4><a class="toc-backref" href="#id74">Git</a><a class="headerlink" href="#git" title="Permalink to this headline">¶</a></h4>
<p>Git is a utility used for provisioning and versioning software. Ansible
has built-in support for handling most Git-related tasks.</p>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">git</span><span class="p">:</span>
</pre></div>
</div>
<p>Common options:</p>
<ul class="simple">
<li><p>repo = The full path of the repository.</p></li>
<li><p>dest = The path to place/use the repository</p></li>
<li><p>update = Pull the latest version from the Git server. The default is
“yes.”</p></li>
<li><p>version = Switch to a different branch or tag.</p></li>
<li><p>ssh_opts = If using SSH, specify custom SSH options.</p></li>
<li><p>force = Override local changes. The default is “yes.”</p></li>
</ul>
<p>[7]</p>
</div>
<div class="section" id="service">
<h4><a class="toc-backref" href="#id75">Service</a><a class="headerlink" href="#service" title="Permalink to this headline">¶</a></h4>
<p>The service module is used to handle system services.</p>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">service</span><span class="p">:</span>
</pre></div>
</div>
<p>Common options:</p>
<ul class="simple">
<li><p>name = Specify the service name.</p></li>
<li><p>enabled = Enable the service to start on boot or not. Valid options
are “yes” or “no.”</p></li>
<li><p>sleep = When restarted a service, specify the amount of time (in
seconds) to wait before starting a service after stopping it.</p></li>
<li><p>state = Specify what state the service should be in.</p></li>
<li><p>started = Start the service.</p></li>
<li><p>stopped = Stop the service.</p></li>
<li><p>restarted = Stop and then start the service.</p></li>
<li><p>reloaded = If supported by the service, it will reload it’s
configuration file without restarting it’s main thread. [55]</p></li>
</ul>
<p>Example:</p>
<ul>
<li><p>Restart the Apache service “httpd.”</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Restarting the Apache service and waiting 3 seconds for it to fully start</span>
  <span class="nt">service</span><span class="p">:</span>
    <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">httpd</span>
    <span class="nt">state</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">restarted</span>
    <span class="nt">sleep</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">3</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="mysql-database-and-user">
<h4><a class="toc-backref" href="#id76">MySQL Database and User</a><a class="headerlink" href="#mysql-database-and-user" title="Permalink to this headline">¶</a></h4>
<p>MySQL databases and users can be managed via Ansible. It requires the
“MySQLdb” Python library and the “mysql” and “mysqldump” binaries.</p>
<p>MySQL database syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">mysql_db</span><span class="p">:</span>
</pre></div>
</div>
<p>MySQL user syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">mysql_user</span><span class="p">:</span>
</pre></div>
</div>
<p>Options:</p>
<ul class="simple">
<li><p>name = Specify the database name. The word “all” can be used to
control all databases.</p></li>
<li><p>state</p></li>
<li><p>present = Create the database.</p></li>
<li><p>absent = Delete the database.</p></li>
<li><p>dump = Backup the database.</p></li>
<li><p>import = Import a database.</p></li>
<li><p>target = Specify a dump or import location.</p></li>
<li><p>config_file = Specify the user configuration file. Default:
“~/.my.cnf.” Alternatively, login credentials can be manually
specified.</p></li>
<li><p>login_host = The MySQL server’s IP or hostname. Default:
“localhost.”</p></li>
<li><p>login_user = The MySQL username to login as.</p></li>
<li><p>login_password = The MySQL user’s password.</p></li>
<li><p>login_port = The MySQL port to connect to. Default: “3306.”</p></li>
<li><p>login_unix_socket = On Unix, a socket file can be used to connect
to MySQL instead of a host and port.</p></li>
<li><p>connection_timeout = How long to wait (in seconds) before closing
the MySQL connection. The default is “30.” [16]</p></li>
<li><p>priv (mysql_user) = The privileges for the MySQL user. [17]</p></li>
</ul>
<p>Example #1:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">mysql_db</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">toorsdb</span>
  <span class="nt">state</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">present</span>
  <span class="nt">config_file</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/secrets/.my.cnf</span>
</pre></div>
</div>
<p>Example #2:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">mysql_user</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">toor</span>
  <span class="nt">login_user</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">root</span>
  <span class="nt">login_password</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">vault_encrypted_password</span><span class="nv"> </span><span class="s">}}&quot;</span>
  <span class="nt">priv</span><span class="p">:</span> <span class="s">&quot;somedb.*:ALL&quot;</span>
  <span class="nt">state</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">present</span>
</pre></div>
</div>
<p>Example #3:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">mysql_user</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">maxscale</span>
  <span class="nt">host</span><span class="p">:</span> <span class="s">&quot;10.0.0.%&quot;</span>
  <span class="nt">priv</span><span class="p">:</span> <span class="s">&quot;*.*:REPLICATION</span><span class="nv"> </span><span class="s">CLIENT,SELECT&quot;</span>
  <span class="nt">password</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">maxscale_vault_encrypted_password</span><span class="nv"> </span><span class="s">}}&quot;</span>
  <span class="nt">state</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">present</span>
</pre></div>
</div>
</div>
<div class="section" id="raw">
<h4><a class="toc-backref" href="#id77">Raw</a><a class="headerlink" href="#raw" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">raw</span></code> module runs commands directly through SSH. Unlike the <code class="docutils literal notranslate"><span class="pre">shell</span></code> module, Ansible does not have any Python wrappers around this. This makes it possible to run commands on remote systems that do not have Python installed. [6]</p>
<p>Options:</p>
<ul class="simple">
<li><p>executable = The absolute path to an executable shell.</p></li>
</ul>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">raw</span><span class="p">:</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">raw</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">echo &quot;Hello world!&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="stat">
<h4><a class="toc-backref" href="#id78">Stat</a><a class="headerlink" href="#stat" title="Permalink to this headline">¶</a></h4>
<p>This module provides detailed information about a file, directory, or
link. It was designed to be similar to the Unix command <code class="docutils literal notranslate"><span class="pre">stat</span></code>. All
the information from this module can be saved to a variable and accessed
as a from new <code class="docutils literal notranslate"><span class="pre">&lt;VARIABLE&gt;.stat</span></code> dictionary.</p>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">stat</span><span class="p">:</span>
  <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;FILE_PATH&gt;</span>
<span class="nt">register</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;STAT_VARIABLE&gt;</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">stat</span><span class="p">:</span>
    <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/root/.ssh/id_rsa</span>
  <span class="nt">register</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">id_rsa</span>

<span class="p p-Indicator">-</span> <span class="nt">file</span><span class="p">:</span>
    <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/root/.ssh/id_rsa</span>
    <span class="nt">mode</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0600</span>
    <span class="nt">owner</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">root</span>
    <span class="nt">group</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">root</span>
  <span class="nt">when</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">id_rsa.stat.mode is not &quot;0600&quot;</span>
</pre></div>
</div>
<p>Common options:</p>
<ul class="simple">
<li><p>checksum_algorithm = The algorithm to use for finding the checksum.</p>
<ul>
<li><p>sha1 (Default)</p></li>
<li><p>sha224</p></li>
<li><p>sha256</p></li>
<li><p>sha384</p></li>
<li><p>sha512</p></li>
</ul>
</li>
<li><p>follow = Follow symbolic links.</p></li>
<li><p>get_checksum = If the SHA checksum should be generated.</p></li>
<li><p>get_md5 = Boolean. If the MD5 checksum should be generated.</p></li>
<li><p>path = Required. String. The full path to the file.</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">stat</span></code> dictionary values:</p>
<ul class="simple">
<li><p>{a|c|m}time = Float. The last time the file was either accessed,
the metadata was created, or modified.</p></li>
<li><p>attributes = List. All of the file attributes.</p></li>
<li><p>charset = String. The text file encoding format.</p></li>
<li><p>checksum = String. The has of the path.</p></li>
<li><p>dev = Integer. The device the inode exists on.</p></li>
<li><p>{executable|readable|writable} = Boolean. If the file is
executable, readable, or writable by the remote user that Ansible is
running as.</p></li>
<li><p>exists = Boolean. If the file exists or not.</p></li>
<li><p>{gr|pw}_name = String. The name of the group or user owner.</p></li>
<li><p>isblk = Boolean. If the file is a block device.</p></li>
<li><p>ischr = Boolean. If the file is a character device for standard input
or output.</p></li>
<li><p>isdir = Boolean. If the file is a directory.</p></li>
<li><p>isfifo = Boolean. If the file is a named pipe.</p></li>
<li><p>islink = Boolean. If the file is a symbolic link.</p></li>
<li><p>inode = Integer. The Unix inode number of the file.</p></li>
<li><p>isreg = Boolean. If the file is a regular file.</p></li>
<li><p>issock. Boolean. If the file is a Unix socket.</p></li>
<li><p>is{uid|gid} = Boolean. If the file is owned by the user or group
that the remote Ansible user is running as.</p></li>
<li><p>lnk_source = String. The original path of the symbolic link.</p></li>
<li><p>md5 = String. The MD5 hash of the file.</p></li>
<li><p>mime_type = The “magic data” that specifies the file type.</p></li>
<li><p>mode = Octal Unix file permissions.</p></li>
<li><p>nlink. Integer. The number of links that are used to redirect to the
original inode.</p></li>
<li><p>path = String. The full path to the file.</p></li>
<li><p>{r|w|x}usr = Boolean. If the user owner has readable, writable, or
executable permissions.</p></li>
<li><p>{r|w|x}grp = Boolean. If the group owner has readable, writable,
or executable permissions.</p></li>
<li><p>{r|w|x}oth = Boolean. If other users have readable, writable, or
executable permissions.</p></li>
<li><p>size = Integer. The size, in bytes, of the file.</p></li>
<li><p>{uid|gid} = Integer. The ID of user or group owner of the file.</p></li>
</ul>
<p>[46]</p>
</div>
<div class="section" id="uri">
<h4><a class="toc-backref" href="#id79">URI</a><a class="headerlink" href="#uri" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">uri</span></code> module is used for handling HTTP requests.</p>
<p>Common options:</p>
<ul class="simple">
<li><p>HEADER_* = Modify different types of header content.</p></li>
<li><p>body = The body of the request to send.</p></li>
<li><p>body_format = The format to uses for the body. Default: raw.</p>
<ul>
<li><p>json</p></li>
<li><p>raw</p></li>
</ul>
</li>
<li><p>dest = A path to where a file should be downloaded to.</p></li>
<li><p>follow_redirects = Default: safe.</p>
<ul>
<li><p>all = Follow all redirects.</p></li>
<li><p>none = Do not follow any redirects.</p></li>
<li><p>safe = Follow the first redirect only.</p></li>
</ul>
</li>
<li><p>method = The HTTP method type to use. Default: GET.</p>
<ul>
<li><p>CONNECT</p></li>
<li><p>DELETE</p></li>
<li><p>GET</p></li>
<li><p>HEAD</p></li>
<li><p>OPTIONS</p></li>
<li><p>PATCH</p></li>
<li><p>POST</p></li>
<li><p>PUT</p></li>
<li><p>REFRESH</p></li>
<li><p>TRACE</p></li>
</ul>
</li>
<li><p>password = The password to use for basic HTTP authentication.</p></li>
<li><p>status_code = The expected status code from the request. Default:
200.</p></li>
<li><p>timeout = When a connection to a URL should time out if it’s
unreachable.</p></li>
<li><p><strong>url</strong> = The HTTP URL to connect to.</p></li>
<li><p>user = The username to use for basic HTTP authentication.</p></li>
</ul>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">uri</span><span class="p">:</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Authenticate with OpenStack&#39;s Keystone v3 service</span>
  <span class="nt">uri</span><span class="p">:</span>
    <span class="l l-Scalar l-Scalar-Plain">HEADER_Content-Type=&quot;application/json&quot;</span>
    <span class="l l-Scalar l-Scalar-Plain">body_format</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">json</span>
    <span class="nt">body</span><span class="p">:</span> <span class="p p-Indicator">&gt;</span>
<span class="p p-Indicator">{</span>
    <span class="s">&quot;auth&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
        <span class="s">&quot;identity&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
            <span class="s">&quot;methods&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span>
                <span class="s">&quot;password&quot;</span>
            <span class="p p-Indicator">],</span>
            <span class="s">&quot;password&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
                <span class="s">&quot;user&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
                    <span class="s">&quot;domain&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
                        <span class="s">&quot;name&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;Default&quot;</span>
                    <span class="p p-Indicator">},</span>
                    <span class="s">&quot;name&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;admin&quot;</span><span class="p p-Indicator">,</span>
                    <span class="s">&quot;password&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">admin_pass</span><span class="nv"> </span><span class="s">}}&quot;</span>
                <span class="p p-Indicator">}</span>
            <span class="p p-Indicator">}</span>
        <span class="p p-Indicator">},</span>
        <span class="s">&quot;scope&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
            <span class="s">&quot;project&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
                <span class="s">&quot;domain&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
                    <span class="s">&quot;name&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;Default&quot;</span>
                <span class="p p-Indicator">},</span>
                <span class="s">&quot;name&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;demo&quot;</span>
            <span class="p p-Indicator">}</span>
        <span class="p p-Indicator">}</span>
    <span class="p p-Indicator">}</span>
<span class="p p-Indicator">}</span>
    <span class="nt">method</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">POST</span>
    <span class="nt">url</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://openstack.tld:5000/v3/auth/tokens</span>
<span class=" -Error">  </span><span class="nt">register</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">os_token_request</span>
</pre></div>
</div>
<p>[54]</p>
</div>
<div class="section" id="package-managers">
<h4><a class="toc-backref" href="#id80">Package Managers</a><a class="headerlink" href="#package-managers" title="Permalink to this headline">¶</a></h4>
<p>Ansible has the ability to add, remove, or update software packages.
Almost every popular package manager is supported. This can
generically be handled by the “package” module or the specific module
for the operating system’s package manager.</p>
<p>In Ansible &gt;= 2.7, package modules can accept a list for the “name” argument. This avoids the need to use a loop. [73]</p>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">package</span><span class="p">:</span>
</pre></div>
</div>
<p>Common options:</p>
<ul class="simple">
<li><p>name = Specify the package name.</p></li>
<li><p>state = Specify how to change the package state.</p></li>
<li><p>present = Install the package.</p></li>
<li><p>latest = Update the package (or install, if necessary).</p></li>
<li><p>absent = Uninstall the package.</p></li>
<li><p>use = Specify the package manager to use.</p></li>
<li><p>auto = Automatically detect the package manager to use. This is the
default.</p></li>
<li><p>apt = Use Debian’s Apt package manager.</p></li>
<li><p>yum = Use Red Hat’s yum package manager.</p></li>
</ul>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Updating MariaDB</span>
  <span class="nt">package</span><span class="p">:</span>
    <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mariadb</span>
    <span class="nt">state</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">latest</span>
</pre></div>
</div>
<p>[47]</p>
<div class="section" id="apt">
<h5><a class="toc-backref" href="#id81">Apt</a><a class="headerlink" href="#apt" title="Permalink to this headline">¶</a></h5>
<p>Apt is used to install and manage packages on Debian based operating
systems.</p>
<p>Common options:</p>
<ul class="simple">
<li><p>name = The package name.</p></li>
<li><p>state</p>
<ul>
<li><p>present = Install the package.</p></li>
<li><p>latest = Update the package.</p></li>
<li><p>absent = Uninstall the package.</p></li>
<li><p>build-dep = Install the build dependencies for the source code.</p></li>
</ul>
</li>
<li><p>update_cache = Update the Apt cache (apt-get update). Default: no.</p></li>
<li><p>deb = Install a specified *.deb file.</p></li>
<li><p>autoremove = Remove all dependencies that are no longer required.</p></li>
<li><p>purge = Delete configuration files.</p></li>
<li><p>install_recommends = Install recommended packages.</p></li>
<li><p>upgrade</p>
<ul>
<li><p>no = Do not upgrade any system packages (default).</p></li>
<li><p>yes = Update all of the system packages (apt-get upgrade).</p></li>
<li><p>full = Update all of the system packages and uninstall older,
conflicting packages (apt-get full-upgrade).</p></li>
<li><p>dist = Upgrade the operating system (apt-get dist-upgrade).</p></li>
</ul>
</li>
</ul>
<p>[47]</p>
</div>
<div class="section" id="yum">
<h5><a class="toc-backref" href="#id82">Yum</a><a class="headerlink" href="#yum" title="Permalink to this headline">¶</a></h5>
<p>There are two commands to primarily handle Red Hat’s Yum package
manager: “yum” and “yum_repository.”</p>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">yum</span><span class="p">:</span>
</pre></div>
</div>
<p>Common options:</p>
<ul class="simple">
<li><p>name = Specify the package name.</p></li>
<li><p>state = Specify the package state.</p></li>
<li><p>{present|installed|latest} = Any of these will install the package.</p></li>
<li><p>{absent|removed} = Any of these will uninstall the package.</p></li>
<li><p>enablerepo = Temporarily enable a repository.</p></li>
<li><p>disablerepo = Temporarily disable a repository.</p></li>
<li><p>disable_gpg_check = Disable the GPG check. The default is “no”.</p></li>
<li><p>conf_file = Specify a Yum configuration file to use.</p></li>
</ul>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Installing Ansible from EPEL and disabling GPG check as an example</span>
  <span class="nt">yum</span><span class="p">:</span>
    <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ansible</span>
    <span class="nt">state</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">installed</span>
    <span class="nt">enablerepo</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">epel</span>
    <span class="nt">disable_gpg_check</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">yes</span>
</pre></div>
</div>
<p>Yum repository syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">yum_repository</span><span class="p">:</span>
</pre></div>
</div>
<p>Common options:</p>
<ul class="simple">
<li><p>baseurl = Provide the URL of the repository.</p></li>
<li><p><strong>description</strong> = Required if <code class="docutils literal notranslate"><span class="pre">state=present</span></code>. Provide a
description of the repository.</p></li>
<li><p>enabled = Enable the repository permanently to be active. The default
is “yes.”</p></li>
<li><p>exclude = List packages that should be excluded from being accessed
from this repository.</p></li>
<li><p>gpgcheck = Validate the RPMs with a GPG check. The default is “no.”</p></li>
<li><p>gpgkey = Specify a URL to the GPG key.</p></li>
<li><p>includepkgs = A space separated list of packages that can be used
from this repository. This is an explicit allow list.</p></li>
<li><p>mirrorlist = Provide a URL to a mirrorlist repository instead of the
baseurl.</p></li>
<li><p><strong>name</strong> = Required. Specify a name for the repository. This is only
required if the file is being created (state=present) or deleted
(state=absent).</p></li>
<li><p>reposdir = The directory to store the Yum configuration files.
Default: <code class="docutils literal notranslate"><span class="pre">/etc/yum.repos.d/</span></code>.</p></li>
<li><p>state = Specify a state for the repository file.</p></li>
<li><p>present = Install the Yum repository file. This is the default.</p></li>
<li><p>absent = Delete the repository file.</p></li>
</ul>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Adding the RepoForge repository to /etc/yum.repos.d/</span>
  <span class="nt">yum_repository</span><span class="p">:</span>
    <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">repoforge</span>
    <span class="nt">baseurl</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">http://apt.sw.be/redhat/el7/en/x86_64/rpmforge/</span>
    <span class="nt">enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">no</span>
    <span class="nt">description</span><span class="p">:</span> <span class="s">&quot;Third-party</span><span class="nv"> </span><span class="s">RepoForge</span><span class="nv"> </span><span class="s">packages</span><span class="nv"> </span><span class="s">(previously</span><span class="nv"> </span><span class="s">RPMForge)&quot;</span>
</pre></div>
</div>
<p>[47]</p>
</div>
</div>
</div>
<div class="section" id="windows-modules">
<h3><a class="toc-backref" href="#id83">Windows Modules</a><a class="headerlink" href="#windows-modules" title="Permalink to this headline">¶</a></h3>
<p>These modules are specific to managing Windows servers and are not
related to the normal modules designed for UNIX-like operating systems.
These module names start with the “win_” prefix.</p>
<div class="section" id="id3">
<h4><a class="toc-backref" href="#id84">Command and Shell</a><a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h4>
<p>Windows commands can be executed via a console. The <code class="docutils literal notranslate"><span class="pre">command</span></code> module
uses the DOS “cmd” binary and shell, by default, uses PowerShell.</p>
<p>All similar <code class="docutils literal notranslate"><span class="pre">command</span></code> and <code class="docutils literal notranslate"><span class="pre">shell</span></code> options:</p>
<ul class="simple">
<li><p>chdir = Change the current working directory on the remote server
before executing a command.</p></li>
<li><p>creates = A path (optionally with a regular expression pattern) to a
file. If this file already exists, this module will be marked as
“skipped.”</p></li>
<li><p>removes = If a path does not exist then this module will be marked as
“skipped.”</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">shell</span></code> options:</p>
<ul class="simple">
<li><p>executable = The binary to use for executing commands. By default
this is PowerShell. Use “cmd” for running DOS commands.</p></li>
</ul>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">win_command</span><span class="p">:</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">win_shell</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">win_shell</span><span class="p">:</span> <span class="s2">&quot;echo Hello World &gt; c:\hello.txt&quot;</span>
  <span class="n">chdir</span><span class="p">:</span> <span class="s2">&quot;c:</span><span class="se">\&quot;</span>
  <span class="n">creates</span><span class="p">:</span> <span class="s2">&quot;c:\hello.txt&quot;</span>
</pre></div>
</div>
<p>[48]</p>
</div>
<div class="section" id="file-management">
<h4><a class="toc-backref" href="#id85">File Management</a><a class="headerlink" href="#file-management" title="Permalink to this headline">¶</a></h4>
<div class="section" id="copy">
<h5><a class="toc-backref" href="#id86">Copy</a><a class="headerlink" href="#copy" title="Permalink to this headline">¶</a></h5>
<p>Copy files from the Playbook to the remote server.</p>
<p>All options:</p>
<ul class="simple">
<li><p>content = Instead of using <code class="docutils literal notranslate"><span class="pre">src</span></code>, specify the text that should
exist in the destination file.</p></li>
<li><p><strong>dest</strong> = The destination to copy the file to.</p></li>
<li><p>force = Replace files in the destination path if there is a conflict.
Default: True.</p></li>
<li><p>remote_src = Copy a file from one location on the remote server to
another on the same server.</p></li>
<li><p><strong>src</strong> = The source file to copy.</p></li>
</ul>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">win_copy</span><span class="p">:</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Copying a configuration file</span>
  <span class="nt">win_copy</span><span class="p">:</span>
    <span class="nt">src</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">C:\Windows\example.conf</span>
    <span class="nt">dest</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">C:\temp\</span>
    <span class="nt">remote_src</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
</pre></div>
</div>
<p>[48]</p>
</div>
<div class="section" id="file">
<h5><a class="toc-backref" href="#id87">File</a><a class="headerlink" href="#file" title="Permalink to this headline">¶</a></h5>
<p>All options:</p>
<ul class="simple">
<li><p><strong>path</strong> = The full path to the file on the remote server that should
be created, removed, and/or checked.</p></li>
<li><p>state</p>
<ul>
<li><p>absent = Delete the file.</p></li>
<li><p>directory = Create a directory.</p></li>
<li><p>file = Check to see if a file exists. Do not create a file if it
does not exist.</p></li>
<li><p>touch = Create a file if it does not exist.</p></li>
</ul>
</li>
</ul>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">win_file</span><span class="p">:</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">win_file</span><span class="p">:</span>
    <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">C:\Users\admin\runtime_files</span>
    <span class="nt">state</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">directory</span>
</pre></div>
</div>
<p>[48]</p>
</div>
<div class="section" id="robocopy">
<h5><a class="toc-backref" href="#id88">Robocopy</a><a class="headerlink" href="#robocopy" title="Permalink to this headline">¶</a></h5>
<p>Robocopy is a CLI utility, available on the latest versions of Windows,
for synchronizing directories.</p>
<p>All options:</p>
<ul class="simple">
<li><p><strong>dest</strong> = The destination directory.</p></li>
<li><p>flags = Provide additional arguments to the robocopy command.</p></li>
<li><p>purge = Delete files in the destination that do not exist in the
source directory.</p></li>
<li><p>recurse = Recursively copy subdirectories.</p></li>
<li><p><strong>src</strong> = The source directory to copy from.</p></li>
</ul>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">win_robocopy</span><span class="p">:</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">win_robocopy</span><span class="p">:</span>
  <span class="nt">src</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">C:\tmp\</span>
  <span class="nt">dest</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">C:\tmp_old\</span>
  <span class="nt">recurse</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
</pre></div>
</div>
<p>[48]</p>
</div>
<div class="section" id="shortcut">
<h5><a class="toc-backref" href="#id89">Shortcut</a><a class="headerlink" href="#shortcut" title="Permalink to this headline">¶</a></h5>
<p>Manage Windows shortcuts.</p>
<p>All options:</p>
<ul class="simple">
<li><p>args = Arguments to provide to the source executable.</p></li>
<li><p>description = A description about the shortcut.</p></li>
<li><p><strong>dest</strong> = The path and file name of the shortcut. For executables
use the extension <code class="docutils literal notranslate"><span class="pre">.lnk</span></code> and for URLs use <code class="docutils literal notranslate"><span class="pre">.url</span></code>.</p></li>
<li><p>directory = The work directory for the executable.</p></li>
<li><p>hotkey = The combination of keys to virtually press when the shortcut
is executed.</p></li>
<li><p>icon = A <code class="docutils literal notranslate"><span class="pre">.ico</span></code> icon file to use as the shortcut image.</p></li>
<li><p>src = The executable or URL that the shortcut should open.</p></li>
<li><p>state</p>
<ul>
<li><p>absent = Delete the shortcut.</p></li>
<li><p>present = Create the shortcut.</p></li>
</ul>
</li>
<li><p>windowstyle = How the program’s window is sized during launch.</p>
<ul>
<li><p>default</p></li>
<li><p>maximized</p></li>
<li><p>minimized</p></li>
</ul>
</li>
</ul>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">win_shortcut</span><span class="p">:</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">win_shortcut</span><span class="p">:</span>
  <span class="nt">src</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">C:\Program Files (x86)\game\game.exe</span>
  <span class="nt">dest</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">C:\Users\Ben\Desktop\game.lnk</span>
</pre></div>
</div>
<p>[48]</p>
</div>
<div class="section" id="template">
<h5><a class="toc-backref" href="#id90">Template</a><a class="headerlink" href="#template" title="Permalink to this headline">¶</a></h5>
<p>The Windows Jinja2 template module uses the same options as the normal
<code class="docutils literal notranslate"><span class="pre">template</span></code> module.</p>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">win_template</span><span class="p">:</span>
</pre></div>
</div>
<p>[48]</p>
</div>
</div>
<div class="section" id="installations">
<h4><a class="toc-backref" href="#id91">Installations</a><a class="headerlink" href="#installations" title="Permalink to this headline">¶</a></h4>
<div class="section" id="chocolatey">
<h5><a class="toc-backref" href="#id92">Chocolatey</a><a class="headerlink" href="#chocolatey" title="Permalink to this headline">¶</a></h5>
<p>Chocolatey is an unofficial package manager for Windows. Packages can be
installed from a public or private Chocolatey repository.</p>
<p>Common options:</p>
<ul class="simple">
<li><p>force = Reinstall an existing package.</p></li>
<li><p>install_args = Arguments to pass to Chocolatey during installation.</p></li>
<li><p>ignore_dependencies = Ignore dependencies of a package. Default: no.</p></li>
<li><p><strong>name</strong> = The name of a package to manage.</p></li>
<li><p>source = The Chocolatey repository to use.</p></li>
<li><p>state = Default: present.</p>
<ul>
<li><p>absent = Uninstall the package.</p></li>
<li><p>present = Install the package.</p></li>
<li><p>latest = Update the package.</p></li>
</ul>
</li>
<li><p>timeout = The number of seconds to wait for Chocolatey to complete
it’s action. Default: 2700.</p></li>
<li><p>version = The exact version of a package that should be installed.</p></li>
</ul>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">win_chocolatey</span><span class="p">:</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">win_chocolatey</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="s">&quot;libreoffice-fresh&quot;</span>
  <span class="nt">state</span><span class="p">:</span> <span class="s">&quot;upgrade&quot;</span>
  <span class="nt">version</span><span class="p">:</span> <span class="s">&quot;6.0.3&quot;</span>
</pre></div>
</div>
<p>[48]</p>
</div>
<div class="section" id="feature">
<h5><a class="toc-backref" href="#id93">Feature</a><a class="headerlink" href="#feature" title="Permalink to this headline">¶</a></h5>
<p>Manage official features and roles in Windows.</p>
<p>All options:</p>
<ul class="simple">
<li><p>include_management_tools = Install related management tools. This
only works in Windows Server &gt;= 2012.</p></li>
<li><p>include_sub_features = Install all subfeatures related to the main
feature.</p></li>
<li><p><strong>name</strong> = The name of the feature or role.</p></li>
<li><p>restart = Restart the server after installation.</p></li>
<li><p>source = The path to the local package of the feature. This only
works in Windows Server &gt;= 2012.</p></li>
<li><p>state</p>
<ul>
<li><p>absent = Uninstall the feature.</p></li>
<li><p>present = Install the feature.</p></li>
</ul>
</li>
</ul>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">win_feature</span><span class="p">:</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Install the IIS HTTP web server</span>
  <span class="nt">win_feature</span><span class="p">:</span>
    <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Web-Server</span>
    <span class="nt">state</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">present</span>
</pre></div>
</div>
<p>[48]</p>
<p>On Windows, all of the available features can be found via PowerShell.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>&gt; Get-WindowsFeature
</pre></div>
</div>
<p>If part of the name is known, a PowerShell wildcard can be used to
narrow it down.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>&gt; Get-WindowsFeature -Name &lt;PART_OF_A_NAME&gt;*
</pre></div>
</div>
<p>[37]</p>
</div>
<div class="section" id="msi">
<h5><a class="toc-backref" href="#id94">MSI</a><a class="headerlink" href="#msi" title="Permalink to this headline">¶</a></h5>
<p><strong>Deprecated in: 2.3 Replaced by: ``win_package``</strong></p>
<p>The MSI module is used to install executable packages. [48]</p>
</div>
<div class="section" id="package">
<h5><a class="toc-backref" href="#id95">Package</a><a class="headerlink" href="#package" title="Permalink to this headline">¶</a></h5>
<p>Manage official Microsoft packages for Windows. Examples of these
include the .NET Framework, Remote Desktop Connection Manager, Visual
C++ Redistributable, and more.</p>
<p>All options:</p>
<ul class="simple">
<li><p>arguments = Arguments will be passed to the package during
installation.</p></li>
<li><p>expected_return_code = The return code number that is expected
after the installation is complete. Default: 0.</p></li>
<li><p>name = Optionally provide a friendly name for the package for Ansible
logging purposes.</p></li>
<li><p><strong>path</strong> = The file path or HTTP URL to a package.</p></li>
<li><p><strong>product_id</strong> = For verifying installation, the product ID is
required to lookup in the registry if it is installed already.</p>
<ul>
<li><p>Note: This can be found at:</p>
<ul>
<li><p>64-bit:
<code class="docutils literal notranslate"><span class="pre">HKLM:Software\Microsoft\Windows\CurrentVersion\Uninstall</span></code></p></li>
<li><p>32-bit:
<code class="docutils literal notranslate"><span class="pre">HKLM:Software\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall</span></code></p></li>
</ul>
</li>
</ul>
</li>
<li><p>state</p>
<ul>
<li><p>absent = Uninstall the package.</p></li>
<li><p>present = Install the package.</p></li>
</ul>
</li>
<li><p>user_{name|password} = Specify the username and password to access
a SMB/CIFS share that contains the package.</p></li>
</ul>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">win_package</span><span class="p">:</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="s">&#39;Microsoft</span><span class="nv"> </span><span class="s">.NET</span><span class="nv"> </span><span class="s">Framework</span><span class="nv"> </span><span class="s">4.5.1&#39;</span>
  <span class="nt">win_package</span><span class="p">:</span>
    <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://download.microsoft.com/download/1/6/7/167F0D79-9317-48AE-AEDB-17120579F8E2/NDP451-KB2858728-x86-x64-AllOS-ENU.exe</span>
    <span class="nt">productid</span><span class="p">:</span> <span class="s">&#39;{7DEBE4EB-6B40-3766-BB35-5CBBC385DA37}&#39;</span>
    <span class="nt">arguments</span><span class="p">:</span> <span class="s">&#39;/q</span><span class="nv"> </span><span class="s">/norestart&#39;</span>
    <span class="nt">ensure</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">present</span>
    <span class="c1"># Return code &quot;3010&quot; means that Windows requires a reboot</span>
    <span class="nt">expected_return_code</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">3010</span>
</pre></div>
</div>
<p>[48]</p>
</div>
<div class="section" id="updates">
<h5><a class="toc-backref" href="#id96">Updates</a><a class="headerlink" href="#updates" title="Permalink to this headline">¶</a></h5>
<p>Windows Updates can be managed by Ansible.</p>
<p>All options:</p>
<ul class="simple">
<li><p>category_names = A list of categories to manage updates for. Valid
categories are:</p>
<ul>
<li><p>Application</p></li>
<li><p>Connectors</p></li>
<li><p>CriticalUpdates (default)</p></li>
<li><p>DefinitionUpdates</p></li>
<li><p>DeveloperKits</p></li>
<li><p>FeaturePacks</p></li>
<li><p>Guidance</p></li>
<li><p>SecurityUpdates (default)</p></li>
<li><p>ServicePacks</p></li>
<li><p>Tools</p></li>
<li><p>UpdateRollups (default)</p></li>
<li><p>Updates</p></li>
</ul>
</li>
<li><p>log_path = The path to a custom log file.</p></li>
<li><p>state</p>
<ul>
<li><p>installed = Search for and install updates.</p></li>
<li><p>searched = Only search for updates.</p></li>
</ul>
</li>
</ul>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">win_updates</span><span class="p">:</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">Installing</span> <span class="n">only</span> <span class="n">the</span> <span class="n">critical</span> <span class="n">Windows</span> <span class="n">updates</span>
  <span class="n">win_updates</span><span class="p">:</span>
    <span class="n">category_names</span><span class="p">:</span>
      <span class="o">-</span> <span class="n">CriticalUpdates</span>
    <span class="n">state</span><span class="p">:</span> <span class="n">searched</span>
    <span class="n">log_path</span><span class="p">:</span> <span class="s2">&quot;c:</span><span class="se">\t</span><span class="s2">mp\win_updates_log.txt&quot;</span>
</pre></div>
</div>
<p>[48]</p>
</div>
</div>
<div class="section" id="registry">
<h4><a class="toc-backref" href="#id97">Registry</a><a class="headerlink" href="#registry" title="Permalink to this headline">¶</a></h4>
<p>The registry can be viewed and edited using the
<a class="reference external" href="http://docs.ansible.com/ansible/latest/win_regedit_module.html">win_regedit</a>
and
<a class="reference external" href="http://docs.ansible.com/ansible/latest/win_reg_stat_module.html">win_reg_stat</a>
modules.</p>
</div>
<div class="section" id="scheduled-task">
<h4><a class="toc-backref" href="#id98">Scheduled Task</a><a class="headerlink" href="#scheduled-task" title="Permalink to this headline">¶</a></h4>
<p>Manage scheduled tasks in Windows.</p>
<p>All options:</p>
<ul class="simple">
<li><p>arguments = Arguments that should be supplied to the executable.</p></li>
<li><p>days_of_week = A list of weekdays to run the task.</p></li>
<li><p>description = A useful description for the purpose of the task.</p></li>
<li><p>enabled = Set the task to be enabled or not.</p></li>
<li><p>executable = The command the task should run.</p></li>
<li><p>frequency = The frequency to run the command.</p>
<ul>
<li><p>once</p></li>
<li><p>daily</p></li>
<li><p>weekly</p></li>
</ul>
</li>
<li><p><strong>name</strong> = The name of the task.</p></li>
<li><p>path = The folder to store the task in.</p></li>
<li><p><strong>state</strong></p>
<ul>
<li><p>absent = Delete the task.</p></li>
<li><p>present = Create the task.</p></li>
</ul>
</li>
<li><p>time = The time to run the task.</p></li>
<li><p>user = The user to run the task as.</p></li>
</ul>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">win_scheduled_task</span><span class="p">:</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">win_scheduled_task</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">RestartIIS</span>
  <span class="nt">executable</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">iisreset</span>
  <span class="nt">arguments</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/restart</span>
  <span class="nt">days_of_week</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">saturday</span>
  <span class="nt">time</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">2am</span>
</pre></div>
</div>
<p>[48]</p>
</div>
<div class="section" id="id4">
<h4><a class="toc-backref" href="#id99">Service</a><a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h4>
<p>Manage services on Windows.</p>
<p>All options:</p>
<ul class="simple">
<li><p>dependencies = A list of other services that are dependencies for
this service.</p></li>
<li><p>dependency_action</p>
<ul>
<li><p>add = Append these dependencies to the existing dependencies.</p></li>
<li><p>set = Set this list of dependencies as the only dependencies.</p></li>
<li><p>remove = Remove these dependencies from the service.</p></li>
</ul>
</li>
<li><p>description = A useful description of the service.</p></li>
<li><p>desktop_interact = Allow the LocalSystem user to interact with the
Windows desktop.</p></li>
<li><p>display_name = A user-friendly name for the service.</p></li>
<li><p>force_dependent_services = Changing the state of this service will
change the state of all of the dependencies.</p></li>
<li><p><strong>name</strong> = The actual name of the service.</p></li>
<li><p>password = The password to authenticate with. For the LocalService,
LocalSystem, and NetworkService users, the password has to be an
empty string and not undefined.</p></li>
<li><p>path = The path to the executable for the service.</p></li>
<li><p>start_mode</p>
<ul>
<li><p>auto = Automatically start on boot.</p></li>
<li><p>delayed = Automatically start on boot after all of the “auto”
services have started.</p></li>
<li><p>disabled = Do not allow this service to be run.</p></li>
<li><p>manual = The administrator has to manually start this task.</p></li>
</ul>
</li>
<li><p>state</p>
<ul>
<li><p>absent = Delete the service.</p></li>
<li><p>restarted = Restart the service.</p></li>
<li><p>started = Start the service.</p></li>
<li><p>stopped = Stop the service.</p></li>
</ul>
</li>
<li><p>username = The user to run the service as.</p></li>
</ul>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">win_service</span><span class="p">:</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">win_service</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">CustomService</span>
  <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">C:\Program Files (x86)\myapp\myapp.exe</span>
  <span class="nt">start_mode</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">auto</span>
  <span class="nt">username</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">.\Administrator</span>
  <span class="nt">password</span><span class="p">:</span> <span class="p p-Indicator">{{</span> <span class="nv">admin_pass</span> <span class="p p-Indicator">}}</span>
</pre></div>
</div>
<p>[48]</p>
</div>
<div class="section" id="user">
<h4><a class="toc-backref" href="#id100">User</a><a class="headerlink" href="#user" title="Permalink to this headline">¶</a></h4>
<p>Create, read, update, or delete (CRUD) a Windows user account.</p>
<p>All options:</p>
<ul class="simple">
<li><p>account_disabled = Disable the account. The user can no longer be
used.</p></li>
<li><p>account_locked = Lock the account. The user will no longer have
access to log into their account.</p></li>
<li><p>description = A description of the user’s purpose.</p></li>
<li><p>fullname = The full name of the user.</p></li>
<li><p>groups = A list of groups that the user should be added to or removed
from.</p></li>
<li><p>groups_actions</p>
<ul>
<li><p>replace = Add the user to each of the <code class="docutils literal notranslate"><span class="pre">groups</span></code> and remove them
from all others.</p></li>
<li><p>add = Add the user to each of the <code class="docutils literal notranslate"><span class="pre">groups</span></code>.</p></li>
<li><p>remove = Remove the user from all of the <code class="docutils literal notranslate"><span class="pre">groups</span></code>.</p></li>
</ul>
</li>
<li><p><strong>name</strong> = The name of the user to modify.</p></li>
<li><p>password = The the user’s password.</p></li>
<li><p>password_expired = Force the user’s password to be expired/changed.</p></li>
<li><p>password_never_expires = Determine if the user’s password should
ever expire.</p></li>
<li><p>state</p>
<ul>
<li><p>absent = Delete the user.</p></li>
<li><p>present = Create the user. This is the default option.</p></li>
<li><p>query = Look up information about the user account.</p></li>
</ul>
</li>
<li><p>update_password</p>
<ul>
<li><p>always = Change the password for a user.</p></li>
<li><p>on_create = Only change a password for a user that was just
created.</p></li>
</ul>
</li>
<li><p>user_cannot_change_password = Allow or disallow a user from
modifying their password.</p></li>
</ul>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">win_user</span><span class="p">:</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">win_user</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">name=&quot;default&quot; password=&quot;abc123xyz890&quot; user_cannot_change_password=&quot;yes&quot; groups=[&#39;privileged&#39;, &#39;shares&#39;] state=&quot;present&quot;</span>
</pre></div>
</div>
<p>[48]</p>
</div>
</div>
<div class="section" id="module-development">
<h3><a class="toc-backref" href="#id101">Module Development</a><a class="headerlink" href="#module-development" title="Permalink to this headline">¶</a></h3>
<p>Official Ansible module development documentation can be found <a class="reference external" href="http://docs.ansible.com/ansible/latest/dev_guide/index.html">here</a>.</p>
<p>All of the helper libraries for Ansible can be found in
<a class="reference external" href="https://github.com/ansible/ansible/tree/devel/lib/ansible/module_utils">lib/ansible/modules_utils/</a>.
At the bare minimum, the <a class="reference external" href="https://github.com/ansible/ansible/blob/devel/lib/ansible/module_utils/basic.py">AnsibleModule
class</a>
should be used to create a new module object.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ansible.module_utils.basic</span> <span class="kn">import</span> <span class="n">AnsibleModule</span>
</pre></div>
</div>
<p>That basic syntax and layout of creating a module object looks like
this.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">module</span> <span class="o">=</span> <span class="n">AnsibleModule</span><span class="p">(</span>
    <span class="n">argument_spec</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="o">&lt;</span><span class="n">ARGUMENT_NAME</span><span class="o">&gt;=</span><span class="nb">dict</span><span class="p">(</span><span class="o">&lt;</span><span class="n">OPTIONS</span><span class="o">&gt;</span><span class="p">)</span>
    <span class="p">),</span>
    <span class="o">&lt;</span><span class="n">OTHER_MODULE_OPTIONS</span><span class="o">&gt;</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>These are all of the various settings that can be defined and used
AnsibleModule object.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">AnsibleModule</span></code> <strong>initialization:</strong></p>
<ul>
<li><p>argument_spec = A dictionary of arguments that can be provided by a user using this module. Each argument can have it’s own settings.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;ARGUMENT_NAME&gt;</span></code> = A unique argument name should be given. This
will contain a dictionary of additional settings for this
argument.</p>
<ul>
<li><p>aliases = A list of other names that can be used to reference
this same argument.</p></li>
<li><p>choices = A list of explicit valid choices for this argument.
This is primarily used for documentation.</p></li>
<li><p>required = True or False. If this argument is required for the
module to work.</p></li>
<li><p>default = A default value to provide if the user does not
specify one.</p></li>
<li><p>type = The type of value that should be provided. This can be
any valid Python variable type. Common types include:</p>
<ul>
<li><p>bool = Boolean.</p></li>
<li><p>float = Float, a decimal number.</p></li>
<li><p>int = Integer, a whole number.</p></li>
<li><p>list</p></li>
<li><p>path = A path to a file or directory.</p></li>
<li><p>string</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>required_one_of = A list of arguments where at least one is required for the module to work.</p></li>
<li><p>mutually_exclusive = A list of arguments that cannot be used together.</p></li>
<li><p>supports_check_mode = Specify if this module supports Ansible’s “check mode” where it can check to see if this module will change anything without modifying the system. This sets the <code class="docutils literal notranslate"><span class="pre">module.check_mode</span></code> boolean.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">module</span></code> <strong>common object methods:</strong></p>
<ul>
<li><p>_deprecation = A dictionary of information for a deprecation message.</p>
<ul>
<li><p>msg = The deprecation string.</p></li>
<li><p>version = The version this was / will be deprecated in.</p></li>
</ul>
</li>
<li><p>_warnings = A list of warnings to provide the end user.</p></li>
<li><p>append_to_file = Append text to a file.</p></li>
<li><p>atomic_move = Copy a source file to a destination. The new destination file will use the same file attributes as the original destination file.</p></li>
<li><p>debug = Debug a variable’s value.</p></li>
<li><p>digest_from_file = Return a checksum of a file.</p></li>
<li><p>exit_json = A dictionary of return data when the module finishes successfully.</p>
<ul>
<li><p><em>kwargs</em> = Any variables can be passed to this method and will be returned in the error message. Common variable names and values to pass include:</p>
<ul>
<li><p>changed = A boolean stating if anything has changed.</p></li>
<li><p>changes = A dictionary of items that were changed.</p></li>
<li><p>results = A dictionary of results that should be returned to the end user.</p></li>
</ul>
</li>
</ul>
</li>
<li><p>fail_json = A dictionary for when the module fails.</p>
<ul>
<li><p>msg = A string of a failure message.</p></li>
<li><p><em>kwargs</em> = Any other variables can be passed to this method and will be returned in the error message.</p></li>
</ul>
</li>
<li><p>from_json = Convert JSON data into a dictionary.</p></li>
<li><p>get_bin_path = Find the path of a binary on the managed system.</p></li>
<li><p>jsonify = Convert a variable into JSON format.</p></li>
<li><p>run_command = Run a command on the managed system. This method will return the return code, the standard output, and the standard error from the process. Example:</p></li>
</ul>
</li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cmd</span> <span class="o">=</span> <span class="s2">&quot;echo Hello world&quot;</span>
<span class="n">rc</span><span class="p">,</span> <span class="n">out</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">module</span><span class="o">.</span><span class="n">run_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">module</span></code> <strong>common object variables:</strong></p>
<ul>
<li><p>check_mode = Boolean. Determines if check_mode is supported based  on what <code class="docutils literal notranslate"><span class="pre">module.supports_check_mode</span></code> value is set to.</p></li>
<li><p>params = Dictionary. All of the module argument variables.</p></li>
</ul>
</li>
</ul>
<p>[44]</p>
</div>
</div>
<div class="section" id="id5">
<h2><a class="toc-backref" href="#id102">Roles</a><a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<p>Roles are a collection of related tasks. Playbooks use one or more roles to configure remote hosts. Ansible searches in these locations for roles:</p>
<ul class="simple">
<li><p>/etc/ansible/roles/ (set by <code class="docutils literal notranslate"><span class="pre">roles_path</span></code> in the ansible.cfg)</p></li>
<li><p>/usr/share/ansible/roles/</p></li>
<li><p>~/.ansible/roles/</p></li>
<li><p>roles/</p></li>
</ul>
<div class="section" id="galaxy">
<h3><a class="toc-backref" href="#id103">Galaxy</a><a class="headerlink" href="#galaxy" title="Permalink to this headline">¶</a></h3>
<p>Ansible Galaxy is used to manage playbook and role dependencies. Roles can be downloaded from the <a class="reference external" href="https://galaxy.ansible.com/">Ansible Galaxy community</a> or from source control management (SCM) systems such as GitHub. [25] The latest beta version of Galaxy can be found <a class="reference external" href="https://galaxy-qa.ansible.com/">here</a>. The <code class="docutils literal notranslate"><span class="pre">ansible-galaxy</span></code> command is installed by default with Ansible.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ ansible-galaxy install &lt;USER_NAME&gt;.&lt;ROLE_NAME&gt;
</pre></div>
</div>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ ansible-galaxy install &lt;USER_NAME&gt;.&lt;ROLE_NAME&gt;,&lt;VERSION&gt;
</pre></div>
</div>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ ansible-galaxy install --roles-path &lt;PATH&gt; &lt;USER_NAME&gt;.&lt;ROLE_NAME&gt;
</pre></div>
</div>
<p>For a role to work with Ansible Galaxy, it is required to have the
<code class="docutils literal notranslate"><span class="pre">meta/main.yml</span></code> file. This will define supported Ansible versions and
systems, dependencies on other roles, the license, and other useful
information. [58]</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="nt">galaxy_info</span><span class="p">:</span>
  <span class="nt">author</span><span class="p">:</span>
  <span class="nt">description</span><span class="p">:</span>
  <span class="nt">company</span><span class="p">:</span>
  <span class="nt">license</span><span class="p">:</span>
  <span class="nt">min_ansible_version</span><span class="p">:</span>
  <span class="nt">platforms</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;OS_NAME_1&gt;</span>
      <span class="nt">versions</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">&lt;OS_VERSION&gt;</span>
    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;OS_NAME_2&gt;</span>
      <span class="nt">versions</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">all</span>
  <span class="nt">galaxy_tags</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">&lt;TAG_1&gt;</span>
    <span class="p p-Indicator">-</span> <span class="nt">&lt;TAG_2&gt;</span><span class="p">:</span>
<span class="nt">dependencies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">&lt;USER_NAME&gt;.&lt;ROLE_NAME&gt;</span>
</pre></div>
</div>
<p>At least one tag should be one of the popular Ansible Galaxy categories [71]:</p>
<ul class="simple">
<li><p>cloud</p></li>
<li><p>database</p></li>
<li><p>development</p></li>
<li><p>monitoring</p></li>
<li><p>networking</p></li>
<li><p>packaging</p></li>
<li><p>security</p></li>
<li><p>system</p></li>
<li><p>web</p></li>
</ul>
<p>Below is an example of defining support for all Linux operating systems that are listed in Galaxy:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="nt">platforms</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Alpine</span>
    <span class="nt">versions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">all</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ArchLinux</span>
    <span class="nt">versions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">all</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Debian</span>
    <span class="nt">versions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">all</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Devuan</span>
    <span class="nt">versions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">all</span>
  <span class="c1"># &quot;CentOS&quot; and &quot;RHEL&quot; are not valid names. Use &quot;EL&quot; instead.</span>
  <span class="c1"># https://github.com/ansible/galaxy/issues/2072</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">EL</span>
    <span class="nt">versions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">all</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Fedora</span>
    <span class="nt">versions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">all</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">GenericLinux</span>
    <span class="nt">versions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">all</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">opensuse</span>
    <span class="nt">versions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">all</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">SLES</span>
    <span class="nt">versions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">all</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Ubuntu</span>
    <span class="nt">versions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">all</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Void Linux</span>
    <span class="nt">versions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">all</span>
</pre></div>
</div>
<div class="section" id="dependencies">
<h4><a class="toc-backref" href="#id104">Dependencies</a><a class="headerlink" href="#dependencies" title="Permalink to this headline">¶</a></h4>
<p>Roles can define dependencies to other roles hosted remotely. By
default, the Ansible Galaxy repository is used to pull roles from.
Ansible Galaxy in itself uses GitHub.com as it’s back-end. Dependencies
can be defined in <code class="docutils literal notranslate"><span class="pre">requirements.yml</span></code> or inside the role at
<code class="docutils literal notranslate"><span class="pre">meta/main.yml</span></code>.</p>
<p>Install the dependencies by running:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ ansible-galaxy install -r requirements.yml
</pre></div>
</div>
<ul class="simple">
<li><p>Dependency options:</p>
<ul>
<li><p>src = The role to use. Valid formats are:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;USER_NAME&gt;.&lt;ROLE_PROJECT_NAME&gt;</span></code> = The user and project name
to use from GitHub.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">https://github.com/&lt;USER&gt;/&lt;ROLE_PROJECT_NAME&gt;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git+https://github.com/&lt;USER&gt;/&lt;ROLE_PROJECT_NAME&gt;.git</span></code> =
Explicitly use HTTPS for accessing GitHub.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git+ssh://git&#64;&lt;DOMAIN&gt;/&lt;USER&gt;/&lt;ROLE_PROJECT_NAME&gt;.git</span></code> = Use
SSH for accessing GitHub.</p></li>
</ul>
</li>
<li><p>version = The branch, tag, or commit to use. Default: master.</p></li>
<li><p>name = Provide the role a new custom name.</p></li>
<li><p>scm = The supply chain management (SCM) tool to use. Currently
only Git (git) and Mercurial (hg) are supported. This is useful
for using projects that are not hosted on GitHub.com. Default:
git.</p></li>
</ul>
</li>
</ul>
<p>Dependency syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">dependencies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">src</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;USER_NAME&gt;.&lt;ROLE_NAME&gt;</span>
    <span class="nt">version</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;VERSION&gt;</span>
    <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;NEW_ROLE_NAME&gt;</span>
    <span class="nt">scm</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;SCM&gt;</span>
  <span class="p p-Indicator">-</span> <span class="nt">src</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;USER_NAME2&gt;.&lt;ROLE_NAME2&gt;</span>
</pre></div>
</div>
<p>Dependency example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">src</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://github.com/hux/starkiller</span>
  <span class="nt">version</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">3101u9e243r90adf0a98avn4bmz</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">new_deathstar</span>
<span class="p p-Indicator">-</span> <span class="nt">src</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://example.tld/project</span>
  <span class="nt">scm</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">hg</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">project</span>
</pre></div>
</div>
<p>Git with SSH example (useful for GitLab):</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">src</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">git+ssh://git@&lt;DOMAIN&gt;/&lt;USER&gt;/&lt;PROJECT&gt;.git</span>
  <span class="nt">version</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1.2.0</span>
  <span class="nt">scm</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">git</span>
</pre></div>
</div>
<p>[25]</p>
</div>
<div class="section" id="community-roles">
<h4><a class="toc-backref" href="#id105">Community Roles</a><a class="headerlink" href="#community-roles" title="Permalink to this headline">¶</a></h4>
<p>Unofficial community roles can be used within Playbooks. Most of these
can be found on <a class="reference external" href="https://galaxy.ansible.com/">Ansible Galaxy</a> or
<a class="reference external" href="https://github.com/">GitHub</a>. This section covers some useful roles for system administrators.</p>
<div class="section" id="network-interface">
<h5><a class="toc-backref" href="#id106">Network Interface</a><a class="headerlink" href="#network-interface" title="Permalink to this headline">¶</a></h5>
<p>URL: <a class="reference external" href="https://github.com/MartinVerges/ansible.network_interface">https://github.com/MartinVerges/ansible.network_interface</a></p>
<p>The <code class="docutils literal notranslate"><span class="pre">network_interface</span></code> role was created to help automate the
management of network interfaces on Debian and RHEL based systems. The
most up-to-date and currently maintained fork of the original project is
owned by the <a class="reference external" href="https://github.com/MartinVerges">GitHub user
MartinVerges</a>.</p>
<p>The role can be passed any of these dictionaries to configure the
network devices.</p>
<ul class="simple">
<li><p>network_ether_interfaces = Configure Ethernet devices.</p></li>
<li><p>network_bridge_interfaces = Configure bridge devices.</p></li>
<li><p>network_bond_interfaces = Configure bond devices.</p></li>
<li><p>network_vlan_interfaces = Configure VLAN devices.</p></li>
</ul>
<p>Valid dictionary values:</p>
<ul class="simple">
<li><p>device = Required. This should define the device name to modify or
create.</p></li>
<li><p>bootproto = Required. <code class="docutils literal notranslate"><span class="pre">static</span></code> or <code class="docutils literal notranslate"><span class="pre">dhcp</span></code>.</p></li>
<li><p>address = Required for <code class="docutils literal notranslate"><span class="pre">static</span></code>. IP address.</p></li>
<li><p>netmask = Required for <code class="docutils literal notranslate"><span class="pre">static</span></code>. Subnet mask.</p></li>
<li><p>cidr = For <code class="docutils literal notranslate"><span class="pre">static</span></code>. Optionally use CIDR notation to specify the IP
address and subnet mask.</p></li>
<li><p>gateway = The default gateway for the IP address.</p></li>
<li><p>hwaddress = Use a custom MAC address.</p></li>
<li><p>mtu = Specify the MTU packet size.</p></li>
<li><p>vlan = Set to <code class="docutils literal notranslate"><span class="pre">True</span></code> for creating the VLAN devices.</p></li>
<li><p>bond_ports = Required for bond interfaces. Specify the Ethernet
devices to use for the unified bond.</p></li>
<li><p>bond_mode = For bond interfaces. Define the type of Linux bonding
method.</p></li>
<li><p>bridge_ports = Required for bridge interfaces. Specify the Ethernet
device(s) to use for the bridge.</p></li>
<li><p>dns-nameserver = A Python list of DNS nameservers to use.</p></li>
</ul>
<p>Example:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">eth0</span></code> is configured to use DHCP and has it’s MTU set to 9000.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">eth1</span></code> is added to the new bridge <code class="docutils literal notranslate"><span class="pre">br0</span></code> with the IP address
<code class="docutils literal notranslate"><span class="pre">10.0.0.1</span></code> and the subnet mask of <code class="docutils literal notranslate"><span class="pre">255.255.255.0</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">eth2</span></code> and <code class="docutils literal notranslate"><span class="pre">eth3</span></code> are configured to be in a bond, operating in
mode “6” (adaptive load balancing).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bond0.10</span></code> and <code class="docutils literal notranslate"><span class="pre">bond0.20</span></code> are created as VLAN tagged devices off
of the newly created bond.</p></li>
</ul>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">hosts</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">gluster01</span>
  <span class="nt">roles</span><span class="p">:</span>
   <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ansible.network_interfaces</span>
     <span class="l l-Scalar l-Scalar-Plain">network_ether_interfaces</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">device</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">eth0</span>
        <span class="nt">bootproto</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">dhcp</span>
        <span class="nt">mtu</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">9000</span>
     <span class="nt">network_bridge_interfaces</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">device</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">br0</span>
        <span class="nt">cidr</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">10.0.0.1/24</span>
        <span class="nt">bridge_ports</span><span class="p">:</span> <span class="p p-Indicator">[</span> <span class="s">&quot;eth1&quot;</span> <span class="p p-Indicator">]</span>
     <span class="nt">network_bond_interfaces</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">device</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">bond0</span>
        <span class="nt">bootproto</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">static</span>
        <span class="nt">bond_mode</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">6</span>
        <span class="nt">bond_ports</span><span class="p">:</span> <span class="p p-Indicator">[</span> <span class="s">&quot;eth2&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;eth3&quot;</span> <span class="p p-Indicator">]</span>
     <span class="nt">network_vlan_interfaces</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">device</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">bond0.10</span>
        <span class="nt">vlan</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
        <span class="nt">bootproto</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">static</span>
      <span class="p p-Indicator">-</span> <span class="nt">device</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">bond0.20</span>
        <span class="nt">vlan</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
        <span class="nt">bootproto</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">static</span>
</pre></div>
</div>
<p>[28]</p>
</div>
</div>
</div>
</div>
<div class="section" id="jinja2">
<h2><a class="toc-backref" href="#id107">Jinja2</a><a class="headerlink" href="#jinja2" title="Permalink to this headline">¶</a></h2>
<p>Jinja2 is the Python library used for variable manipulation and
substitution in Ansible. This is also commonly used when creating files
for the “<code class="docutils literal notranslate"><span class="pre">template</span></code>” module.</p>
<div class="section" id="id6">
<h3><a class="toc-backref" href="#id108">Variables</a><a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p>Variables defined in Ansible can be single variables, lists, and
dictionaries. This can be referenced from the template.</p>
<ul>
<li><p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{{</span> <span class="o">&lt;</span><span class="n">VARIABLE</span><span class="o">&gt;</span> <span class="p">}}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{{</span> <span class="o">&lt;</span><span class="n">DICTIONARY</span><span class="o">&gt;.&lt;</span><span class="n">KEY</span><span class="o">&gt;</span> <span class="p">}}</span>
<span class="p">{{</span> <span class="o">&lt;</span><span class="n">DICTIONARY</span><span class="o">&gt;</span><span class="p">[</span><span class="s1">&#39;&lt;KEY&gt;&#39;</span><span class="p">]</span> <span class="p">}}</span>
</pre></div>
</div>
</li>
<li><p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{{</span> <span class="n">certification</span><span class="o">.</span><span class="n">name</span> <span class="p">}}</span>
</pre></div>
</div>
</li>
</ul>
<p>Variables can be defined as a list or nested lists.</p>
<p>Syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;VARIABLE&gt;</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">&lt;ITEM1&gt;</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">&lt;ITEM2&gt;</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">&lt;ITEM3&gt;</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;VARIABLE&gt;</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="s">&#39;&lt;ITEMA&gt;&#39;</span><span class="p p-Indicator">,</span> <span class="s">&#39;&lt;ITEMB&gt;&#39;</span><span class="p p-Indicator">]</span>
  <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="s">&#39;&lt;ITEM1&gt;&#39;</span><span class="p p-Indicator">,</span> <span class="s">&#39;&lt;ITEM2&gt;&#39;</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
<p>Examples:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">colors</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">blue</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">red</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">green</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">cars</span><span class="p">:</span>
 <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="s">&#39;sports&#39;</span><span class="p p-Indicator">,</span> <span class="s">&#39;sedan&#39;</span><span class="p p-Indicator">]</span>
 <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="s">&#39;suv&#39;</span><span class="p p-Indicator">,</span> <span class="s">&#39;pickup&#39;</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
<p>Lists can be called by their array position, starting at “0.” Alternatively they can be called by the subvariable name.</p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{{</span> <span class="n">item</span><span class="o">.</span><span class="mi">0</span> <span class="p">}}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{{</span> <span class="n">item</span><span class="o">.</span><span class="mf">0.</span><span class="o">&lt;</span><span class="n">SUBVARIABLE</span><span class="o">&gt;</span> <span class="p">}}</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">members</span><span class="p">:</span>
 <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Frank</span>
   <span class="nt">contact</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">address</span><span class="p">:</span> <span class="s">&quot;111</span><span class="nv"> </span><span class="s">Puppet</span><span class="nv"> </span><span class="s">Drive&quot;</span>
    <span class="p p-Indicator">-</span> <span class="nt">phone</span><span class="p">:</span> <span class="s">&quot;1111111111&quot;</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">debug</span><span class="p">:</span>
    <span class="nt">msg</span><span class="p">:</span> <span class="s">&quot;Contact</span><span class="nv"> </span><span class="s">{{</span><span class="nv"> </span><span class="s">item.name</span><span class="nv"> </span><span class="s">}}</span><span class="nv"> </span><span class="s">at</span><span class="nv"> </span><span class="s">{{</span><span class="nv"> </span><span class="s">item.contact.phone</span><span class="nv"> </span><span class="s">}}&quot;</span>
  <span class="nt">with_items</span><span class="p">:</span>
   <span class="p p-Indicator">-</span> <span class="p p-Indicator">{{</span> <span class="nv">members</span> <span class="p p-Indicator">}}</span>
</pre></div>
</div>
<p>[3]</p>
<p>Using a variable for a variable name is not possible with Jinja
templates. Only substitution for dictionary keys can be done with format
substitution.</p>
<p>Works:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">find interface facts</span>
  <span class="nt">debug</span><span class="p">:</span>
    <span class="nt">msg</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">hostvars[inventory_hostname][&#39;ansible_%s&#39;</span><span class="nv"> </span><span class="s">|</span><span class="nv"> </span><span class="s">format(item)]</span><span class="nv"> </span><span class="s">}}&quot;</span>
  <span class="nt">with_items</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">ansible_interfaces</span><span class="nv"> </span><span class="s">}}&quot;</span>
</pre></div>
</div>
<p>Does not work:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">find interface facts</span>
  <span class="nt">debug</span><span class="p">:</span>
    <span class="nt">msg</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">ansible_%s</span><span class="nv"> </span><span class="s">|</span><span class="nv"> </span><span class="s">format(item)]</span><span class="nv"> </span><span class="s">}}&quot;</span>
  <span class="nt">with_items</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">ansible_interfaces</span><span class="nv"> </span><span class="s">}}&quot;</span>
</pre></div>
</div>
<p>Variables can be updated and manipulated using Python attributes by using Jinja’s no-print <code class="docutils literal notranslate"><span class="pre">do</span></code> method.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="o">%</span> <span class="n">do</span> <span class="n">example_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;new item&#39;</span><span class="p">)</span> <span class="o">%</span><span class="p">}</span>
</pre></div>
</div>
<p>[20]</p>
</div>
<div class="section" id="filters">
<h3><a class="toc-backref" href="#id109">Filters</a><a class="headerlink" href="#filters" title="Permalink to this headline">¶</a></h3>
<p>In certain situations it is desired to apply filters to alert a variable
or expression. The syntax for running Jinja filters is
<code class="docutils literal notranslate"><span class="pre">&lt;VARIABLE&gt;|&lt;FUNCTION&gt;(&lt;OPTIONAL_PARAMETERS&gt;)</span></code>. Below are some of the
more common functions.</p>
<ul>
<li><p>Convert to a different variable type.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{{</span> <span class="o">&lt;</span><span class="n">VARIABLE</span><span class="o">&gt;|</span><span class="n">string</span> <span class="p">}}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{{</span> <span class="o">&lt;</span><span class="n">VARIABLE</span><span class="o">&gt;|</span><span class="nb">list</span> <span class="p">}}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{{</span> <span class="o">&lt;</span><span class="n">VARIABLE</span><span class="o">&gt;|</span><span class="nb">int</span> <span class="p">}}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{{</span> <span class="o">&lt;</span><span class="n">VARIABLE</span><span class="o">&gt;|</span><span class="nb">float</span> <span class="p">}}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{{</span> <span class="o">&lt;</span><span class="n">VARIABLE</span><span class="o">&gt;|</span><span class="nb">bool</span> <span class="p">}}</span>
</pre></div>
</div>
</li>
<li><p>Convert a list into a string and optionally separate each item by a
specified character.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{{</span> <span class="o">&lt;</span><span class="n">VARIABLE</span><span class="o">&gt;|</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;&lt;CHARACTER&gt;&quot;</span><span class="p">)</span> <span class="p">}}</span>
</pre></div>
</div>
</li>
<li><p>Create a default variable if the variable is undefined.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{{</span> <span class="o">&lt;</span><span class="n">VARIABLE</span><span class="o">&gt;|</span><span class="n">default</span><span class="p">(</span><span class="s2">&quot;&lt;DEFAULT_VALUE&gt;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Convert all characters in a string to lower or upper case.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{{</span> <span class="o">&lt;</span><span class="n">VARIABLE</span><span class="o">&gt;|</span><span class="n">lower</span> <span class="p">}}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{{</span> <span class="o">&lt;</span><span class="n">VARIABLE</span><span class="o">&gt;|</span><span class="n">upper</span> <span class="p">}}</span>
</pre></div>
</div>
</li>
<li><p>Round numbers.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{{</span> <span class="o">&lt;</span><span class="n">VARIABLE</span><span class="o">&gt;|</span><span class="nb">round</span> <span class="p">}}</span>
</pre></div>
</div>
</li>
<li><p>Escape HTML characters.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{{</span> <span class="o">&lt;</span><span class="n">VARIABLE</span><span class="o">&gt;|</span><span class="n">escape</span> <span class="p">}}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="o">%</span> <span class="n">autoescape</span> <span class="n">true</span> <span class="o">%</span><span class="p">}</span>
<span class="o">&lt;</span><span class="n">html</span><span class="o">&gt;</span><span class="n">These</span> <span class="n">HTML</span> <span class="n">tags</span> <span class="n">will</span> <span class="n">be</span>
<span class="n">escaped</span> <span class="ow">and</span> <span class="n">visible</span> <span class="n">via</span> <span class="n">a</span> <span class="n">HTML</span> <span class="n">browser</span><span class="o">.&lt;/</span><span class="n">html</span><span class="o">&gt;</span>
<span class="p">{</span><span class="o">%</span> <span class="n">endautoescape</span> <span class="o">%</span><span class="p">}</span>
</pre></div>
</div>
</li>
<li><p>String substitution.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{{</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%d</span><span class="s2">&quot;</span><span class="o">|</span><span class="nb">format</span><span class="p">(</span><span class="s2">&quot;I am this old:&quot;</span><span class="p">,</span> <span class="mi">99</span><span class="p">)</span> <span class="p">}}</span>
</pre></div>
</div>
</li>
<li><p>Find the first or last value in a list.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{{</span> <span class="o">&lt;</span><span class="n">LIST</span><span class="o">&gt;|</span><span class="n">first</span> <span class="p">}}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{{</span> <span class="o">&lt;</span><span class="n">LIST</span><span class="o">&gt;|</span><span class="n">last</span> <span class="p">}}</span>
</pre></div>
</div>
</li>
<li><p>Find the number of items in a variable.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{{</span> <span class="o">&lt;</span><span class="n">VARIABLE</span><span class="o">&gt;|</span><span class="n">length</span> <span class="p">}}</span>
</pre></div>
</div>
</li>
</ul>
<p>[20]</p>
</div>
<div class="section" id="comments">
<h3><a class="toc-backref" href="#id110">Comments</a><a class="headerlink" href="#comments" title="Permalink to this headline">¶</a></h3>
<p>Comments are template comments that will be removed when once a template
has been generated.</p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="c1"># #}</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="c1"># this is a...</span>
    <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">ip</span> <span class="ow">is</span> <span class="s1">&#39;127.0.0.1&#39;</span> <span class="o">%</span><span class="p">}</span>
        <span class="o">&lt;</span><span class="n">html</span><span class="o">&gt;</span><span class="n">Welcome</span> <span class="n">to</span> <span class="n">localhost</span><span class="o">&lt;/</span><span class="n">html</span><span class="o">&gt;</span>
    <span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
<span class="o">...</span><span class="n">example</span> <span class="n">comment</span> <span class="c1">#}</span>
</pre></div>
</div>
<p>Sometimes it is necessary to escape blocks of code, especially when
dealing with JSON or other similar formats. Jinja will not render
anything that is escaped.</p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{{</span> <span class="s1">&#39;&#39;</span> <span class="p">}}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="o">%</span> <span class="n">raw</span> <span class="o">%</span><span class="p">}</span>
<span class="p">{</span><span class="o">%</span> <span class="n">endraw</span> <span class="o">%</span><span class="p">}</span>
</pre></div>
</div>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{{</span> <span class="s1">&#39;hello world&#39;</span> <span class="p">}}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="o">%</span> <span class="n">raw</span> <span class="o">%</span><span class="p">}</span>
    <span class="p">{{</span> <span class="n">jinja</span><span class="o">.</span><span class="n">wont</span><span class="o">.</span><span class="n">replace</span><span class="o">.</span><span class="n">this</span> <span class="p">}}</span>
<span class="p">{</span><span class="o">%</span> <span class="n">endraw</span> <span class="o">%</span><span class="p">}</span>
</pre></div>
</div>
<p>[20]</p>
</div>
<div class="section" id="blocks">
<h3><a class="toc-backref" href="#id111">Blocks</a><a class="headerlink" href="#blocks" title="Permalink to this headline">¶</a></h3>
<p>Templates can extend other templates by replacing “block” elements. At
least two files are required. The first file creates a place holder
block. The second file contains the content that will fill in that place
holder.</p>
<p>Syntax (file 1):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="o">%</span> <span class="n">block</span> <span class="o">&lt;</span><span class="n">DESCRIPTIVE_NAME</span><span class="o">&gt;</span> <span class="o">%</span><span class="p">}{</span><span class="o">%</span> <span class="n">endblock</span> <span class="o">%</span><span class="p">}</span>
</pre></div>
</div>
<p>Syntax (file 2):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="o">%</span> <span class="n">extends</span> <span class="s2">&quot;&lt;FILE1&gt;&quot;</span> <span class="o">%</span><span class="p">}</span>
<span class="p">{</span><span class="o">%</span> <span class="n">block</span> <span class="o">&lt;</span><span class="n">DESCRIPTIVE_NAME</span><span class="o">&gt;</span> <span class="o">%</span><span class="p">}</span>
<span class="p">{</span><span class="o">%</span> <span class="n">endblock</span> <span class="o">%</span><span class="p">}</span>
</pre></div>
</div>
<p>Example (file 1):</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>{% block header %}{% endblock %}<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>{% block body %}{% endblock %}<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>Example (file 2):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>{% extends &quot;index.html&quot; %}
{% block header %}
Hello World
{% endblock %}
{% block body %}
Welcome to the Hello World page!
{% endblock %}
</pre></div>
</div>
<p>[20]</p>
</div>
<div class="section" id="id7">
<h3><a class="toc-backref" href="#id112">Loops</a><a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<p>Loops can use standard comparison and/or logic operators.</p>
<p>Comparison Operators:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">==</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">!=</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&gt;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&gt;=</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">=&lt;</span></code></p></li>
</ul>
<p>Logic Operators:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">and</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">or</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">not</span></code></p></li>
</ul>
<p>“For” loops can be used to loop through a list or dictionary.</p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="o">&lt;</span><span class="n">VALUE</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="p">{{</span> <span class="o">&lt;</span><span class="n">LIST_VARIABLE</span><span class="o">&gt;</span> <span class="p">}}</span> <span class="o">%</span><span class="p">}</span>
<span class="p">{</span><span class="o">%</span> <span class="n">endfor</span> <span class="o">%</span><span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="o">&lt;</span><span class="n">KEY</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">VALUE</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="p">{{</span> <span class="o">&lt;</span><span class="n">DICTIONARY_VARIABLES</span><span class="o">&gt;</span> <span class="p">}}</span> <span class="o">%</span><span class="p">}</span>
<span class="p">{</span><span class="o">%</span> <span class="n">endfor</span> <span class="o">%</span><span class="p">}</span>
</pre></div>
</div>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># /etc/hosts</span>
<span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="n">host</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">[</span><span class="s1">&#39;ceph&#39;</span><span class="p">]</span> <span class="o">%</span><span class="p">}</span>
<span class="n">hostvars</span><span class="p">[</span><span class="n">host</span><span class="p">][</span><span class="s1">&#39;private_ip&#39;</span><span class="p">]</span> <span class="n">hostvars</span><span class="p">[</span><span class="n">host</span><span class="p">][</span><span class="s1">&#39;ansible_hostname&#39;</span><span class="p">]</span>
<span class="p">{</span><span class="o">%</span> <span class="n">endfor</span> <span class="o">%</span><span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="o">%</span><span class="p">}</span>
<span class="p">[{{</span> <span class="n">groups</span><span class="p">[</span><span class="s1">&#39;db&#39;</span><span class="p">][{{</span> <span class="n">count</span> <span class="p">}}]</span> <span class="p">}}]</span>
<span class="nb">type</span><span class="o">=</span><span class="n">server</span>
<span class="n">priority</span><span class="o">=</span><span class="p">{{</span> <span class="n">count</span> <span class="p">}}</span>
<span class="p">{</span><span class="o">%</span> <span class="n">endfor</span> <span class="o">%</span><span class="p">}</span>
</pre></div>
</div>
<p>“For” loops have special variables that can be referenced relating to
the index that the loop is on.</p>
<ul class="simple">
<li><p>loop.index = The current index of the loop, starting at 1.</p></li>
<li><p>loop.index0 = The current index of the loop, starting at 0.</p></li>
<li><p>loop.revindex = The same as “loop.index” but in reverse order.</p></li>
<li><p>loop.revindex = The same as “loop.index0” but in reverse order.</p></li>
<li><p>loop.first = This will be True if it is the first index.</p></li>
<li><p>loop.last = This will be True if is it the last index.</p></li>
</ul>
<p>“If” statements can be run if a certain condition is met.</p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="o">&lt;</span><span class="n">VALUE</span><span class="o">&gt;</span> <span class="o">%</span><span class="p">}</span>
<span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="o">&lt;</span><span class="n">VALUE_1</span><span class="o">&gt;</span> <span class="o">%</span><span class="p">}</span>
<span class="p">{</span><span class="o">%</span> <span class="k">elif</span> <span class="o">&lt;</span><span class="n">VALUE_2</span><span class="o">&gt;</span> <span class="o">%</span><span class="p">}</span>
<span class="p">{</span><span class="o">%</span> <span class="k">else</span> <span class="o">%</span><span class="p">}</span>
<span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="p">{{</span> <span class="n">taco_day</span> <span class="p">}}</span> <span class="o">==</span> <span class="s2">&quot;Tuesday&quot;</span> <span class="o">%</span><span class="p">}</span>
    <span class="n">Taco</span> <span class="n">day</span> <span class="ow">is</span> <span class="n">on</span> <span class="n">Tuesday</span><span class="o">.</span>
<span class="p">{</span><span class="o">%</span> <span class="k">else</span> <span class="o">%</span><span class="p">}</span>
    <span class="n">Taco</span> <span class="n">day</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">on</span> <span class="n">a</span> <span class="n">Tuesday</span><span class="o">.</span>
<span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
</pre></div>
</div>
<p>[20]</p>
</div>
</div>
<div class="section" id="plugins">
<h2><a class="toc-backref" href="#id113">Plugins</a><a class="headerlink" href="#plugins" title="Permalink to this headline">¶</a></h2>
<p>Ansible supports a variety of custom plugins that can be used.</p>
<ul class="simple">
<li><p>Action = Ran before a module is executed.</p></li>
<li><p>Cache = Temporarily store facts in a specific location.</p></li>
<li><p>Callback = Run custom functions based on the current events of a playbook.</p></li>
<li><p>Connection = Manage connections to remote hosts and are used for every task.</p></li>
<li><p>Filter = Data manipulation for Jinja content.</p></li>
<li><p>Lookup = Specify how to lookup specific information using a custom Jinja function.</p></li>
<li><p>Shell = The format that commands should use for different remote shells.</p></li>
<li><p>Strategy = Handle how tasks are executed on remote hosts and in what order.</p></li>
<li><p>Vars = Add in new hosts and variables. In most cases, dynamic inventory scripts are preferred over plugins.</p></li>
</ul>
<p>[41]</p>
</div>
<div class="section" id="containers">
<h2><a class="toc-backref" href="#id114">Containers</a><a class="headerlink" href="#containers" title="Permalink to this headline">¶</a></h2>
<p>Containers can be manually built by using special container connections provided by Ansible.</p>
<p>This example creates a container with Buildah, adds it to the inventory, and then runs another play to execute roles on it.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="p p-Indicator">-</span> <span class="nt">hosts</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">localhost</span>
  <span class="nt">tasks</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Create the container</span>
      <span class="nt">command</span><span class="p">:</span> <span class="s">&quot;buildah</span><span class="nv"> </span><span class="s">from</span><span class="nv"> </span><span class="s">--name</span><span class="nv"> </span><span class="s">{{</span><span class="nv"> </span><span class="s">container_name</span><span class="nv"> </span><span class="s">}}</span><span class="nv"> </span><span class="s">{{</span><span class="nv"> </span><span class="s">container_os</span><span class="nv"> </span><span class="s">}}:{{</span><span class="nv"> </span><span class="s">container_version_tag</span><span class="nv"> </span><span class="s">}}&quot;</span>

    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Add the container to the inventory</span>
      <span class="nt">add_host</span><span class="p">:</span>
        <span class="nt">hostname</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">container_name</span><span class="nv"> </span><span class="s">}}&quot;</span>
        <span class="nt">ansible_connection</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">buildah</span>

<span class="p p-Indicator">-</span> <span class="nt">hosts</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">container_name</span><span class="nv"> </span><span class="s">}}&quot;</span>
  <span class="nt">roles</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">role_name</span><span class="nv"> </span><span class="s">}}&quot;</span>
</pre></div>
</div>
<p>This example for Ansible &gt;= 2.7 shows how the new “apply” keyword can be used to delegate roles to specific hosts.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="p p-Indicator">-</span> <span class="nt">hosts</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">localhost</span>
  <span class="nt">tasks</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Create the container</span>
      <span class="nt">command</span><span class="p">:</span> <span class="s">&quot;buildah</span><span class="nv"> </span><span class="s">from</span><span class="nv"> </span><span class="s">--name</span><span class="nv"> </span><span class="s">{{</span><span class="nv"> </span><span class="s">container_name</span><span class="nv"> </span><span class="s">}}</span><span class="nv"> </span><span class="s">{{</span><span class="nv"> </span><span class="s">container_os</span><span class="nv"> </span><span class="s">}}:{{</span><span class="nv"> </span><span class="s">container_version_tag</span><span class="nv"> </span><span class="s">}}&quot;</span>

    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Add the container to the inventory</span>
      <span class="nt">add_host</span><span class="p">:</span>
        <span class="nt">hostname</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">container_name</span><span class="nv"> </span><span class="s">}}&quot;</span>
        <span class="nt">ansible_connection</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">buildah</span>

    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Run a role in the container</span>
      <span class="nt">include_role</span><span class="p">:</span>
        <span class="nt">name</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">role_name</span><span class="nv"> </span><span class="s">}}&quot;</span>
        <span class="nt">apply</span><span class="p">:</span>
          <span class="nt">delegate_to</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">container_name</span><span class="nv"> </span><span class="s">}}&quot;</span>
</pre></div>
</div>
<p>There is also a community project called <a class="reference external" href="https://github.com/TomasTomecek/ansible-bender">ansible-bender</a> that seeks to be a spiritual successor to the now deprecated Ansible-Container project. It is used to build containers using Ansible playbooks. [77]</p>
</div>
<div class="section" id="best-practices">
<h2><a class="toc-backref" href="#id115">Best Practices</a><a class="headerlink" href="#best-practices" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Store Ansible content in a source control manager (SCM) such as git. It is important to keep a history of changes for infrastructure-as-code content.</p></li>
<li><p>Formatting:</p>
<ul>
<li><p>Use YAML formatting. Do not use single-line tasks.</p></li>
<li><p>Indent YAML dictionaries/lists by two spaces under the key.</p></li>
<li><p>Leave one newline between each task.</p></li>
</ul>
</li>
<li><p>Inventory:</p>
<ul>
<li><p>Hosts and groups in an inventory should have a descriptive name.</p></li>
</ul>
</li>
<li><p>Tasks:</p>
<ul>
<li><p>Every task should have a <code class="docutils literal notranslate"><span class="pre">name:</span></code> to declaratively describe what it does.</p></li>
<li><p>Define the expected <code class="docutils literal notranslate"><span class="pre">state:</span></code> of a task (if applicable).</p></li>
<li><p>Avoid <code class="docutils literal notranslate"><span class="pre">command</span></code>, <code class="docutils literal notranslate"><span class="pre">raw</span></code>, and <code class="docutils literal notranslate"><span class="pre">shell</span></code> modules. If that is not possible, add additional tasks to do idempotency checks.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">handlers</span></code> to restart system services.</p></li>
<li><p>Set a <code class="docutils literal notranslate"><span class="pre">tag:</span></code> for tasks to showcase it has certain attributes such as <code class="docutils literal notranslate"><span class="pre">become:</span></code> set.</p></li>
</ul>
</li>
</ul>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Check the Apache configuration syntax</span>
  <span class="nt">command</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">httpd -t</span>
  <span class="nt">changed_when</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">False</span>
  <span class="nt">tags</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">become</span>
  <span class="nt">become</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
  <span class="nt">become_user</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">apache</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Roles:</p>
<ul>
<li><p>Roles should be designed to be re-usable and re-distributable for other projects.</p></li>
<li><p>Fill out the details in the <code class="docutils literal notranslate"><span class="pre">requirements.yml</span></code> file for every role.</p></li>
<li><p>Add Molecule tests for each scenario supported by a role.</p></li>
</ul>
</li>
<li><p>Variables:</p>
<ul>
<li><p>Define variables that can be overridden in the <code class="docutils literal notranslate"><span class="pre">defaults</span></code> folder in a role. Define variables that should never be changed in the <code class="docutils literal notranslate"><span class="pre">vars</span></code> folder instead.</p></li>
<li><p>Prefix role-specific variable names with the role name.</p></li>
</ul>
</li>
<li><p>Files:</p>
<ul>
<li><p>Place static files in the <code class="docutils literal notranslate"><span class="pre">files</span></code> directory in a role. Only Jinja templates should exist in the <code class="docutils literal notranslate"><span class="pre">templates</span></code> directory.</p></li>
<li><p>Jinja templates should have the <code class="docutils literal notranslate"><span class="pre">.j2</span></code> file extension name.</p></li>
<li><p>Jinja templates should contain <code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">ansible_managed</span> <span class="pre">|</span> <span class="pre">comment</span> <span class="pre">}}</span></code> at the top of the file.</p></li>
</ul>
</li>
</ul>
<p>[5][74]</p>
</div>
<div class="section" id="python-api">
<h2><a class="toc-backref" href="#id116">Python API</a><a class="headerlink" href="#python-api" title="Permalink to this headline">¶</a></h2>
<p>Ansible is written in Python so it can be used programmatically to run Playbooks. Using the Ansible Python library directly is not recommended. It does not provide a thread-safe interface and is subject to change depending on the needs of the actual Ansible utilities. Instead, consider using <a class="reference external" href="https://ansible-runner.readthedocs.io/en/latest/">ansible-runner</a> or a RESTful API from a dashboard such as the official AWX project. [32]</p>
</div>
<div class="section" id="testing">
<h2><a class="toc-backref" href="#id117">Testing</a><a class="headerlink" href="#testing" title="Permalink to this headline">¶</a></h2>
<div class="section" id="ansible-lint">
<h3><a class="toc-backref" href="#id118">Ansible Lint</a><a class="headerlink" href="#ansible-lint" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">ansible-lint</span></code> utility is used to check for best practices in Ansible playbooks and roles. If a certain rule was triggered and is deemed to be a false-positive then the affected line can have the comment <code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">noqa</span> <span class="pre">&lt;ANSIBLE_LINT_RULE_ID&gt;</span></code> appended to it to skip checking that rule. Alternatively, add the tag <code class="docutils literal notranslate"><span class="pre">skip_ansible_lint</span></code> to the task to skip all lint checks on that particular task.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">tags</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">skip_ansible_lint</span>
</pre></div>
</div>
<p>[69]</p>
</div>
<div class="section" id="molecule">
<h3><a class="toc-backref" href="#id119">Molecule</a><a class="headerlink" href="#molecule" title="Permalink to this headline">¶</a></h3>
<p>Molecule is a testing framework designed specifically for Ansible roles. It assists with running validations such as lint and syntax checks. Users can optionally configure custom tests via an Ansible playbook and/or Python with the <code class="docutils literal notranslate"><span class="pre">testinfra</span></code> library. It was originally created by Cisco employees and, as of October 2018, it is now maintained by Red Hat. Molecule 2.20 was the first release of Molecule by Red Hat. [81]</p>
<p>Checks done by <code class="docutils literal notranslate"><span class="pre">molecule</span> <span class="pre">test</span></code> (in order of execution):</p>
<ul class="simple">
<li><p>lint = Run <code class="docutils literal notranslate"><span class="pre">ansible-lint</span></code> and <code class="docutils literal notranslate"><span class="pre">yamllint</span></code> on the role.</p></li>
<li><p>destroy = Destroy any existing virtual machines using the <code class="docutils literal notranslate"><span class="pre">destroy.yml</span></code> playbook.</p></li>
<li><p>dependency = Install any necessary role dependencies from Ansible Galaxy.</p></li>
<li><p>syntax = Check the YAML syntax.</p></li>
<li><p>create = Create the virtual machine using the <code class="docutils literal notranslate"><span class="pre">create.yml</span></code> playbook.</p></li>
<li><p>prepare = Run post-provisioning tasks to setup the virtual machine before testing the role using the <code class="docutils literal notranslate"><span class="pre">prepare.yml</span></code> playbook.</p></li>
<li><p>converge = Test the role by running the <code class="docutils literal notranslate"><span class="pre">molecule/default/playbook.yml</span></code> playbook.</p></li>
<li><p>idempotence = Verify that tasks are only changed when they need to be.</p></li>
<li><p>side_effect = Run an optional side_effect playbook to test out more complex scenarios relating to this role (example, cluster recovery).</p></li>
<li><p>verify = Run the verify test scripts from the <code class="docutils literal notranslate"><span class="pre">molecule/default/tests/</span></code> directory.</p></li>
<li><p>destroy = Destroy the virtual machine.</p></li>
</ul>
<p>Supported virtualization drivers and their provisioners:</p>
<ul class="simple">
<li><p>azure</p></li>
<li><p>delegated = Use a custom driver. The default for this is to run <code class="docutils literal notranslate"><span class="pre">create.yaml</span></code> and <code class="docutils literal notranslate"><span class="pre">destroy.yaml</span></code> for provisioning the test environment unless <code class="docutils literal notranslate"><span class="pre">[driver][options]managed=False</span></code> is configured.</p></li>
<li><p>docker</p></li>
<li><p>ec2</p></li>
<li><p>gce</p></li>
<li><p>lxc</p></li>
<li><p>lxd</p></li>
<li><p>openstack</p></li>
<li><p>vagrant</p>
<ul>
<li><p>libvirt</p></li>
<li><p>parallels (macOS only)</p></li>
<li><p>virtualbox (default)</p></li>
<li><p>vmware</p></li>
</ul>
</li>
</ul>
<p>Create a new role with Molecule and a specific virtualization driver. This will create the directory <code class="docutils literal notranslate"><span class="pre">&lt;ROLE&gt;/molecule/default/</span></code> that will store all of the Molecule settings and playbooks used for testing.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ molecule init role --role-name &lt;ROLE&gt; --driver-name &lt;DRIVER&gt;
</pre></div>
</div>
<p>Molecule can be configured by the <code class="docutils literal notranslate"><span class="pre">molecule.yml</span></code> file. By default, it will use the Vagrant driver with VirtualBox as the hypervisor software for testing.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="nt">driver</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;DRIVER&gt;</span>
  <span class="nt">provider</span><span class="p">:</span>
    <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;PROVIDER&gt;</span>
</pre></div>
</div>
<p>Specific tests handled by the <code class="docutils literal notranslate"><span class="pre">molecule</span> <span class="pre">test</span></code> command can be turned off in the <code class="docutils literal notranslate"><span class="pre">molecule.yml</span></code> file.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="nt">dependency</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">galaxy</span>
  <span class="nt">enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">False</span>
<span class="nt">lint</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">yamllint</span>
  <span class="nt">enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">False</span>
<span class="nt">provisioner</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ansible</span>
  <span class="nt">enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">False</span>
<span class="nt">verifier</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">testinfra</span>
  <span class="nt">enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">False</span>
</pre></div>
</div>
<p>The order of tests can be changed using the <code class="docutils literal notranslate"><span class="pre">scenario.&lt;STAGE&gt;_sequence</span></code> lists. Parts of the sequence can also be disabled by being commented out.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="nt">scenario</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">default</span>
  <span class="nt">create_sequence</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">create</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">prepare</span>
  <span class="nt">check_sequence</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">destroy</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">dependency</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">create</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">prepare</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">converge</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">check</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">destroy</span>
  <span class="nt">converge_sequence</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">dependency</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">create</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">prepare</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">converge</span>
  <span class="nt">destroy_sequence</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">destroy</span>
  <span class="nt">test_sequence</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">lint</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">destroy</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">dependency</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">syntax</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">create</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">prepare</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">converge</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">idempotence</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">side_effect</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">verify</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">destroy</span>
</pre></div>
</div>
<p>docker containers will require a “command” is provided to start and keep it running. By default, an infinite while loop with a sleep command is executed using Bash for maximum portability. [72]</p>
<p>Example command:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">platforms</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">centos_7</span>
    <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">centos:7</span>
    <span class="nt">command</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">bash -c &#39;while true; do sleep 1; done&#39;</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ubuntu_1804</span>
    <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ubuntu:18.04</span>
    <span class="nt">command</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">sleep infinity</span>
</pre></div>
</div>
<p>The main playbook test is executed with the <code class="docutils literal notranslate"><span class="pre">molecule</span> <span class="pre">converge</span></code> command. It will run through these steps in order:</p>
<ul class="simple">
<li><p>dependency</p></li>
<li><p>create</p></li>
<li><p>prepare</p></li>
<li><p>converge</p></li>
</ul>
<p>Additional playbook arguments can be provided by stopping the current arguments for Molecule with <code class="docutils literal notranslate"><span class="pre">--</span></code>.</p>
<p>Example:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ molecule converge -- -vvv --become --become-user<span class="o">=</span>root
</pre></div>
</div>
<p>Specific tasks in a role can be disabled by setting the “molecule-notest” or “notest” tag.</p>
<p>During the creation and deletion of the infrastructure to test with, Molecule configures the Ansible playbook to disable logging to hide sensitive information about the environment. If any issues are encounteredin the provisioning stage, use one of these methods to re-enable logging. Any of these methods will essentially set the parameter <cite>no_log: False</cite> for all create and destroy tasks.</p>
<ul>
<li><p>Use the <code class="docutils literal notranslate"><span class="pre">molecule</span> <span class="pre">--debug</span></code> argument.</p></li>
<li><p>Export the environment variable <code class="docutils literal notranslate"><span class="pre">MOLECULE_DEBUG=True</span></code>.</p></li>
<li><p>Configure the provisioner in <code class="docutils literal notranslate"><span class="pre">molecule.yml</span></code> to have debugging enabled.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">provisioner</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ansible</span>
  <span class="nt">debug</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
</pre></div>
</div>
</li>
</ul>
<p>Additional Ansible arguments can be defined in the configuration or via the command line.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">provisioner</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ansible</span>
  <span class="nt">ansible_args</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">--skip-tags molecule_skip</span>
</pre></div>
</div>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ molecule converge -- --skip-tags molecule_skip
</pre></div>
</div>
<p>The virtual environment instance can be accessed with <code class="docutils literal notranslate"><span class="pre">molecule</span> <span class="pre">login</span></code>. If more than one environment is created, use the <code class="docutils literal notranslate"><span class="pre">--host</span></code> argument to specify which one to enter.</p>
<p>Example:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ molecule login --host &lt;HOST2&gt;
</pre></div>
</div>
<p>Delete instances with <code class="docutils literal notranslate"><span class="pre">molecule</span> <span class="pre">destroy</span></code>.</p>
<p>[70]</p>
</div>
</div>
<div class="section" id="dashboards">
<h2><a class="toc-backref" href="#id120">Dashboards</a><a class="headerlink" href="#dashboards" title="Permalink to this headline">¶</a></h2>
<p>Various dashboards are available that provide a graphical user interface
(GUI) and usually an API to help automate Ansible deployments. These can
be used for user access control lists (ACLs), scheduling automated
tasks, and having a visual representation of Ansible’s deployment
statistics.</p>
<div class="section" id="ansible-tower-3">
<h3><a class="toc-backref" href="#id121">Ansible Tower 3</a><a class="headerlink" href="#ansible-tower-3" title="Permalink to this headline">¶</a></h3>
<p>Ansible Tower is the official dashboard maintained by Red Hat. The program is built using Python and uses RabbitMQ for clustering and PostgreSQL for storing it’s data. PostgreSQL is used for the database back-end because it is one of the few relational databases that support storing and accessing JSON formatted data. [52] Tower 3.3.0 was the first release to support installing services as docker containers on OpenShift. [75]</p>
<p><strong>Requirements and Support</strong></p>
<ul class="simple">
<li><p>3.6</p>
<ul>
<li><p>EL 8 or EL &gt;= 7.4</p></li>
<li><p>PostgreSQL 10</p></li>
<li><p>Ansible &gt;= 2.2 (EL 7)</p></li>
<li><p>Ansible &gt;= 2.8 (EL 8)</p></li>
<li><p>Release date: 2019-11-14</p></li>
<li><p>EOL: 2021-05-14</p></li>
</ul>
</li>
<li><p>3.5</p>
<ul>
<li><p>EL 8, EL &gt;= 7.4, or Ubuntu 16.04 (Ubuntu is now deprecated)</p></li>
<li><p>PostgreSQL 9.6</p></li>
<li><p>Ansible &gt;= 2.2 (EL 7 or Ubuntu)</p></li>
<li><p>Ansible &gt;= 2.8 (EL 8)</p></li>
<li><p>Release date: 2019-05-29</p></li>
<li><p>EOL: 2020-11-29</p></li>
</ul>
</li>
<li><p>3.4</p>
<ul>
<li><p>EL &gt;= 7.4 or Ubuntu 16.04</p></li>
<li><p>PostgreSQL 9.6</p></li>
<li><p>Ansible &gt;= 2.2</p></li>
<li><p>Release date: 2019-01-09</p></li>
<li><p>EOL: 2020-07-09</p></li>
</ul>
</li>
<li><p>3.3</p>
<ul>
<li><p>EL &gt;= 7.4 or Ubuntu 16.04</p></li>
<li><p>PostgreSQL 9.6</p></li>
<li><p>Ansible &gt;= 2.2</p></li>
<li><p>Release date: 2018-09-12</p></li>
<li><p>EOL: 2020-03-12</p></li>
</ul>
</li>
<li><p>3.2</p>
<ul>
<li><p>EL &gt;= 7.2, Ubuntu 16.04, or Ubuntu 14.04</p></li>
<li><p>Ansible &gt;= 2.2</p>
<ul>
<li><p>Access to some inventory sources, including Azure, requires &gt;= 2.4</p></li>
</ul>
</li>
<li><p>PostgreSQL 9.6</p></li>
<li><p>Release date: 2017-10-02</p></li>
<li><p>EOL: 2019-04-02</p></li>
</ul>
</li>
</ul>
<p><strong>Support Changes</strong></p>
<ul class="simple">
<li><p>3.6.0 dropped support for Ubuntu.</p></li>
<li><p>3.1.0 dropped support for EL 6.</p></li>
</ul>
<p>[35][66]</p>
<p>Tower can be downloaded from <a class="reference external" href="http://releases.ansible.com/ansible-tower/">http://releases.ansible.com/ansible-tower/</a>. The “setup” package only contains Ansible Tower. The “setup-bundle” has all of the dependencies for an offline installation on RHEL servers. At least a free trial of Tower can be used to manage up to 10 servers for testing purposes only. A license can be bought from Red Hat to use Tower for managing more servers and to provide customer support. A license can be obtained from the <a class="reference external" href="https://www.ansible.com/license">Ansible Tower license page</a>.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ curl -O http://releases.ansible.com/ansible-tower/setup/ansible-tower-setup-latest.tar.gz
$ tar -x -z -v -f ansible-tower-setup-latest.tar.gz
$ <span class="nb">cd</span> ./ansible-tower-setup-3.*/
</pre></div>
</div>
<p>At a bare minimum for 1 node Ansible Tower installation, the passwords to use for the various services need to be defined in the <code class="docutils literal notranslate"><span class="pre">inventory</span></code> file or a separate variables file that is encrypted using Ansible Vault.</p>
<ul class="simple">
<li><p>admin_password</p></li>
<li><p>pg_password</p></li>
<li><p>rabbitmq_password</p></li>
</ul>
<p>Ansible Tower supports clustering. This requires that the PostgreSQL service is configured on a dedicated server that is not running Ansible Tower. The Playbook that installs Tower can install PostgreSQL or use credentials to an existing server. The PostgreSQL user for Ansible Tower also requires <code class="docutils literal notranslate"><span class="pre">CREATEDB</span></code> access during the initial installation to setup the necessary database and tables.</p>
<ul class="simple">
<li><p>Installing PostgreSQL:</p></li>
</ul>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[tower]</span>
<span class="na">&lt;TOWER1&gt;</span>
<span class="na">&lt;TOWER2&gt;</span>
<span class="na">&lt;TOWER3&gt;</span>

<span class="k">[database]</span>
<span class="na">&lt;POSTGRESQL1&gt;</span>

<span class="k">[all:vars]</span>
<span class="c1"># PostgreSQL</span>
<span class="na">pg_database</span><span class="o">=</span><span class="s">&quot;awx&quot;</span>
<span class="na">pg_username</span><span class="o">=</span><span class="s">&quot;awx&quot;</span>
<span class="na">pg_password</span><span class="o">=</span><span class="s">&quot;&lt;PASSWORD&gt;&quot;</span>
<span class="c1"># RabbitMQ</span>
<span class="na">rabbitmq_port</span><span class="o">=</span><span class="s">5672</span>
<span class="na">rabbitmq_vhost</span><span class="o">=</span><span class="s">&quot;tower&quot;</span>
<span class="na">rabbitmq_username</span><span class="o">=</span><span class="s">&quot;tower&quot;</span>
<span class="na">rabbitmq_password</span><span class="o">=</span><span class="s">&quot;&lt;PASSWORD&gt;&quot;</span>
<span class="na">rabbitmq_cookie</span><span class="o">=</span><span class="s">&quot;&lt;RANDOM_STRING&gt;&quot;</span>
<span class="c1">## Set to &quot;True&quot; if fully qualified domain names (FQDNs)</span>
<span class="c1">## are used in the inventory file. Otherwise this should</span>
<span class="c1">## be &quot;False&quot;</span>
<span class="na">rabbitmq_use_long_name</span><span class="o">=</span><span class="s">&quot;True&quot;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Using an existing PostgreSQL server:</p></li>
</ul>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[tower]</span>
<span class="na">&lt;TOWER1&gt;</span>
<span class="na">&lt;TOWER2&gt;</span>
<span class="na">&lt;TOWER3&gt;</span>

<span class="k">[all:vars]</span>
<span class="c1"># PostgreSQL</span>
<span class="na">pg_host</span><span class="o">=</span><span class="s">&quot;&lt;HOST_OR_IP&gt;&quot;</span>
<span class="na">pg_port</span><span class="o">=</span><span class="s">5432</span>
<span class="na">pg_database</span><span class="o">=</span><span class="s">&quot;awx&quot;</span>
<span class="na">pg_username</span><span class="o">=</span><span class="s">&quot;awx&quot;</span>
<span class="na">pg_password</span><span class="o">=</span><span class="s">&quot;&lt;PASSWORD&gt;&quot;</span>
<span class="c1"># RabbitMQ</span>
<span class="na">rabbitmq_port</span><span class="o">=</span><span class="s">5672</span>
<span class="na">rabbitmq_vhost</span><span class="o">=</span><span class="s">&quot;tower&quot;</span>
<span class="na">rabbitmq_username</span><span class="o">=</span><span class="s">&quot;tower&quot;</span>
<span class="na">rabbitmq_password</span><span class="o">=</span><span class="s">&quot;&lt;PASSWORD&gt;&quot;</span>
<span class="na">rabbitmq_cookie</span><span class="o">=</span><span class="s">&quot;&lt;RANDOM_STRING&gt;&quot;</span>
<span class="c1">## Set to &quot;True&quot; if fully qualified domain names (FQDNs)</span>
<span class="c1">## are used in the inventory file. Otherwise this should</span>
<span class="c1">## be &quot;False&quot;</span>
<span class="na">rabbitmq_use_long_name</span><span class="o">=</span><span class="s">&quot;True&quot;</span>
</pre></div>
</div>
<p>Then install Ansible Tower using the setup shell script. This will run an Ansible Playbook to install Tower.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ ./setup.sh
</pre></div>
</div>
<p>When the installation is complete, Ansible Tower can be accessed by a web browser. If no SSL certificate was defined, then a self-signed SSL certificate will be used to encrypt the connection. The default username is “admin” and the password is defined in the <code class="docutils literal notranslate"><span class="pre">inventory</span></code> file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">https</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">SERVER_IP_OR_HOSTNAME</span><span class="o">&gt;/</span>
</pre></div>
</div>
<p>For updating Ansible Tower, download the latest tarball release and
re-run the <code class="docutils literal notranslate"><span class="pre">setup.sh</span></code> script with the original inventory and
variables. Adding new nodes to the cluster should also have that script
run again so that all of the existing and new nodes will be configured
to know about each other. Automatically scaling and/or replicating
PostgreSQL is currently not supported by the Tower setup Playbook. Only
1 database node can be configured by this Playbook.</p>
<p>Logs are stored in <code class="docutils literal notranslate"><span class="pre">/var/log/tower/</span></code>. The main log file is
<code class="docutils literal notranslate"><span class="pre">/var/log/tower/tower.log</span></code>.</p>
<p>Ports:</p>
<ul class="simple">
<li><p>80/tcp = Unencrypted Ansible Tower dashboard web traffic.</p></li>
<li><p>443/tcp = SSL encrypted Ansible Tower dashboard web traffic.</p></li>
<li><p>5432/tcp = PostgreSQL relational database server.</p></li>
</ul>
<p>Cluster ports:</p>
<ul class="simple">
<li><p>4369/tcp = Discovering other Ansible Tower nodes (Erlang service: epmd).</p></li>
<li><p>5672/tcp = Local RabbitMQ port.</p></li>
<li><p>15672/tcp = RabbitMQ dashboard.</p></li>
<li><p>25672/tcp = External RabbitMQ port (Erlang communication between clustered nodes).</p></li>
</ul>
<p>[33][35]</p>
<div class="section" id="gui">
<h4><a class="toc-backref" href="#id122">GUI</a><a class="headerlink" href="#gui" title="Permalink to this headline">¶</a></h4>
<p>There is a navigation bar that contains links to the most important
parts of Ansible Tower.</p>
<ul class="simple">
<li><p>Projects = Playbooks and, if applicable, credentials to access them
from different types of source code management (SCM) systems.</p>
<ul>
<li><p>Manual = Use the a Playbook from the local file system on the
Ansible Tower server.</p></li>
<li><p>Git = A SCM.</p></li>
<li><p>Mercurial (hg) = A SCM.</p></li>
<li><p>Subversion (svn) = A SCM.</p></li>
<li><p>Red Hat Insights = Use a Playbook from the Red Hat Insights
program to do validation checks.</p></li>
</ul>
</li>
<li><p>Inventories = Static and dynamic inventories can be defined here.</p>
<ul>
<li><p>Supported sources:</p>
<ul>
<li><p>Custom Script = Provide a custom script that outputs a valid
JSON or YAML inventory.</p></li>
<li><p>Sourced from a Project = Import inventory from an existing
Project (Playbook).</p></li>
<li><p>Amazon EC2</p></li>
<li><p>Google Compute Engine</p></li>
<li><p>Microsoft Azure Resource Manager</p></li>
<li><p>VMWare vCenter</p></li>
<li><p>Red Hat Satellite 6</p></li>
<li><p>OpenStack</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Templates = Used for defining a Playbook to run, the hosts to run on,
any additional variables to use, and optionally a time interval to
automatically run the template.</p>
<ul>
<li><p>Workflow Template = Defines a workflow for determining when to run
a Playbook and what runs after depending on if the Playbook failed
or succeeded.</p></li>
</ul>
</li>
<li><p>Jobs = Templates that have been run (or are running) and their logs
and statistics.</p></li>
<li><p>(The gear/cog image) = Settings for configuring new users, teams,
dynamic inventory scripts, notifications, the license, and other
settings relating to the Ansible Tower installation.</p></li>
<li><p>(The book image) = A shortcut to Ansible Tower’s official
documentation.</p></li>
</ul>
<p>[50][51]</p>
<p>The default timeout for an authorization token is 30 minutes. After this
time, the token will expire and the end-user will need to re-login into
their account. This setting can be modified in the <code class="docutils literal notranslate"><span class="pre">settings.py</span></code> file.
[52]</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ sudo vim /etc/tower/conf.d/settings.py
<span class="nv">AUTH_TOKEN_EXPIRATION</span> <span class="o">=</span> &lt;SECONDS_BEFORE_TIMEOUT&gt;
</pre></div>
</div>
</div>
<div class="section" id="security">
<h4><a class="toc-backref" href="#id123">Security</a><a class="headerlink" href="#security" title="Permalink to this headline">¶</a></h4>
<div class="section" id="authentication">
<h5><a class="toc-backref" href="#id124">Authentication</a><a class="headerlink" href="#authentication" title="Permalink to this headline">¶</a></h5>
<p>User authentication, by default, will store encrypted user information into the PostgreSQL database. Instead of using this, Tower can be configured to use an external authentication service by going into <code class="docutils literal notranslate"><span class="pre">Settings</span> <span class="pre">&gt;</span> <span class="pre">CONFIGURE</span> <span class="pre">TOWER</span></code>. The enterprise authentication back-ends are not supported on trial or self-supported licenses.</p>
<ul class="simple">
<li><p>Social</p>
<ul>
<li><p>GitHub OAuth2</p>
<ul>
<li><p>GitHub [Users]</p></li>
<li><p>GitHub Org[anization]</p></li>
<li><p>GitHub Team</p></li>
</ul>
</li>
<li><p>Google OAuth2</p></li>
</ul>
</li>
<li><p>Enterprise</p>
<ul>
<li><p>Azure AD</p></li>
<li><p>LDAP</p></li>
<li><p>RADIUS</p></li>
<li><p>SAML</p></li>
<li><p>TACACS+</p></li>
</ul>
</li>
</ul>
<p>[52]</p>
</div>
<div class="section" id="rbac">
<h5><a class="toc-backref" href="#id125">RBAC</a><a class="headerlink" href="#rbac" title="Permalink to this headline">¶</a></h5>
<p>A key part of Ansible Tower is the role-based access control (RBAC) that is provides. Every user in Tower is associated with at least one organization. The level of access the user has to that organizations resources is defined by one of the different access control lists (ACLs).</p>
<p>Hierarchy [1]:</p>
<ul class="simple">
<li><p>Organizations = A combination of Users, Teams, Projects, and
Inventories.</p>
<ul>
<li><p>Teams = Teams are a collection of users. Teams are not required.
Multiple users’ access can be modified easily and quickly via a
Team instead of individually modifying each user’s access.</p>
<ul>
<li><p>Users = Users are optionally associated with a Team and are
always associated with an Organization. An ACL is set for what
resources the user is allowed to use.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Organizational User types:</p>
<ul class="simple">
<li><p>System Administrator = Has full access to all organizations and the Tower installation.</p></li>
<li><p>System Auditor = Has read-only access to an organization.</p></li>
<li><p>Normal User = Has read and write access to an organization.</p></li>
</ul>
<p>[51]</p>
</div>
<div class="section" id="ssl">
<h5><a class="toc-backref" href="#id126">SSL</a><a class="headerlink" href="#ssl" title="Permalink to this headline">¶</a></h5>
<p>By default, Tower creates a self-signed SSL certificate to secure web
traffic. [35] Most web browsers will mark this as an untrusted
connection. For using a different SSL that is trusted, the contents of
these two files need to be replaced on each Tower node:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">/etc/tower/tower.cert</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">/etc/tower/tower.key</span></code></p></li>
</ul>
</div>
</div>
<div class="section" id="api">
<h4><a class="toc-backref" href="#id127">API</a><a class="headerlink" href="#api" title="Permalink to this headline">¶</a></h4>
<p>Ansible Tower has a strong focus on automating Ansible even more by
providing an API interface. Programs can interact with this by making
HTTP GET and PUT requests. All of the available endpoints can be viewed
by going to: <code class="docutils literal notranslate"><span class="pre">https://&lt;ANSIBLE_TOWER_HOST&gt;/api/v2/</span></code>.</p>
<p>Version 2 of the API provides these endpoints:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;authtoken&quot;</span><span class="p">:</span> <span class="s2">&quot;/api/v2/authtoken/&quot;</span><span class="p">,</span>
    <span class="nt">&quot;ping&quot;</span><span class="p">:</span> <span class="s2">&quot;/api/v2/ping/&quot;</span><span class="p">,</span>
    <span class="nt">&quot;instances&quot;</span><span class="p">:</span> <span class="s2">&quot;/api/v2/instances/&quot;</span><span class="p">,</span>
    <span class="nt">&quot;instance_groups&quot;</span><span class="p">:</span> <span class="s2">&quot;/api/v2/instance_groups/&quot;</span><span class="p">,</span>
    <span class="nt">&quot;config&quot;</span><span class="p">:</span> <span class="s2">&quot;/api/v2/config/&quot;</span><span class="p">,</span>
    <span class="nt">&quot;settings&quot;</span><span class="p">:</span> <span class="s2">&quot;/api/v2/settings/&quot;</span><span class="p">,</span>
    <span class="nt">&quot;me&quot;</span><span class="p">:</span> <span class="s2">&quot;/api/v2/me/&quot;</span><span class="p">,</span>
    <span class="nt">&quot;dashboard&quot;</span><span class="p">:</span> <span class="s2">&quot;/api/v2/dashboard/&quot;</span><span class="p">,</span>
    <span class="nt">&quot;organizations&quot;</span><span class="p">:</span> <span class="s2">&quot;/api/v2/organizations/&quot;</span><span class="p">,</span>
    <span class="nt">&quot;users&quot;</span><span class="p">:</span> <span class="s2">&quot;/api/v2/users/&quot;</span><span class="p">,</span>
    <span class="nt">&quot;projects&quot;</span><span class="p">:</span> <span class="s2">&quot;/api/v2/projects/&quot;</span><span class="p">,</span>
    <span class="nt">&quot;project_updates&quot;</span><span class="p">:</span> <span class="s2">&quot;/api/v2/project_updates/&quot;</span><span class="p">,</span>
    <span class="nt">&quot;teams&quot;</span><span class="p">:</span> <span class="s2">&quot;/api/v2/teams/&quot;</span><span class="p">,</span>
    <span class="nt">&quot;credentials&quot;</span><span class="p">:</span> <span class="s2">&quot;/api/v2/credentials/&quot;</span><span class="p">,</span>
    <span class="nt">&quot;credential_types&quot;</span><span class="p">:</span> <span class="s2">&quot;/api/v2/credential_types/&quot;</span><span class="p">,</span>
    <span class="nt">&quot;inventory&quot;</span><span class="p">:</span> <span class="s2">&quot;/api/v2/inventories/&quot;</span><span class="p">,</span>
    <span class="nt">&quot;inventory_scripts&quot;</span><span class="p">:</span> <span class="s2">&quot;/api/v2/inventory_scripts/&quot;</span><span class="p">,</span>
    <span class="nt">&quot;inventory_sources&quot;</span><span class="p">:</span> <span class="s2">&quot;/api/v2/inventory_sources/&quot;</span><span class="p">,</span>
    <span class="nt">&quot;inventory_updates&quot;</span><span class="p">:</span> <span class="s2">&quot;/api/v2/inventory_updates/&quot;</span><span class="p">,</span>
    <span class="nt">&quot;groups&quot;</span><span class="p">:</span> <span class="s2">&quot;/api/v2/groups/&quot;</span><span class="p">,</span>
    <span class="nt">&quot;hosts&quot;</span><span class="p">:</span> <span class="s2">&quot;/api/v2/hosts/&quot;</span><span class="p">,</span>
    <span class="nt">&quot;job_templates&quot;</span><span class="p">:</span> <span class="s2">&quot;/api/v2/job_templates/&quot;</span><span class="p">,</span>
    <span class="nt">&quot;jobs&quot;</span><span class="p">:</span> <span class="s2">&quot;/api/v2/jobs/&quot;</span><span class="p">,</span>
    <span class="nt">&quot;job_events&quot;</span><span class="p">:</span> <span class="s2">&quot;/api/v2/job_events/&quot;</span><span class="p">,</span>
    <span class="nt">&quot;ad_hoc_commands&quot;</span><span class="p">:</span> <span class="s2">&quot;/api/v2/ad_hoc_commands/&quot;</span><span class="p">,</span>
    <span class="nt">&quot;system_job_templates&quot;</span><span class="p">:</span> <span class="s2">&quot;/api/v2/system_job_templates/&quot;</span><span class="p">,</span>
    <span class="nt">&quot;system_jobs&quot;</span><span class="p">:</span> <span class="s2">&quot;/api/v2/system_jobs/&quot;</span><span class="p">,</span>
    <span class="nt">&quot;schedules&quot;</span><span class="p">:</span> <span class="s2">&quot;/api/v2/schedules/&quot;</span><span class="p">,</span>
    <span class="nt">&quot;roles&quot;</span><span class="p">:</span> <span class="s2">&quot;/api/v2/roles/&quot;</span><span class="p">,</span>
    <span class="nt">&quot;notification_templates&quot;</span><span class="p">:</span> <span class="s2">&quot;/api/v2/notification_templates/&quot;</span><span class="p">,</span>
    <span class="nt">&quot;notifications&quot;</span><span class="p">:</span> <span class="s2">&quot;/api/v2/notifications/&quot;</span><span class="p">,</span>
    <span class="nt">&quot;labels&quot;</span><span class="p">:</span> <span class="s2">&quot;/api/v2/labels/&quot;</span><span class="p">,</span>
    <span class="nt">&quot;unified_job_templates&quot;</span><span class="p">:</span> <span class="s2">&quot;/api/v2/unified_job_templates/&quot;</span><span class="p">,</span>
    <span class="nt">&quot;unified_jobs&quot;</span><span class="p">:</span> <span class="s2">&quot;/api/v2/unified_jobs/&quot;</span><span class="p">,</span>
    <span class="nt">&quot;activity_stream&quot;</span><span class="p">:</span> <span class="s2">&quot;/api/v2/activity_stream/&quot;</span><span class="p">,</span>
    <span class="nt">&quot;workflow_job_templates&quot;</span><span class="p">:</span> <span class="s2">&quot;/api/v2/workflow_job_templates/&quot;</span><span class="p">,</span>
    <span class="nt">&quot;workflow_jobs&quot;</span><span class="p">:</span> <span class="s2">&quot;/api/v2/workflow_jobs/&quot;</span><span class="p">,</span>
    <span class="nt">&quot;workflow_job_template_nodes&quot;</span><span class="p">:</span> <span class="s2">&quot;/api/v2/workflow_job_template_nodes/&quot;</span><span class="p">,</span>
    <span class="nt">&quot;workflow_job_nodes&quot;</span><span class="p">:</span> <span class="s2">&quot;/api/v2/workflow_job_nodes/&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>[34]</p>
</div>
<div class="section" id="recovery">
<h4><a class="toc-backref" href="#id128">Recovery</a><a class="headerlink" href="#recovery" title="Permalink to this headline">¶</a></h4>
<p>Ansible Tower provides an official automated solution to backups and restorations of existing Tower clusters.</p>
<p>Backup:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>./setup.sh -b
</pre></div>
</div>
<p>A backup creates a tar archive that is gzip compressed. A symlink is created from the latest backup to the link named “<code class="docutils literal notranslate"><span class="pre">tower-backup-latest.tar.gz</span></code>.”</p>
<p>Syntax - Restore:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>./setup.sh -r
</pre></div>
</div>
<p>Syntax - Restore a specific backup file:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>./setup.sh -r -e <span class="s2">&quot;restore_backup_file=&lt;BACKUP_FILE&gt;&quot;</span>
</pre></div>
</div>
<p>Example - Restore with a specific backup file:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>./setup.sh -r -e <span class="s2">&quot;restore_backup_file=/backups/tower/tower-backup-2018-01-15-12:43:21.tar.gz&quot;</span>
</pre></div>
</div>
<p>[67]</p>
<p>The PostgreSQL database service can natively be configured for streaming replication feature. This is not supported by Red Hat. This replicates all data from the master node to a slave node. If the master node fails, a system administrator can manually set the slave node to be the new master. [68] <a class="reference external" href="https://github.com/samdoran/ansible-role-postgresql-replication">A community supported Ansible role</a> can be used to help automate the setup and usage of this.</p>
<p>Individual Ansible Tower nodes can also be safely removed from the cluster by using the <code class="docutils literal notranslate"><span class="pre">awx-manage</span></code> CLI utility. [42]</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ sudo ansible-tower-service stop
$ sudo awx-manage deprovision_instance -—hostname<span class="o">=</span>&lt;HOST&gt;
$ sudo awx-manage unregister_queue --queuename<span class="o">=</span>&lt;HOST&gt;
</pre></div>
</div>
</div>
<div class="section" id="id8">
<h4><a class="toc-backref" href="#id129">Updates</a><a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h4>
<p>Before updating, it is recommended to take a full backup.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ ./setup.sh -b
</pre></div>
</div>
<p>Minor updates (for example, from 3.2.0 to 3.2.5) for Ansible Tower require using the <a class="reference external" href="https://releases.ansible.com/ansible-tower/setup/">latest setup archive</a>. Extract the archive, copy over the “inventory” file used for the original installation, and re-run the installer.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ ./setup.sh
</pre></div>
</div>
<p>Major upgrades require first updating to the latest minor version. Then sequentially upgrade to the next available major version. This will provide the highest chance of a successful upgrade. For example, to upgrade from 3.0.2 to 3.3.0 the process would be <code class="docutils literal notranslate"><span class="pre">3.0.2</span> <span class="pre">--&gt;</span> <span class="pre">3.0.4</span> <span class="pre">--&gt;</span> <span class="pre">3.1.8</span> <span class="pre">--&gt;</span> <span class="pre">3.2.8</span> <span class="pre">--&gt;</span> <span class="pre">3.3.0</span></code>.</p>
</div>
</div>
<div class="section" id="awx">
<h3><a class="toc-backref" href="#id130">AWX</a><a class="headerlink" href="#awx" title="Permalink to this headline">¶</a></h3>
<p>AWX is the upstream and open source version of Ansible Tower released by
Red Hat to the public on September 7, 2017. [39] The source code for the
project can be found in the
<a class="reference external" href="https://github.com/ansible/awx">ansible/awx</a> repository on GitHub.</p>
<p>Based on the feature set, downstream branches merged in, and release dates, these are the versions of AWX that closely match Ansible Tower releases. [76]</p>
<ul class="simple">
<li><p>AWX 9.0.1 = Ansible Tower 3.6.0</p></li>
<li><p>AWX 5.0.0 = Ansible Tower 3.5.0</p></li>
<li><p>AWX 2.1.2 = Ansible Tower 3.4.0</p></li>
<li><p>AWX 1.0.8 = Ansible Tower 3.3.0</p></li>
<li><p>AWX 1.0.0 = Ansible Tower 3.2.0</p></li>
</ul>
<div class="section" id="install">
<h4><a class="toc-backref" href="#id131">Install</a><a class="headerlink" href="#install" title="Permalink to this headline">¶</a></h4>
<p>The “installer/inventory” file has an example inventory that can be used
without any configuration. These are many options that can be fine tuned
to change the environment and deploy it to different platforms.</p>
<p>Deployment inventory options:</p>
<ul class="simple">
<li><p>All</p>
<ul>
<li><p>default_admin_user = The administrator account’s username.</p></li>
<li><p>default_admin_password = The administrator account’s password.</p></li>
<li><p>secret_key = A string that is used as a private key kept on all of the AWX nodes for encrypting and decrypting information that goes to/from the PostgreSQL database.</p></li>
<li><p>pg_username = The PostgreSQL username to use.</p></li>
<li><p>pg_password = The PostgreSQL password to use.</p></li>
<li><p>pg_database = The PostgreSQL database name.</p></li>
<li><p>pg_port = The PostgreSQL port to connect to.</p></li>
<li><p>http_proxy = A HTTP proxy to use.</p></li>
<li><p>https_proxy = A HTTPS proxy to use.</p></li>
<li><p>no_proxy = Websites that should not be proxied.</p></li>
<li><p>project_data_dir = A directory to share between the containers that stores local project playbooks.</p></li>
</ul>
</li>
<li><p>docker (build)</p>
<ul>
<li><p>dockerhub_base and dockerhub_version = Comment out these variables to build docker images from scratch instead of downloading them from Docker Hub.</p></li>
<li><p>postgres_data_dir = The directory to store persistent PostgreSQL data. By default, this is stored in the temporary file system at <code class="docutils literal notranslate"><span class="pre">/tmp/</span></code>.</p></li>
<li><p>host_port = The local HTTP port that docker should bind to for the AWX dashboard.</p></li>
<li><p>use_container_for_build = Use a container to deploy the other container. This keeps dependencies installed for installation in the container instead of the local system.</p></li>
<li><p>awx_official = Use the official AWX logos. The <a class="reference external" href="https://github.com/ansible/awx-logos">awx-logos GitHub project</a> will need to be cloned in the directory that “awx” was also cloned into.</p></li>
</ul>
</li>
<li><p>docker (prebuilt)</p>
<ul>
<li><p>dockerhub_base = The Docker Hub repository to use.</p></li>
<li><p>dockerhub_version = The version of AWX containers to use.</p></li>
<li><p>postgres_data_dir</p></li>
<li><p>host_port</p></li>
</ul>
</li>
<li><p>OpenShift</p>
<ul>
<li><p>openshift_host = The OpenShift cluster to connect to.</p></li>
<li><p>openshift_user = The username used to connect to OpenShift.</p></li>
<li><p>openshift_password = The password used to connect to OpenShift.</p></li>
<li><p>docker_registry = The Docker Registry to connect to.</p></li>
<li><p>docker_registry_repository = The Docker Repository to use.</p></li>
<li><p>docker_registry_username = The username to login into the Docker Registry.</p></li>
<li><p>docker_registry_password = The password to login into the Docker Registry.</p></li>
<li><p>openshift_project = The name of the project to create and use in OpenShift.</p></li>
</ul>
</li>
</ul>
<p>Install:</p>
<p>By default, AWX will install docker containers from Docker Hub. The published versions available for the <code class="docutils literal notranslate"><span class="pre">dockerhub_version</span></code> variable can be found here: <a class="reference external" href="https://hub.docker.com/r/ansible/awx_web/tags/">https://hub.docker.com/r/ansible/awx_web/tags/</a>. It is also possible to have the installer build docker containers from the source code. These containers can optionally be deployed onto a Kubernetes or OpenShift cluster.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ sudo systemctl start docker
$ git clone https://github.com/ansible/awx.git
$ <span class="nb">cd</span> ./awx/installer/
$ sudo ansible-playbook -i inventory install.yml
</pre></div>
</div>
<p>After installation, the containers will be started. On a server, the
containers are configured to automatically restart up on boot if the
<code class="docutils literal notranslate"><span class="pre">docker</span></code> service is enabled. With workstations and other environments
where docker is not running on boot, the containers can still be started
and stopped manually.</p>
<p>Manually start:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ <span class="k">for</span> docker_container <span class="k">in</span> postgres rabbitmq memcached awx_web awx_task<span class="p">;</span> <span class="k">do</span> sudo docker start <span class="si">${</span><span class="nv">docker_container</span><span class="si">}</span><span class="p">;</span> <span class="k">done</span>
</pre></div>
</div>
<p>Manually stop:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ <span class="k">for</span> docker_container <span class="k">in</span> awx_task awx_web memcached rabbitmq postgres<span class="p">;</span> <span class="k">do</span> sudo docker stop <span class="si">${</span><span class="nv">docker_container</span><span class="si">}</span><span class="p">;</span> <span class="k">done</span>
</pre></div>
</div>
</div>
<div class="section" id="upgrades">
<h4><a class="toc-backref" href="#id132">Upgrades</a><a class="headerlink" href="#upgrades" title="Permalink to this headline">¶</a></h4>
<p>AWX is the development version of Ansible Tower. Rolling upgrades are not supported on the AWX 1.Y.Z releases. [60] Starting with AWX 2.0.0, it supports automatic upgrade migrations between tags published on GitHub and Docker Hub.</p>
<div class="section" id="automatic">
<h5><a class="toc-backref" href="#id133">Automatic</a><a class="headerlink" href="#automatic" title="Permalink to this headline">¶</a></h5>
<p>Keep the same variables and inventory settings. It is also important to have the password variables (listed below) set to their current values. Download the latest AWX playbooks and re-run the installation to upgrade. [84]</p>
<ul class="simple">
<li><p>admin_password</p></li>
<li><p>pg_password</p></li>
<li><p>rabbitmq_password</p></li>
<li><p>secret_key</p></li>
</ul>
<p>If there are issues with the upgrade, try manually upgrading the database schema.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ sudo docker <span class="nb">exec</span> -it &lt;AWX_CONTAINER&gt; bash
$ awx-manage migrate
</pre></div>
</div>
</div>
<div class="section" id="manual">
<h5><a class="toc-backref" href="#id134">Manual</a><a class="headerlink" href="#manual" title="Permalink to this headline">¶</a></h5>
<p>The <a class="reference external" href="https://github.com/ansible/tower-cli">tower-cli</a> command can be used to backup and restore the AWX data. This method can also be used to migrate from AWX to Ansible Tower or vice versa. [61]</p>
<p>Take note of the AWX version. This can be seen through the dashboard (use the “About” button) or API (perform a GET on <code class="docutils literal notranslate"><span class="pre">/api/v2/ping</span></code>). If AWX was installed using the source code from GitHub and Docker Compose, the version can also be found from the <code class="docutils literal notranslate"><span class="pre">VERSION</span></code> file.</p>
<p>Before doing an upgrade, the PostgreSQL database should be backed up. This contains all of the information that is stored by AWX.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ docker <span class="nb">exec</span> postgres pg_dump -U postgres -F t awx &gt; <span class="si">${</span><span class="nv">postgres_data_dir</span><span class="si">}</span>/awx_backup.sql
</pre></div>
</div>
<p>If there are issues with the update, then revert the docker images to their original versions and restore the database.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ docker <span class="nb">exec</span> postgres sh -c <span class="s2">&quot;pg_restore -U awx -C -d awx /var/lib/postgresql/data/awx_backup.sql&quot;</span>
</pre></div>
</div>
<p>Configure <code class="docutils literal notranslate"><span class="pre">tower-cli</span></code> with admin credentials to the existing AWX deployment. These settings are saved to <code class="docutils literal notranslate"><span class="pre">$HOME/.tower_cli.cfg</span></code>.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ tower-cli config host http://&lt;HOSTNAME&gt;
$ tower-cli config username &lt;USERNAME&gt;
$ tower-cli config password &lt;PASSOWRD&gt;
$ tower-cli config verify_ssl False
</pre></div>
</div>
<p>Backup the AWX data. This will include all of the information except for logs, credential secrets, authentication settings, and AWX settings. [65]</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ tower-cli receive --all &gt; awx_data_backup.json
</pre></div>
</div>
<p>Delete the old containers. Refer to the <code class="docutils literal notranslate"><span class="pre">Uninstall</span></code> section for more details.</p>
<p>Compare the latest “installer/inventory” file with the existing inventory file. Some settings may have changed that need to be updated.</p>
<p>Reinstall AWX using the installer.yml playbook from the latest clone of the GitHub repository. The default installation settings for using Docker Hub will download the latest images. [59]</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ git clone https://github.com/ansible/awx
$ sudo ansible-playbook -i inventory awx/installer/install.yml
</pre></div>
</div>
<p>Restore the data. [65]</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ tower-cli send awx_data_backup.json
</pre></div>
</div>
</div>
</div>
<div class="section" id="uninstall">
<h4><a class="toc-backref" href="#id135">Uninstall</a><a class="headerlink" href="#uninstall" title="Permalink to this headline">¶</a></h4>
<p>Stop and delete the AWX docker containers.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ <span class="k">for</span> docker_container <span class="k">in</span> awx_task awx_web memcached rabbitmq postgres<span class="p">;</span> <span class="k">do</span> sudo docker stop <span class="si">${</span><span class="nv">docker_container</span><span class="si">}</span><span class="p">;</span> sudo docker rm -f <span class="si">${</span><span class="nv">docker_container</span><span class="si">}</span><span class="p">;</span> <span class="k">done</span>
</pre></div>
</div>
<p>The “postgres_data_dir” directory, as defined in the inventory file, will need to be manually deleted.</p>
</div>
<div class="section" id="postgresql-streaming-replication">
<h4><a class="toc-backref" href="#id136">PostgreSQL Streaming Replication</a><a class="headerlink" href="#postgresql-streaming-replication" title="Permalink to this headline">¶</a></h4>
<p>It is important to have a backup of the PostgreSQL database. It contains all of the information used by AWX. The <a class="reference external" href="https://github.com/samdoran/ansible-role-pgsql-replication">samdoran/ansible-role-pgsql-replication</a> project on GitHub provides playbooks to automate setting up streaming replication for the database. This setups two PostgreSQL servers, one in master mode and the other in replica mode (a hot standby).</p>
</div>
</div>
<div class="section" id="rundeck">
<h3><a class="toc-backref" href="#id137">Rundeck</a><a class="headerlink" href="#rundeck" title="Permalink to this headline">¶</a></h3>
<p>Rundeck is an open source dashboard and API framework, programmed with
Java, for automating the execution of commands and scripts via SSH.
There is a community supported <a class="reference external" href="https://www.rundeck.com/ansible">Ansible plugin for Rundeck</a> that has been stable since the plugin’s 2.5.0 release. [80] It supports using Ansible inventory as
well as running modules and Playbooks. This can be tested out using a
pre-built docker image:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ sudo docker pull batix/rundeck-ansible
$ sudo docker run -d --name rundeck-test -p <span class="m">127</span>.0.0.1:4440:4440 -e <span class="nv">RDECK_ADMIN_PASS</span><span class="o">=</span>password -v <span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>:/data batix/rundeck-ansible
</pre></div>
</div>
<p>Log into the dashboard at <code class="docutils literal notranslate"><span class="pre">http://127.0.0.1:4440</span></code> and use the username
“admin” and the password that was set by the <code class="docutils literal notranslate"><span class="pre">RDECK_ADMIN_PASS</span></code>
variable.</p>
<p>[56]</p>
</div>
<div class="section" id="semaphore">
<h3><a class="toc-backref" href="#id138">Semaphore</a><a class="headerlink" href="#semaphore" title="Permalink to this headline">¶</a></h3>
<p>Semaphore was designed to be an unofficial open source alternative to
Ansible Tower, written in Go. The latest release can be found at
<a class="reference external" href="https://github.com/ansible-semaphore/semaphore/releases">https://github.com/ansible-semaphore/semaphore/releases</a>.</p>
<p>Requirements:</p>
<ul class="simple">
<li><p>Ansible</p></li>
<li><p>Git &gt;= 2.0</p></li>
<li><p>Go</p></li>
<li><p>MariaDB &gt;= 5.3 or MySQL &gt;= 5.6.4</p></li>
</ul>
<p>Installation:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ sudo curl -L https://github.com/ansible-semaphore/semaphore/releases/download/v2.5.1/semaphore_linux_amd64 &gt; /usr/bin/semaphore
$ sudo /usr/bin/semaphore -setup
</pre></div>
</div>
<p>Semaphore will now be available at <code class="docutils literal notranslate"><span class="pre">http://&lt;SEMAPHORE_HOST&gt;:3000</span></code>.</p>
<p>[24]</p>
</div>
<div class="section" id="tensor">
<h3><a class="toc-backref" href="#id139">Tensor</a><a class="headerlink" href="#tensor" title="Permalink to this headline">¶</a></h3>
<p>Tensor is an open source dashboard and API for infrastructure management using both Ansible and Terraform. It is written in Go and created by Pearson. The public facing documentation is incomplete and missing. Tensor is no longer supported since June of 2017. [57]</p>
</div>
</div>
<div class="section" id="history">
<h2><a class="toc-backref" href="#id140">History</a><a class="headerlink" href="#history" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/ekultails/rootpages/commits/master/src/automation/ansible.rst">Latest</a></p></li>
<li><p><a class="reference external" href="https://github.com/ekultails/rootpages/commits/master/src/ansible.rst">&lt; 2019.01.01</a></p></li>
<li><p><a class="reference external" href="https://github.com/ekultails/rootpages/commits/master/markdown/ansible.md">&lt; 2018.01.01</a></p></li>
</ul>
</div>
<div class="section" id="bibliography">
<h2><a class="toc-backref" href="#id141">Bibliography</a><a class="headerlink" href="#bibliography" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p>“An Ansible Tutorial.” Servers for Hackers. August 26, 2014. Accessed June 24, 2016. <a class="reference external" href="https://serversforhackers.com/an-ansible-tutorial">https://serversforhackers.com/an-ansible-tutorial</a></p></li>
<li><p>“Intro to Playbooks.” Ansible Documentation. August 4, 2017. Accessed August 6, 2017. <a class="reference external" href="http://docs.ansible.com/ansible/playbooks_intro.html">http://docs.ansible.com/ansible/playbooks_intro.html</a></p></li>
<li><p>“Inventory.” Ansible Docs. June 22, 2016. Accessed July 9, 2016. <a class="reference external" href="http://docs.ansible.com/ansible/intro_inventory.html">http://docs.ansible.com/ansible/intro_inventory.html</a></p></li>
<li><p>“Variables.” Ansible Documentation. October 2, 2018. Accessed October 2, 2018. <a class="reference external" href="http://docs.ansible.com/ansible/latest/user_guide/playbooks_variables.html">http://docs.ansible.com/ansible/latest/user_guide/playbooks_variables.html</a></p></li>
<li><p>“Best Practices.” Ansible Documentation. December 11, 2019. Accessed December 14, 2019. <a class="reference external" href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_best_practices.html">https://docs.ansible.com/ansible/latest/user_guide/playbooks_best_practices.html</a></p></li>
<li><p>“Commands modules.” Ansible Documentation. April 19, 2018. Accessed April 21, 2018. <a class="reference external" href="http://docs.ansible.com/ansible/latest/list_of_commands_modules.html">http://docs.ansible.com/ansible/latest/list_of_commands_modules.html</a></p></li>
<li><p>“Source Control Modules.” Ansible Documentation. October 10, 2017. Accessed March 2, 2018. <a class="reference external" href="http://docs.ansible.com/ansible/latest/list_of_source_control_modules.html">http://docs.ansible.com/ansible/latest/list_of_source_control_modules.html</a></p></li>
<li><p>“Tags.” Ansible Documentation. April 21, 2017. Accessed April 22, 2017. <a class="reference external" href="http://docs.ansible.com/ansible/playbooks_tags.html">http://docs.ansible.com/ansible/playbooks_tags.html</a></p></li>
<li><p>“Prompts.” Ansible Documentation. August 05, 2016. Accessed August 13, 2016. <a class="reference external" href="http://docs.ansible.com/ansible/playbooks_prompts.html">http://docs.ansible.com/ansible/playbooks_prompts.html</a></p></li>
<li><p>“Loops.” Ansible Documentation. October 26, 2018. Accessed October 30, 2018. <a class="reference external" href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_loops.html">https://docs.ansible.com/ansible/latest/user_guide/playbooks_loops.html</a></p></li>
<li><p>“Conditionals.” Ansible Documentation. April 12, 2017. Accessed April 13, 2017. <a class="reference external" href="http://docs.ansible.com/ansible/playbooks_conditionals.html">http://docs.ansible.com/ansible/playbooks_conditionals.html</a></p></li>
<li><p>“Error Handling In Playbooks.” Ansible Documentation. August 24, 2016. Accessed August 27, 2016. <a class="reference external" href="http://docs.ansible.com/ansible/playbooks_error_handling.html">http://docs.ansible.com/ansible/playbooks_error_handling.html</a></p></li>
<li><p>“Become (Privilege Escalation).” Ansible Documentation. August 24, 2016. Accessed August 27, 2016. <a class="reference external" href="http://docs.ansible.com/ansible/become.html">http://docs.ansible.com/ansible/become.html</a></p></li>
<li><p>“Delegation, Rolling Updates, and Local Actions.” Ansible Documentation. November 15, 2019. Accessed November 27, 2019. <a class="reference external" href="http://docs.ansible.com/ansible/playbooks_delegation.html">http://docs.ansible.com/ansible/playbooks_delegation.html</a></p></li>
<li><p>“Asynchronous Actions and Polling.” Ansible Documentation. February 21, 2019. Accessed February 27, 2019. <a class="reference external" href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_async.html">https://docs.ansible.com/ansible/latest/user_guide/playbooks_async.html</a></p></li>
<li><p>“mysql_db - Add or remove MySQL databases from a remote host.” Ansible Documentation. September 28, 2016. Accessed October 1, 2016. <a class="reference external" href="http://docs.ansible.com/ansible/mysql_db_module.html">http://docs.ansible.com/ansible/mysql_db_module.html</a></p></li>
<li><p>“mysql_user - Adds or removes a user from a MySQL database.” Ansible Documentation. September 28, 2016. Accessed October 1, 2016. <a class="reference external" href="http://docs.ansible.com/ansible/mysql_user_module.html">http://docs.ansible.com/ansible/mysql_user_module.html</a></p></li>
<li><p>“Installation Guide.” Ansible Documentation. December 16, 2019. Accessed December 19, 2019. <a class="reference external" href="https://docs.ansible.com/ansible/latest/installation_guide/intro_installation.html">https://docs.ansible.com/ansible/latest/installation_guide/intro_installation.html</a></p></li>
<li><p>“Cache Plugins.” Ansible Documentation. July 5, 2018. Accessed July 12, 2018. <a class="reference external" href="https://docs.ansible.com/ansible/latest/plugins/cache.html">https://docs.ansible.com/ansible/latest/plugins/cache.html</a></p></li>
<li><p>“Jinja Template Designer Documentation.” Jinja2 Documentation. Accessed April 23, 2017. <a class="reference external" href="http://jinja.pocoo.org/docs/dev/templates/">http://jinja.pocoo.org/docs/dev/templates/</a></p></li>
<li><p>“Ansible Vault.” Ansible Documentation. October 10, 2017. Accessed March 2, 2018. <a class="reference external" href="http://docs.ansible.com/ansible/latest/vault.html">http://docs.ansible.com/ansible/latest/vault.html</a></p></li>
<li><p>“Organizing Group Vars Files in Ansible.” toja.io sysadmin, devops and videotapes. Accessed November 6, 2016. <a class="reference external" href="http://toja.io/using-host-and-group-vars-files-in-ansible/">http://toja.io/using-host-and-group-vars-files-in-ansible/</a></p></li>
<li><p>“Glossary.” Ansible Documentation. September 7, 2018. Accessed September 12, 2018. <a class="reference external" href="https://docs.ansible.com/ansible/latest/reference_appendices/glossary.html">https://docs.ansible.com/ansible/latest/reference_appendices/glossary.html</a></p></li>
<li><p>“Semaphore Installation.” GitHub - ansible-semaphore/semaphore. June 1, 2017. Accessed August 14, 2017. <a class="reference external" href="https://github.com/ansible-semaphore/semaphore/wiki/Installation">https://github.com/ansible-semaphore/semaphore/wiki/Installation</a></p></li>
<li><p>“Ansible Galaxy.” Ansible Documentation. March 31, 2017. Accessed April 4, 2017. <a class="reference external" href="http://docs.ansible.com/ansible/galaxy.html">http://docs.ansible.com/ansible/galaxy.html</a></p></li>
<li><p>“ANSIBLE PERFORMANCE TUNING (FOR FUN AND PROFIT).” Ansible Blog. July 10, 2014. Accessed January 25, 2017. <a class="reference external" href="https://www.ansible.com/blog/ansible-performance-tuning">https://www.ansible.com/blog/ansible-performance-tuning</a></p></li>
<li><p>“Configuration file.” Ansible Documentation. April 17, 2017. Accessed April 20, 2017. <a class="reference external" href="http://docs.ansible.com/ansible/intro_configuration.html">http://docs.ansible.com/ansible/intro_configuration.html</a></p></li>
<li><p>“network_interface.” MartinVerges GitHub. January 24, 2017. Accessed April 4, 2017. <a class="reference external" href="https://github.com/MartinVerges/ansible.network_interface">https://github.com/MartinVerges/ansible.network_interface</a></p></li>
<li><p>“Check Mode (“Dry Run”).” Ansible Documentation. April 12, 2017. Accessed April 13, 2017. <a class="reference external" href="http://docs.ansible.com/ansible/playbooks_checkmode.html">http://docs.ansible.com/ansible/playbooks_checkmode.html</a></p></li>
<li><p>“Return Values.” Ansible Documentation. April 17, 2017. Accessed April 18, 2017. <a class="reference external" href="http://docs.ansible.com/ansible/common_return_values.html">http://docs.ansible.com/ansible/common_return_values.html</a></p></li>
<li><p>“Windows Support.” Ansible Documentation. August 4, 2017. Accessed August 10, 2017. <a class="reference external" href="http://docs.ansible.com/ansible/latest/intro_windows.html">http://docs.ansible.com/ansible/latest/intro_windows.html</a></p></li>
<li><p>“Ansible Python API.” Ansible Documentation. March 29, 2018. Accessed March 30, 2018. <a class="reference external" href="http://docs.ansible.com/ansible/latest/dev_guide/developing_api.html">http://docs.ansible.com/ansible/latest/dev_guide/developing_api.html</a></p></li>
<li><p>“Installing and Configuring Ansible Tower Clusters - AnsbileFest London 2017.” YouTube - Ansible. July 19, 2017. Accessed August 10, 2017. <a class="reference external" href="https://www.youtube.com/watch?v=NiM4xNkauig">https://www.youtube.com/watch?v=NiM4xNkauig</a></p></li>
<li><p>“Ansible Tower API Guide.” Ansible Documentation. Accessed October 2, 2017. <a class="reference external" href="http://docs.ansible.com/ansible-tower/latest/html/towerapi/index.html">http://docs.ansible.com/ansible-tower/latest/html/towerapi/index.html</a></p></li>
<li><p>“Ansible Tower Installation and Reference Guide.” Ansible Documentation. Accessed December 19, 2019. <a class="reference external" href="https://docs.ansible.com/ansible-tower/latest/html/installandreference/index.html">https://docs.ansible.com/ansible-tower/latest/html/installandreference/index.html</a></p></li>
<li><p>“Controlling playbook execution: strategies and more.” Ansible Documentation. November 15, 2019. Accessed November 27, 2019. <a class="reference external" href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_strategies.html">https://docs.ansible.com/ansible/latest/user_guide/playbooks_strategies.html</a></p></li>
<li><p>“Get-WindowsFeature.” MSDN Library. November 1, 2013. Accessed August 6, 2017. <a class="reference external" href="https://msdn.microsoft.com/en-us/library/ee662312.aspx">https://msdn.microsoft.com/en-us/library/ee662312.aspx</a></p></li>
<li><p>“Ansible Tower Job Templates.” Ansible Tower Documentation. Accessed September 7, 2017. <a class="reference external" href="http://docs.ansible.com/ansible-tower/latest/html/userguide/job_templates.html">http://docs.ansible.com/ansible-tower/latest/html/userguide/job_templates.html</a></p></li>
<li><p>“Ansible announces AWX open source project.” OpenSource.com. September 7, 2017. Accessed September 7, 2017. <a class="reference external" href="https://opensource.com/article/17/9/ansible-announces-awx-open-source-project">https://opensource.com/article/17/9/ansible-announces-awx-open-source-project</a></p></li>
<li><p>“Red Hat Ansible Engine.” Ansible. Accessed September 12, 2017. <a class="reference external" href="https://www.ansible.com/ansible-engine">https://www.ansible.com/ansible-engine</a></p></li>
<li><p>“HOW TO EXTEND ANSIBLE THROUGH PLUGINS.” January 5, 2017. Ansible Blog. Accessed July 10, 2018. <a class="reference external" href="https://www.ansible.com/blog/how-to-extend-ansible-through-plugins">https://www.ansible.com/blog/how-to-extend-ansible-through-plugins</a></p></li>
<li><p>“Clustering.” Ansible Tower Documentation. Accessed June 7, 2018. <a class="reference external" href="http://docs.ansible.com/ansible-tower/latest/html/administration/clustering.html">http://docs.ansible.com/ansible-tower/latest/html/administration/clustering.html</a></p></li>
<li><p>“Ansible Python 3 Support.” Ansible Documentation. June 14, 2018. Accessed June 22, 2018. <a class="reference external" href="http://docs.ansible.com/ansible/latest/python_3_support.html">http://docs.ansible.com/ansible/latest/python_3_support.html</a></p></li>
<li><p>“ansible.” Ansible GitHub. October 4, 2018. Accessed October 4, 2018. <a class="reference external" href="https://github.com/ansible/ansible">https://github.com/ansible/ansible</a></p></li>
<li><p>“Utilities Modules.” Ansible Documentation. September 18, 2017. Accessed September 26, 2017. <a class="reference external" href="http://docs.ansible.com/ansible/latest/list_of_utilities_modules.html">http://docs.ansible.com/ansible/latest/list_of_utilities_modules.html</a></p></li>
<li><p>“Files Modules.” Ansible Documentation. September 18, 2017. Accessed September 21, 2017. <a class="reference external" href="http://docs.ansible.com/ansible/latest/list_of_files_modules.html">http://docs.ansible.com/ansible/latest/list_of_files_modules.html</a></p></li>
<li><p>“Packaging Modules.” Ansible Documentation. September 18, 2017. Accessed September 21, 2017. <a class="reference external" href="http://docs.ansible.com/ansible/latest/list_of_packaging_modules.html">http://docs.ansible.com/ansible/latest/list_of_packaging_modules.html</a></p></li>
<li><p>“Windows Modules.” Ansible Documentation. September 18, 2017. Accessed September 21, 2017. <a class="reference external" href="http://docs.ansible.com/ansible/latest/list_of_windows_modules.html">http://docs.ansible.com/ansible/latest/list_of_windows_modules.html</a></p></li>
<li><p>“Creating Reusable Playbooks.” Ansible Documentation. September 18, 2017. Accessed September 21, 2017. <a class="reference external" href="http://docs.ansible.com/ansible/latest/playbooks_reuse.html">http://docs.ansible.com/ansible/latest/playbooks_reuse.html</a></p></li>
<li><p>“Ansible Tower Quick Setup Guide.” Ansible Documentation. September 18, 2017. Accessed September 25, 2017. <a class="reference external" href="http://docs.ansible.com/ansible-tower/latest/html/quickstart/index.html">http://docs.ansible.com/ansible-tower/latest/html/quickstart/index.html</a></p></li>
<li><p>“Ansible Tower User Guide.” Ansible Documentation. September 18, 2017. Accessed September 25, 2017. <a class="reference external" href="http://docs.ansible.com/ansible-tower/latest/html/userguide/index.html">http://docs.ansible.com/ansible-tower/latest/html/userguide/index.html</a></p></li>
<li><p>“Ansible Tower Administration Guide.” Ansible Documentation. Accessed June 19, 2018. <a class="reference external" href="http://docs.ansible.com/ansible-tower/latest/html/administration/index.html">http://docs.ansible.com/ansible-tower/latest/html/administration/index.html</a></p></li>
<li><p>“Blocks.” Ansible Documentation. September 18, 2017. Accessed September 26, 2017. <a class="reference external" href="http://docs.ansible.com/ansible/latest/playbooks_blocks.html">http://docs.ansible.com/ansible/latest/playbooks_blocks.html</a></p></li>
<li><p>“Net Tools Modules.” Ansible Documentation. September 18, 2017. Accessed September 26, 2017. <a class="reference external" href="http://docs.ansible.com/ansible/latest/list_of_net_tools_modules.html">http://docs.ansible.com/ansible/latest/list_of_net_tools_modules.html</a></p></li>
<li><p>“System Modules.” Ansible Documentation. December 11, 2019. Accessed January 13, 2020. <a class="reference external" href="http://docs.ansible.com/ansible/latest/list_of_system_modules.html">http://docs.ansible.com/ansible/latest/list_of_system_modules.html</a></p></li>
<li><p>“Rundeck Ansible Plugin [README.md].” Batix GitHub. August 9, 2017. Accessed September 26, 2017. <a class="reference external" href="https://github.com/Batix/rundeck-ansible-plugin">https://github.com/Batix/rundeck-ansible-plugin</a></p></li>
<li><p>“Tensor [README.md].” PearsonAppEng GitHub. April 25, 2017. Accessed September 6, 2018. <a class="reference external" href="https://github.com/pearsonappeng/tensor">https://github.com/pearsonappeng/tensor</a></p></li>
<li><p>“Including and Importing.” Ansible Documentation. October 10, 2017. Accessed March 2, 2018. <a class="reference external" href="http://docs.ansible.com/ansible/latest/playbooks_reuse_includes.html">http://docs.ansible.com/ansible/latest/playbooks_reuse_includes.html</a></p></li>
<li><p>“Specify a PGDATA directory to prevent container re-create issues #535.” GitHub Ansible. February 22, 2018. Accessed March 9, 2018. <a class="reference external" href="https://github.com/ansible/awx/pull/535">https://github.com/ansible/awx/pull/535</a></p></li>
<li><p>“1.0.4 - 1.0.5 upgrade killed my workers &amp; errors db upgrade Key (username)=(admin) already exists. #1707.” GitHub AWX. March 30, 2018. Accessed April 6, 2018. <a class="reference external" href="https://github.com/ansible/awx/issues/1707">https://github.com/ansible/awx/issues/1707</a></p></li>
<li><p>“Feature to download &amp; upload data in Tower #197.” GitHub tower-cli. February 28, 2018. Accessed April 6, 2018. <a class="reference external" href="https://github.com/ansible/tower-cli/issues/197">https://github.com/ansible/tower-cli/issues/197</a></p></li>
<li><p>“Lookup Plugins.” Ansible Documentation. April 19, 2018. Accessed April 21, 2018. <a class="reference external" href="https://docs.ansible.com/ansible/2.5/plugins/lookup.html">https://docs.ansible.com/ansible/2.5/plugins/lookup.html</a></p></li>
<li><p>“Release and maintenance.” Ansible Documentation. September 7, 2018. Accessed September 18, 2018. <a class="reference external" href="https://docs.ansible.com/ansible/latest/reference_appendices/release_and_maintenance.html">https://docs.ansible.com/ansible/latest/reference_appendices/release_and_maintenance.html</a></p></li>
<li><p>“Frequently Asked Questions.” Ansible Documentation. April 19, 2018. Accessed April 21, 2018. <a class="reference external" href="http://docs.ansible.com/ansible/latest/faq.html">http://docs.ansible.com/ansible/latest/faq.html</a></p></li>
<li><p>“Migrating Data Between AWX Installations.” GitHub AWX. May 4, 2018. Accessed May 16, 2018. <a class="reference external" href="https://github.com/ansible/awx/blob/devel/DATA_MIGRATION.md">https://github.com/ansible/awx/blob/devel/DATA_MIGRATION.md</a></p></li>
<li><p>“Red Hat Ansible Tower Life Cycle.” Red Hat Customer Portal. November 14, 2019. Accessed December 19, 2019. <a class="reference external" href="https://access.redhat.com/support/policy/updates/ansible-tower">https://access.redhat.com/support/policy/updates/ansible-tower</a></p></li>
<li><p>“Backing Up and Restoring Tower. Ansible Documentation. Accessed May 29, 2018. <a class="reference external" href="http://docs.ansible.com/ansible-tower/latest/html/administration/backup_restore.html">http://docs.ansible.com/ansible-tower/latest/html/administration/backup_restore.html</a></p></li>
<li><p>“Replication, Clustering, and Connection Pooling.” PostgreSQL Wiki. June 8, 2017. Accessed May 29, 2018. <a class="reference external" href="https://wiki.postgresql.org/wiki/Replication,_Clustering,_and_Connection_Pooling">https://wiki.postgresql.org/wiki/Replication,_Clustering,_and_Connection_Pooling</a></p></li>
<li><p>“Rules.” Ansible Lint Documentation. February 12, 2019. Accessed June 13, 2019. <a class="reference external" href="https://docs.ansible.com/ansible-lint/rules/rules.html">https://docs.ansible.com/ansible-lint/rules/rules.html</a></p></li>
<li><p>“Molecule.” Molecule documentation. Accessed November 29, 2018. <a class="reference external" href="https://molecule.readthedocs.io/en/latest/">https://molecule.readthedocs.io/en/latest/</a></p></li>
<li><p>“Ansible Galaxy Home.” Ansible Galaxy. Accessed August 8, 2018. <a class="reference external" href="https://galaxy.ansible.com/home">https://galaxy.ansible.com/home</a></p></li>
<li><p>“When using docker (image alpine:3.6): Authentication or permission failure #1043.” metacloud/molecule GitHub. November 20, 2017 Accessed August 23, 2018. https://github.com/metacloud/molecule/issues/1043</p></li>
<li><p>“Ansible 2.7 Porting Guide.” Ansible GitHub. September 11, 2018. Accessed September 12, 2018. <a class="reference external" href="https://github.com/ansible/ansible/blob/devel/docs/docsite/rst/porting_guides/porting_guide_2.7.rst">https://github.com/ansible/ansible/blob/devel/docs/docsite/rst/porting_guides/porting_guide_2.7.rst</a></p></li>
<li><p>“ANSIBLE BEST PRACTICES: THE ESSENTIALS.” Ansible. 2018. Accessed December 16, 2019. <a class="reference external" href="https://www.ansible.com/hubfs/2018_Content/AA%20BOS%202018%20Slides/Ansible%20Best%20Practices.pdf">https://www.ansible.com/hubfs/2018_Content/AA%20BOS%202018%20Slides/Ansible%20Best%20Practices.pdf</a></p></li>
<li><p>“OpenShift Deployment and Configuration.” Ansible Documentation. Accessed September 14, 2018. <a class="reference external" href="https://docs.ansible.com/ansible-tower/latest/html/administration/openshift_configuration.html">https://docs.ansible.com/ansible-tower/latest/html/administration/openshift_configuration.html</a></p></li>
<li><p>“AWX Project.” Ansible GitHub. June 19, 2019. Accessed June 19, 2019. <a class="reference external" href="https://github.com/ansible/awx">https://github.com/ansible/awx</a></p></li>
<li><p>“Building Container Images with Buildah and Ansible.” February 4, 2018. Accessed November 8, 2018. <a class="reference external" href="https://blog.tomecek.net/post/building-containers-with-buildah-and-ansible/">https://blog.tomecek.net/post/building-containers-with-buildah-and-ansible/</a></p></li>
<li><p>“[Reusable] Roles.” Ansible Documentation. November 15, 2018. Accessed November 26, 2018. <a class="reference external" href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_reuse_roles.html">https://docs.ansible.com/ansible/latest/user_guide/playbooks_reuse_roles.html</a></p></li>
<li><p>“Ansible 2.7 [ROADMAP].” Ansible Documentation. December 1, 2018. Accessed December 7, 2018. <a class="reference external" href="https://docs.ansible.com/ansible/latest/roadmap/ROADMAP_2_7.html">https://docs.ansible.com/ansible/latest/roadmap/ROADMAP_2_7.html</a></p></li>
<li><p>“Major upgrade.” Batix/rundeck-ansible-plugin, GitHub. August 15, 2018. Accessed February 26, 2019. <a class="reference external" href="https://github.com/Batix/rundeck-ansible-plugin/commit/a07e37537a8eda38b620d9de4fc5f01f22952121">https://github.com/Batix/rundeck-ansible-plugin/commit/a07e37537a8eda38b620d9de4fc5f01f22952121</a></p></li>
<li><p>“History.” Molecule documentation. Accessed June 6, 2019. <a class="reference external" href="https://molecule.readthedocs.io/en/stable/changelog.html">https://molecule.readthedocs.io/en/stable/changelog.html</a></p></li>
<li><p>“Special Variables.” Ansible Documentation. June 27, 2019. Accessed June 28, 2019. <a class="reference external" href="https://docs.ansible.com/ansible/latest/reference_appendices/special_variables.html">https://docs.ansible.com/ansible/latest/reference_appendices/special_variables.html</a></p></li>
<li><p>“Playbook Keywords.” Ansible Documentation. November 15, 2019. Accessed November 27, 2019. <a class="reference external" href="https://docs.ansible.com/ansible/latest/reference_appendices/playbooks_keywords.html">https://docs.ansible.com/ansible/latest/reference_appendices/playbooks_keywords.html</a></p></li>
<li><p>“Installing AWX.” GitHub ansible/awx. November 15, 2019. Accessed December 19, 2019. <a class="reference external" href="https://github.com/ansible/awx/blob/devel/INSTALL.md">https://github.com/ansible/awx/blob/devel/INSTALL.md</a></p></li>
</ol>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="puppet.html" class="btn btn-neutral float-right" title="Puppet" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="index.html" class="btn btn-neutral float-left" title="&lt;no title&gt;" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright None, Copyleft 2021, Luke Short. Documents licensed under GFDLv1.3.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>