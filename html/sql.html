<h1 id="sql">SQL</h1>
<ul>
<li><a href="#mariadb">MariaDB</a>
<ul>
<li><a href="#mariadb---configuration">Configuration</a></li>
<li><a href="#mariadb---table-engines">Table Engines</a>
<ul>
<li>InnoDB</li>
<li>MyISAM</li>
<li>Aria</li>
<li><a href="#mariadb---table-engines---cassandrase">CassandraSE</a></li>
</ul></li>
<li><a href="#mariadb---clustering">Clustering</a>
<ul>
<li>Galera</li>
<li><a href="#mariadb---clustering---maxscale">MaxScale</a></li>
</ul></li>
</ul></li>
</ul>
<h1 id="mariadb">MariaDB</h1>
<h2 id="maraidb---configuration">MaraiDB - Configuration</h2>
<p>RHEL Install [1]:</p>
<pre><code># vim /etc/yum.repos.d/mariadb.repo
[mariadb]
name = MariaDB
baseurl = http://yum.mariadb.org/10.1/centos7-amd64
gpgkey=https://yum.mariadb.org/RPM-GPG-KEY-MariaDB
gpgcheck=1
# yum install MariaDB-server MariaDB-client</code></pre>
<p>Source:</p>
<ol style="list-style-type: decimal">
<li>&quot;Installing MariaDB with yum.&quot; MariaDB Knowledgebase. Accessed October 16, 2016. https://mariadb.com/kb/en/mariadb/yum/</li>
</ol>
<h2 id="mariadb---table-engines">MariaDB - Table Engines</h2>
<p>A full list of the available engines are provided at <a href="https://mariadb.com/kb/en/mariadb/storage-engines" class="uri">https://mariadb.com/kb/en/mariadb/storage-engines</a>.</p>
<h3 id="mariadb---table-engines---cassandrase">MariaDB - Table Engines - CassandraSE</h3>
<p>The Cassandra Storage Engine (CassandraSE) is used to connect to a NoSQL Cassandra cluster. This allows the relational management of MariaDB to work with the fast and scalable Cassandra server. [1]</p>
<p>The Cassandra storage engine is missing from the official RHEL 7 repositories but can be installed from the RHEL 6 repository. [3]</p>
<pre><code># yum install http://yum.mariadb.org/10.1/centos6-amd64/rpms/MariaDB-10.1.18-centos6-x86_64-cassandra-engine.rpm</code></pre>
<ul>
<li><p>As the root MariaDB user, load the Cassandra library.</p>
<pre><code># mysql
&gt; install soname &#39;ha_cassandra.so&#39;;</code></pre></li>
<li><p>Configure the default Cassandra rpc/client IP to connect to.</p>
<pre><code>&gt; SET GLOBAL cassandra_default_thrift_host=&#39;&lt;CASSANDRA_IP&gt;&#39;</code></pre></li>
<li><p>The Cassandra table has to be created with the &quot;COMPACT STORAGE&quot; option. Otherwise, MariaDB will be unable to access the table properly.</p>
<pre><code>$ cqlsh
&gt; CREATE TABLE &lt;NAME&gt; (&lt;VALUE1&gt; &lt;TYPE&gt; PRIMARY KEY, &lt;VALUE2&gt; &lt;TYPE&gt;) WITH COMPACT STORAGE;</code></pre></li>
<li><p>Create a Cassandra table within a database. MariaDB needs to know the keyspace and the column/table to map to as well as what IP address to use to connect to Cassandra.</p>
<pre><code>&gt; CREATE TABLE &lt;NAME&gt; ENGINE=cassandra KEYSPACE=&quot;&lt;KEYSPACE_NAME&gt;&quot; COLUMN_FAMILY=&quot;&lt;COLUMN_FAMILY_NAME&gt;&quot;;</code></pre></li>
</ul>
<p>[1][2]</p>
<p>Sources:</p>
<ol style="list-style-type: decimal">
<li>&quot;Cassandra Storage Engine Overview.&quot; MariaDB Knowledgebase. Accessed October 16, 2016. https://mariadb.com/kb/en/mariadb/cassandra-storage-engine-overview/</li>
<li>&quot;Cassandra Storage Engine Use Example.&quot; MariaDB Knowledgebase. Accessed October 16, 2016. https://mariadb.com/kb/en/mariadb/cassandra-storage-engine-use-example/</li>
<li>&quot;Missing CentOS7 RPM: MariaDB-10.1.16-centos7-x86_64-cassandra-engine.rpm?&quot; MariaDB Knowledgebase. Accessed October 16, 2016. https://mariadb.com/kb/en/mariadb/missing-centos7-rpm-mariadb-10116-centos7-x86_64-cassandra-enginerpm/</li>
</ol>
<h2 id="mariadb---clustering">MariaDB - Clustering</h2>
<h3 id="mariadb---clustering---maxscale">MariaDB - Clustering - Maxscale</h3>
<p>MaxScale is a proxy that can load balance requests in different ways. This is useful for specifying reads and writes to specific servers. [1]</p>
<p>Source:</p>
<ol style="list-style-type: decimal">
<li>&quot;About MariaDB MaxScale.&quot; MariaDB Knowledgebase. Accessed October 16, 2016. https://mariadb.com/kb/en/mariadb-enterprise/about-mariadb-maxscale/</li>
</ol>
<h3 id="mariadb---clustering---maxscale---configuration">MariaDB - Clustering - Maxscale - Configuration</h3>
<p>The latest version of MariaDB's MaxScale can be found at <a href="https://mariadb.com/downloads/maxscale" class="uri">https://mariadb.com/downloads/maxscale</a>.</p>
<p>RHEL Install [1]:</p>
<pre><code># yum install https://downloads.mariadb.com/MaxScale/2.0.1/rhel/7/x86_64/maxscale-2.0.1-1.rhel.7.x86_64.rpm</code></pre>
<p>MaxScale requires the configuration of a listener that is associated with a router that serves requests to/from a list of servers.</p>
<p>Listener options:</p>
<ul>
<li>[NAME]</li>
<li>type=listener</li>
<li>service = Specify the back-end service to use. This is usually a router.</li>
<li>protocol=MySQLClient</li>
<li>address = Specify the address to listen on.</li>
<li>port=3306</li>
</ul>
<p>Listener example:</p>
<pre><code>[listener]
type=listener
service=&quot;Read Write Service&quot;
protocol=MySQLClient
port=3306</code></pre>
<p>Router options:</p>
<ul>
<li>[NAME]</li>
<li>type=service</li>
<li>router
<ul>
<li>readconnroute = Load balance requests.</li>
<li>readwritesplit = Send write requests to one node and read queries to all nodes.</li>
<li>schemarouter = Shard databases. Requests to a particular database will be routed to a specific server.</li>
<li>binlogrouter = Copy binary logs from servers other servers. If a backend server fails, MaxScale will replace it and serve read requests from the available binary log.</li>
</ul></li>
<li>router_options
<ul>
<li>master = Write only.</li>
<li>slave = Read only.</li>
<li>master,slave = Read and write.</li>
</ul></li>
<li>servers = A comma separated list of back-end servers.</li>
<li>user = Specify a MySQL user to connect as.</li>
<li>passwd = Specify the password for the MySQL user.</li>
</ul>
<p>Example:</p>
<pre><code>[Read Write Service]
type=service
router=readwritesplit
servers=server1,server2,server3
user=maxscale
passwd=123456</code></pre>
<p>Server options:</p>
<ul>
<li>[NAME]</li>
<li>type=server</li>
<li>address = Specify the address of the MySQL server.</li>
<li>port= Specify the MySQL port (default: 3306).</li>
<li>protocol=MySQLBackend</li>
</ul>
<p>[2]</p>
<p>For replication, a maxscale MySQL user needs &quot;REPLICATION SET&quot; and &quot;SELECT&quot; grants for all databases.</p>
<pre><code>GRANT REPLICATION SET, SELCT ON *.* TO &#39;maxscale&#39;@&#39;%&#39; IDENTIFIED BY &#39;securepassword123&#39;;</code></pre>
<p>In a master-slave configuration, at least two servers are required to be running. This is because MaxScale is unsure if other nodes are present and cannot determine if a server is a master or a slave. This will prevent it from working properly and this error will occur for all connections. [3] It is ideal to follow the quorum theory by having 3 servers to support a failed host properly.</p>
<pre><code>ERROR 1045 (28000): failed to create new session</code></pre>
<p>Sources:</p>
<ol style="list-style-type: decimal">
<li>&quot;MariaDB MaxScale Installation Guide.&quot; MariaDB Knowledgebase. Accessed October 22, 2016. https://mariadb.com/kb/en/mariadb-enterprise/mariadb-maxscale-14/mariadb-maxscale-installation-guide/</li>
<li>&quot;MaxScale Configuration &amp; Usage Scenarios.&quot; MariaDB Knowledgebase. Accessed October 22, 2016. https://mariadb.com/kb/en/mariadb-enterprise/mariadb-maxscale-14/maxscale-configuration-usage-scenarios/</li>
<li>&quot;Issue with MaxScale when slaves are broken.&quot; MaxScale Google Groups. August 28, 2014. Accessed November 12, 2016. https://groups.google.com/forum/#!topic/maxscale/HK49D15s21s</li>
</ol>
